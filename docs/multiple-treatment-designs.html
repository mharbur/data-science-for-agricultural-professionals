<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 7 Multiple Treatment Designs | Data Science for Agricultural Professionals</title>
  <meta name="description" content="Practical statistics for those involved in agronomy and related agricultural sciences." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 7 Multiple Treatment Designs | Data Science for Agricultural Professionals" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://mharbur.github.io/data-science-for-agricultural-professionals/" />
  
  <meta property="og:description" content="Practical statistics for those involved in agronomy and related agricultural sciences." />
  <meta name="github-repo" content="https://github.com/mharbur/data-science-for-agricultural-professionals" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 7 Multiple Treatment Designs | Data Science for Agricultural Professionals" />
  
  <meta name="twitter:description" content="Practical statistics for those involved in agronomy and related agricultural sciences." />
  

<meta name="author" content="Marin L. Harbur" />


<meta name="date" content="2021-06-24" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="multiple-treatment-trials.html"/>
<link rel="next" href="means-separation-and-data-presentation.html"/>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.3/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Bookdown Book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a><ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#welcome"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#r-language"><i class="fa fa-check"></i>R-language</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="population-statistics.html"><a href="population-statistics.html"><i class="fa fa-check"></i><b>1</b> Population Statistics</a><ul>
<li class="chapter" data-level="1.1" data-path="population-statistics.html"><a href="population-statistics.html#populations"><i class="fa fa-check"></i><b>1.1</b> Populations</a></li>
<li class="chapter" data-level="1.2" data-path="population-statistics.html"><a href="population-statistics.html#case-study-yield-map"><i class="fa fa-check"></i><b>1.2</b> Case Study: Yield Map</a></li>
<li class="chapter" data-level="1.3" data-path="population-statistics.html"><a href="population-statistics.html#distributions"><i class="fa fa-check"></i><b>1.3</b> Distributions</a><ul>
<li class="chapter" data-level="1.3.1" data-path="population-statistics.html"><a href="population-statistics.html#histograms"><i class="fa fa-check"></i><b>1.3.1</b> Histograms</a></li>
<li class="chapter" data-level="1.3.2" data-path="population-statistics.html"><a href="population-statistics.html#percentiles"><i class="fa fa-check"></i><b>1.3.2</b> Percentiles</a></li>
<li class="chapter" data-level="1.3.3" data-path="population-statistics.html"><a href="population-statistics.html#normal-distribution-model"><i class="fa fa-check"></i><b>1.3.3</b> Normal Distribution Model</a></li>
<li class="chapter" data-level="1.3.4" data-path="population-statistics.html"><a href="population-statistics.html#measures-of-center"><i class="fa fa-check"></i><b>1.3.4</b> Measures of Center</a></li>
<li class="chapter" data-level="1.3.5" data-path="population-statistics.html"><a href="population-statistics.html#measures-of-dispersion"><i class="fa fa-check"></i><b>1.3.5</b> Measures of Dispersion</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="population-statistics.html"><a href="population-statistics.html#exercise-introduction-to-r"><i class="fa fa-check"></i><b>1.4</b> Exercise: Introduction to R</a><ul>
<li class="chapter" data-level="1.4.1" data-path="population-statistics.html"><a href="population-statistics.html#your-very-first-code"><i class="fa fa-check"></i><b>1.4.1</b> Your Very First Code</a></li>
<li class="chapter" data-level="1.4.2" data-path="population-statistics.html"><a href="population-statistics.html#reading-and-working-with-data-frames"><i class="fa fa-check"></i><b>1.4.2</b> Reading and Working with Data Frames</a></li>
<li class="chapter" data-level="1.4.3" data-path="population-statistics.html"><a href="population-statistics.html#basic-operations-on-columns"><i class="fa fa-check"></i><b>1.4.3</b> Basic Operations on Columns</a></li>
<li class="chapter" data-level="1.4.4" data-path="population-statistics.html"><a href="population-statistics.html#knitting-your-results-into-a-document"><i class="fa fa-check"></i><b>1.4.4</b> Knitting Your Results into a Document</a></li>
<li class="chapter" data-level="1.4.5" data-path="population-statistics.html"><a href="population-statistics.html#practice"><i class="fa fa-check"></i><b>1.4.5</b> Practice</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="population-statistics.html"><a href="population-statistics.html#exercise-introduction-to-shapefiles"><i class="fa fa-check"></i><b>1.5</b> Exercise: Introduction to Shapefiles</a><ul>
<li class="chapter" data-level="1.5.1" data-path="population-statistics.html"><a href="population-statistics.html#r-packages"><i class="fa fa-check"></i><b>1.5.1</b> R Packages</a></li>
<li class="chapter" data-level="1.5.2" data-path="population-statistics.html"><a href="population-statistics.html#reading-shapefiles"><i class="fa fa-check"></i><b>1.5.2</b> Reading Shapefiles</a></li>
<li class="chapter" data-level="1.5.3" data-path="population-statistics.html"><a href="population-statistics.html#examining-spatial-feature-data-frames"><i class="fa fa-check"></i><b>1.5.3</b> Examining Spatial Feature Data Frames</a></li>
<li class="chapter" data-level="1.5.4" data-path="population-statistics.html"><a href="population-statistics.html#visualizing-data"><i class="fa fa-check"></i><b>1.5.4</b> Visualizing Data</a></li>
<li class="chapter" data-level="1.5.5" data-path="population-statistics.html"><a href="population-statistics.html#create-your-own-maps"><i class="fa fa-check"></i><b>1.5.5</b> Create Your Own Maps</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="population-statistics.html"><a href="population-statistics.html#exercise-histograms"><i class="fa fa-check"></i><b>1.6</b> Exercise: Histograms</a><ul>
<li class="chapter" data-level="1.6.1" data-path="population-statistics.html"><a href="population-statistics.html#case-study"><i class="fa fa-check"></i><b>1.6.1</b> Case Study</a></li>
<li class="chapter" data-level="1.6.2" data-path="population-statistics.html"><a href="population-statistics.html#basic-histogram"><i class="fa fa-check"></i><b>1.6.2</b> Basic Histogram</a></li>
<li class="chapter" data-level="1.6.3" data-path="population-statistics.html"><a href="population-statistics.html#histograms-with-ggplot"><i class="fa fa-check"></i><b>1.6.3</b> Histograms with ggplot</a></li>
<li class="chapter" data-level="1.6.4" data-path="population-statistics.html"><a href="population-statistics.html#practice-1"><i class="fa fa-check"></i><b>1.6.4</b> Practice</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html"><i class="fa fa-check"></i><b>2</b> Distributions and Probability</a><ul>
<li class="chapter" data-level="2.1" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#case-study-1"><i class="fa fa-check"></i><b>2.1</b> Case Study</a></li>
<li class="chapter" data-level="2.2" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#the-normal-distribution-model"><i class="fa fa-check"></i><b>2.2</b> The Normal Distribution Model</a><ul>
<li class="chapter" data-level="2.2.1" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#the-bell-curve"><i class="fa fa-check"></i><b>2.2.1</b> The Bell Curve</a></li>
<li class="chapter" data-level="2.2.2" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#distribution-and-probability"><i class="fa fa-check"></i><b>2.2.2</b> Distribution and Probability</a></li>
<li class="chapter" data-level="2.2.3" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#probability-and-the-normal-distribution-curve"><i class="fa fa-check"></i><b>2.2.3</b> Probability and the Normal Distribution Curve</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#the-z-distribution"><i class="fa fa-check"></i><b>2.3</b> The Z-Distribution</a><ul>
<li class="chapter" data-level="2.3.1" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#important-numbers-95-and-5"><i class="fa fa-check"></i><b>2.3.1</b> Important Numbers: 95% and 5%</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#exercise-z-distribution-and-probability"><i class="fa fa-check"></i><b>2.4</b> Exercise: Z-Distribution and Probability</a><ul>
<li class="chapter" data-level="2.4.1" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#case-study-barley-data"><i class="fa fa-check"></i><b>2.4.1</b> Case Study: Barley Data</a></li>
<li class="chapter" data-level="2.4.2" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#measuring-the-population-distribution-mean-and-standard-deviation"><i class="fa fa-check"></i><b>2.4.2</b> Measuring the Population Distribution: Mean and Standard Deviation</a></li>
<li class="chapter" data-level="2.4.3" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#the-shadedist-function"><i class="fa fa-check"></i><b>2.4.3</b> The shadeDist Function</a></li>
<li class="chapter" data-level="2.4.4" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#probabilities-in-lower-tails"><i class="fa fa-check"></i><b>2.4.4</b> Probabilities in Lower Tails</a></li>
<li class="chapter" data-level="2.4.5" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#probabilities-in-upper-tails"><i class="fa fa-check"></i><b>2.4.5</b> Probabilities in Upper Tails</a></li>
<li class="chapter" data-level="2.4.6" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#probabilities-within-a-range"><i class="fa fa-check"></i><b>2.4.6</b> Probabilities Within A Range</a></li>
<li class="chapter" data-level="2.4.7" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#probabilities-outside-a-range"><i class="fa fa-check"></i><b>2.4.7</b> Probabilities Outside a Range</a></li>
<li class="chapter" data-level="2.4.8" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#probability-and-sd"><i class="fa fa-check"></i><b>2.4.8</b> Probability and SD</a></li>
<li class="chapter" data-level="2.4.9" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#practice-cotton-dataset"><i class="fa fa-check"></i><b>2.4.9</b> Practice: Cotton Dataset</a></li>
<li class="chapter" data-level="2.4.10" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#practice-tomato-dataset"><i class="fa fa-check"></i><b>2.4.10</b> Practice: Tomato Dataset</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sample-statistics.html"><a href="sample-statistics.html"><i class="fa fa-check"></i><b>3</b> Sample Statistics</a><ul>
<li class="chapter" data-level="3.1" data-path="sample-statistics.html"><a href="sample-statistics.html#samples"><i class="fa fa-check"></i><b>3.1</b> Samples</a></li>
<li class="chapter" data-level="3.2" data-path="sample-statistics.html"><a href="sample-statistics.html#case-study-2"><i class="fa fa-check"></i><b>3.2</b> Case Study</a></li>
<li class="chapter" data-level="3.3" data-path="sample-statistics.html"><a href="sample-statistics.html#distribution-of-sample-means"><i class="fa fa-check"></i><b>3.3</b> Distribution of Sample Means</a></li>
<li class="chapter" data-level="3.4" data-path="sample-statistics.html"><a href="sample-statistics.html#central-limit-theorem"><i class="fa fa-check"></i><b>3.4</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="3.5" data-path="sample-statistics.html"><a href="sample-statistics.html#standard-error"><i class="fa fa-check"></i><b>3.5</b> Standard Error</a></li>
<li class="chapter" data-level="3.6" data-path="sample-statistics.html"><a href="sample-statistics.html#degrees-of-freedom"><i class="fa fa-check"></i><b>3.6</b> Degrees of Freedom</a></li>
<li class="chapter" data-level="3.7" data-path="sample-statistics.html"><a href="sample-statistics.html#the-t-distribution"><i class="fa fa-check"></i><b>3.7</b> The t-Distribution</a></li>
<li class="chapter" data-level="3.8" data-path="sample-statistics.html"><a href="sample-statistics.html#confidence-interval"><i class="fa fa-check"></i><b>3.8</b> Confidence Interval</a></li>
<li class="chapter" data-level="3.9" data-path="sample-statistics.html"><a href="sample-statistics.html#confidence-interval-and-probability"><i class="fa fa-check"></i><b>3.9</b> Confidence Interval and Probability</a></li>
<li class="chapter" data-level="3.10" data-path="sample-statistics.html"><a href="sample-statistics.html#exercise-standard-error"><i class="fa fa-check"></i><b>3.10</b> Exercise: Standard Error</a><ul>
<li class="chapter" data-level="3.10.1" data-path="sample-statistics.html"><a href="sample-statistics.html#case-study-tomatoes"><i class="fa fa-check"></i><b>3.10.1</b> Case Study: Tomatoes</a></li>
<li class="chapter" data-level="3.10.2" data-path="sample-statistics.html"><a href="sample-statistics.html#calculating-standard-error"><i class="fa fa-check"></i><b>3.10.2</b> Calculating Standard Error</a></li>
<li class="chapter" data-level="3.10.3" data-path="sample-statistics.html"><a href="sample-statistics.html#practice-barley"><i class="fa fa-check"></i><b>3.10.3</b> Practice: Barley</a></li>
<li class="chapter" data-level="3.10.4" data-path="sample-statistics.html"><a href="sample-statistics.html#practice-cotton"><i class="fa fa-check"></i><b>3.10.4</b> Practice: Cotton</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="sample-statistics.html"><a href="sample-statistics.html#exercise-t-distribution"><i class="fa fa-check"></i><b>3.11</b> Exercise: t-Distribution</a><ul>
<li class="chapter" data-level="3.11.1" data-path="sample-statistics.html"><a href="sample-statistics.html#plotting-the-distribution"><i class="fa fa-check"></i><b>3.11.1</b> Plotting the Distribution</a></li>
<li class="chapter" data-level="3.11.2" data-path="sample-statistics.html"><a href="sample-statistics.html#calculating-t"><i class="fa fa-check"></i><b>3.11.2</b> Calculating T</a></li>
<li class="chapter" data-level="3.11.3" data-path="sample-statistics.html"><a href="sample-statistics.html#practice-2"><i class="fa fa-check"></i><b>3.11.3</b> Practice</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="sample-statistics.html"><a href="sample-statistics.html#exercise-confidence-interval-for-sample-mean"><i class="fa fa-check"></i><b>3.12</b> Exercise: Confidence Interval for Sample Mean</a><ul>
<li class="chapter" data-level="3.12.1" data-path="sample-statistics.html"><a href="sample-statistics.html#calculating-the-confidence-interval"><i class="fa fa-check"></i><b>3.12.1</b> Calculating the Confidence Interval</a></li>
<li class="chapter" data-level="3.12.2" data-path="sample-statistics.html"><a href="sample-statistics.html#case-study-peanut-sample-1"><i class="fa fa-check"></i><b>3.12.2</b> Case Study: Peanut Sample 1</a></li>
<li class="chapter" data-level="3.12.3" data-path="sample-statistics.html"><a href="sample-statistics.html#case-study-peanut-sample-2"><i class="fa fa-check"></i><b>3.12.3</b> Case Study: Peanut Sample 2</a></li>
<li class="chapter" data-level="3.12.4" data-path="sample-statistics.html"><a href="sample-statistics.html#practice-3"><i class="fa fa-check"></i><b>3.12.4</b> Practice</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html"><i class="fa fa-check"></i><b>4</b> Two-Treatment Comparisons</a><ul>
<li class="chapter" data-level="4.1" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#side-by-side-trials"><i class="fa fa-check"></i><b>4.1</b> Side-by-Side Trials</a></li>
<li class="chapter" data-level="4.2" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#blocked-design"><i class="fa fa-check"></i><b>4.2</b> Blocked Design</a></li>
<li class="chapter" data-level="4.3" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#case-study-3"><i class="fa fa-check"></i><b>4.3</b> Case Study</a></li>
<li class="chapter" data-level="4.4" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#confidence-interval-1"><i class="fa fa-check"></i><b>4.4</b> Confidence Interval</a></li>
<li class="chapter" data-level="4.5" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#t-test"><i class="fa fa-check"></i><b>4.5</b> T-Test</a></li>
<li class="chapter" data-level="4.6" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#exercise-randomizing-plots"><i class="fa fa-check"></i><b>4.6</b> Exercise: Randomizing Plots</a><ul>
<li class="chapter" data-level="4.6.1" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#example-1"><i class="fa fa-check"></i><b>4.6.1</b> Example 1</a></li>
<li class="chapter" data-level="4.6.2" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#the-agricolae-package"><i class="fa fa-check"></i><b>4.6.2</b> The Agricolae Package</a></li>
<li class="chapter" data-level="4.6.3" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#randomizing-the-plot"><i class="fa fa-check"></i><b>4.6.3</b> Randomizing the Plot</a></li>
<li class="chapter" data-level="4.6.4" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#working-with-lists"><i class="fa fa-check"></i><b>4.6.4</b> Working with Lists</a></li>
<li class="chapter" data-level="4.6.5" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#example-2"><i class="fa fa-check"></i><b>4.6.5</b> Example 2</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#exercise-restructuring-columns-and-rows"><i class="fa fa-check"></i><b>4.7</b> Exercise: Restructuring Columns and Rows</a><ul>
<li class="chapter" data-level="4.7.1" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#operations-on-data"><i class="fa fa-check"></i><b>4.7.1</b> Operations on Data</a></li>
<li class="chapter" data-level="4.7.2" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#case-study-soybean-fungicide"><i class="fa fa-check"></i><b>4.7.2</b> Case Study: Soybean Fungicide</a></li>
<li class="chapter" data-level="4.7.3" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#practice-1-1"><i class="fa fa-check"></i><b>4.7.3</b> Practice 1</a></li>
<li class="chapter" data-level="4.7.4" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#practice-2-1"><i class="fa fa-check"></i><b>4.7.4</b> Practice 2</a></li>
<li class="chapter" data-level="4.7.5" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#practice-3-1"><i class="fa fa-check"></i><b>4.7.5</b> Practice 3</a></li>
<li class="chapter" data-level="4.7.6" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#practice-4"><i class="fa fa-check"></i><b>4.7.6</b> Practice 4</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#exercise-confidence-interval-of-difference"><i class="fa fa-check"></i><b>4.8</b> Exercise: Confidence Interval of Difference"</a><ul>
<li class="chapter" data-level="4.8.1" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#example-1-1"><i class="fa fa-check"></i><b>4.8.1</b> Example 1</a></li>
<li class="chapter" data-level="4.8.2" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#example-2-1"><i class="fa fa-check"></i><b>4.8.2</b> Example 2</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#exercise-t-test"><i class="fa fa-check"></i><b>4.9</b> Exercise: T-Test</a><ul>
<li class="chapter" data-level="4.9.1" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#case-study-1-wheat-fungicide"><i class="fa fa-check"></i><b>4.9.1</b> Case Study 1: Wheat Fungicide</a></li>
<li class="chapter" data-level="4.9.2" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#t-test-1"><i class="fa fa-check"></i><b>4.9.2</b> T-Test</a></li>
<li class="chapter" data-level="4.9.3" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#case-study-2-apple-variety"><i class="fa fa-check"></i><b>4.9.3</b> Case Study 2: Apple Variety</a></li>
<li class="chapter" data-level="4.9.4" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#practice-5"><i class="fa fa-check"></i><b>4.9.4</b> Practice</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html"><i class="fa fa-check"></i><b>5</b> Understanding Statistical Tests</a><ul>
<li class="chapter" data-level="5.1" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#research-question"><i class="fa fa-check"></i><b>5.1</b> Research Question</a></li>
<li class="chapter" data-level="5.2" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#the-model"><i class="fa fa-check"></i><b>5.2</b> The Model</a><ul>
<li class="chapter" data-level="5.2.1" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#treatment-effect"><i class="fa fa-check"></i><b>5.2.1</b> Treatment Effect</a></li>
<li class="chapter" data-level="5.2.2" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#error-effect"><i class="fa fa-check"></i><b>5.2.2</b> Error Effect</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#hypotheses"><i class="fa fa-check"></i><b>5.3</b> Hypotheses</a></li>
<li class="chapter" data-level="5.4" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#p-value"><i class="fa fa-check"></i><b>5.4</b> P-Value</a></li>
<li class="chapter" data-level="5.5" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#the-p-value-and-errors"><i class="fa fa-check"></i><b>5.5</b> The P-Value and Errors</a></li>
<li class="chapter" data-level="5.6" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#one-sided-vs-two-sided-hypotheses"><i class="fa fa-check"></i><b>5.6</b> One-Sided vs Two-Sided Hypotheses</a></li>
<li class="chapter" data-level="5.7" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#exercise-linear-additive-model"><i class="fa fa-check"></i><b>5.7</b> Exercise: Linear Additive Model</a><ul>
<li class="chapter" data-level="5.7.1" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#case-study-barley-effects"><i class="fa fa-check"></i><b>5.7.1</b> Case Study: Barley Effects</a></li>
<li class="chapter" data-level="5.7.2" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#plotting-the-effects"><i class="fa fa-check"></i><b>5.7.2</b> Plotting the Effects</a></li>
<li class="chapter" data-level="5.7.3" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#examining-individual-plots"><i class="fa fa-check"></i><b>5.7.3</b> Examining Individual Plots</a></li>
<li class="chapter" data-level="5.7.4" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#practice-groudnut"><i class="fa fa-check"></i><b>5.7.4</b> Practice: Groudnut</a></li>
<li class="chapter" data-level="5.7.5" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#plotting-the-effects-1"><i class="fa fa-check"></i><b>5.7.5</b> Plotting the Effects</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#exercise-one-sided-hypotheses"><i class="fa fa-check"></i><b>5.8</b> Exercise: One-Sided Hypotheses</a><ul>
<li class="chapter" data-level="5.8.1" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#case-study-groundnut"><i class="fa fa-check"></i><b>5.8.1</b> Case Study: Groundnut</a></li>
<li class="chapter" data-level="5.8.2" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#one-sided-t-test"><i class="fa fa-check"></i><b>5.8.2</b> One-Sided T-Test</a></li>
<li class="chapter" data-level="5.8.3" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#practice-barley-1"><i class="fa fa-check"></i><b>5.8.3</b> Practice: Barley</a></li>
<li class="chapter" data-level="5.8.4" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#practice-strawberry"><i class="fa fa-check"></i><b>5.8.4</b> Practice: Strawberry</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#exercise-type-i-and-type-ii-errors"><i class="fa fa-check"></i><b>5.9</b> Exercise: Type I and Type II Errors</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html"><i class="fa fa-check"></i><b>6</b> Multiple Treatment Trials</a><ul>
<li class="chapter" data-level="6.1" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#case-study-4"><i class="fa fa-check"></i><b>6.1</b> Case Study</a></li>
<li class="chapter" data-level="6.2" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#the-linear-additive-model"><i class="fa fa-check"></i><b>6.2</b> The Linear Additive Model</a></li>
<li class="chapter" data-level="6.3" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#analysis-of-variance"><i class="fa fa-check"></i><b>6.3</b> Analysis of Variance</a></li>
<li class="chapter" data-level="6.4" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#the-f-statistic"><i class="fa fa-check"></i><b>6.4</b> The F statistic</a></li>
<li class="chapter" data-level="6.5" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#the-anova-table"><i class="fa fa-check"></i><b>6.5</b> The ANOVA Table</a><ul>
<li class="chapter" data-level="6.5.1" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#source-of-variation"><i class="fa fa-check"></i><b>6.5.1</b> Source of Variation</a></li>
<li class="chapter" data-level="6.5.2" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#sum-of-squares-1"><i class="fa fa-check"></i><b>6.5.2</b> Sum of Squares</a></li>
<li class="chapter" data-level="6.5.3" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#degrees-of-freedom-1"><i class="fa fa-check"></i><b>6.5.3</b> Degrees of Freedom</a></li>
<li class="chapter" data-level="6.5.4" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#mean-square"><i class="fa fa-check"></i><b>6.5.4</b> Mean Square</a></li>
<li class="chapter" data-level="6.5.5" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#f-value"><i class="fa fa-check"></i><b>6.5.5</b> F-Value</a></li>
<li class="chapter" data-level="6.5.6" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#p-value-1"><i class="fa fa-check"></i><b>6.5.6</b> P-value</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#visualizing-how-the-anova-table-relates-to-variance"><i class="fa fa-check"></i><b>6.6</b> Visualizing How the Anova Table Relates to Variance</a><ul>
<li class="chapter" data-level="6.6.1" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#case-study-barley"><i class="fa fa-check"></i><b>6.6.1</b> Case Study: Barley</a></li>
<li class="chapter" data-level="6.6.2" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#anova"><i class="fa fa-check"></i><b>6.6.2</b> ANOVA</a></li>
<li class="chapter" data-level="6.6.3" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#calculating-the-coefficient-of-variation"><i class="fa fa-check"></i><b>6.6.3</b> Calculating the Coefficient of Variation</a></li>
<li class="chapter" data-level="6.6.4" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#practice-beet-data"><i class="fa fa-check"></i><b>6.6.4</b> Practice: Beet Data</a></li>
<li class="chapter" data-level="6.6.5" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#practice-potato-data"><i class="fa fa-check"></i><b>6.6.5</b> Practice: Potato Data</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#exercise-treatment-means"><i class="fa fa-check"></i><b>6.7</b> Exercise: “Treatment Means”</a><ul>
<li class="chapter" data-level="6.7.1" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#case-study-barley-1"><i class="fa fa-check"></i><b>6.7.1</b> Case Study: Barley</a></li>
<li class="chapter" data-level="6.7.2" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#calculating-treatment-means"><i class="fa fa-check"></i><b>6.7.2</b> Calculating Treatment Means</a></li>
<li class="chapter" data-level="6.7.3" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#plotting-the-means"><i class="fa fa-check"></i><b>6.7.3</b> Plotting the Means</a></li>
<li class="chapter" data-level="6.7.4" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#practice-beet-data-1"><i class="fa fa-check"></i><b>6.7.4</b> Practice: Beet Data</a></li>
<li class="chapter" data-level="6.7.5" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#practice-potato-data-1"><i class="fa fa-check"></i><b>6.7.5</b> Practice: Potato Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html"><i class="fa fa-check"></i><b>7</b> Multiple Treatment Designs</a><ul>
<li class="chapter" data-level="7.1" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#randomized-complete-block-design"><i class="fa fa-check"></i><b>7.1</b> Randomized Complete Block Design</a><ul>
<li class="chapter" data-level="7.1.1" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#case-study-randomized-complete-block-design"><i class="fa fa-check"></i><b>7.1.1</b> Case Study: Randomized Complete Block Design</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#factorial-design"><i class="fa fa-check"></i><b>7.2</b> Factorial Design</a><ul>
<li class="chapter" data-level="7.2.1" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#case-study-1-1"><i class="fa fa-check"></i><b>7.2.1</b> Case Study 1</a></li>
<li class="chapter" data-level="7.2.2" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#case-study-2-1"><i class="fa fa-check"></i><b>7.2.2</b> Case Study 2</a></li>
<li class="chapter" data-level="7.2.3" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#discussing-interactions"><i class="fa fa-check"></i><b>7.2.3</b> Discussing Interactions</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#split-plot-design"><i class="fa fa-check"></i><b>7.3</b> Split-Plot Design</a></li>
<li class="chapter" data-level="7.4" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#linear-additive-model-3"><i class="fa fa-check"></i><b>7.4</b> Linear Additive Model</a></li>
<li class="chapter" data-level="7.5" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#conclusion"><i class="fa fa-check"></i><b>7.5</b> Conclusion</a></li>
<li class="chapter" data-level="7.6" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#exercise-randomized-complete-block-design"><i class="fa fa-check"></i><b>7.6</b> Exercise: Randomized Complete Block Design</a><ul>
<li class="chapter" data-level="7.6.1" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#case-study-5"><i class="fa fa-check"></i><b>7.6.1</b> Case Study</a></li>
<li class="chapter" data-level="7.6.2" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#anova-1"><i class="fa fa-check"></i><b>7.6.2</b> ANOVA</a></li>
<li class="chapter" data-level="7.6.3" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#plotting-the-results"><i class="fa fa-check"></i><b>7.6.3</b> Plotting the Results</a></li>
<li class="chapter" data-level="7.6.4" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#practice-6"><i class="fa fa-check"></i><b>7.6.4</b> Practice</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#exercise-factorial-anova"><i class="fa fa-check"></i><b>7.7</b> Exercise: Factorial ANOVA</a><ul>
<li class="chapter" data-level="7.7.1" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#case-study-biochar"><i class="fa fa-check"></i><b>7.7.1</b> Case Study: Biochar</a></li>
<li class="chapter" data-level="7.7.2" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#anova-2"><i class="fa fa-check"></i><b>7.7.2</b> ANOVA</a></li>
<li class="chapter" data-level="7.7.3" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#interaction-plots"><i class="fa fa-check"></i><b>7.7.3</b> Interaction Plots</a></li>
<li class="chapter" data-level="7.7.4" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#testing-factors-individually"><i class="fa fa-check"></i><b>7.7.4</b> Testing Factors Individually</a></li>
<li class="chapter" data-level="7.7.5" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#bar-plots"><i class="fa fa-check"></i><b>7.7.5</b> Bar Plots</a></li>
<li class="chapter" data-level="7.7.6" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#practice-7"><i class="fa fa-check"></i><b>7.7.6</b> Practice</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#exercise-split-plot-design"><i class="fa fa-check"></i><b>7.8</b> Exercise: Split-Plot Design</a><ul>
<li class="chapter" data-level="7.8.1" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#case-study-corn-soybean-systems-trial"><i class="fa fa-check"></i><b>7.8.1</b> Case Study: Corn-Soybean Systems Trial</a></li>
<li class="chapter" data-level="7.8.2" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#anova-4"><i class="fa fa-check"></i><b>7.8.2</b> ANOVA</a></li>
<li class="chapter" data-level="7.8.3" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#interaction-plot"><i class="fa fa-check"></i><b>7.8.3</b> Interaction Plot</a></li>
<li class="chapter" data-level="7.8.4" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#bar-plot"><i class="fa fa-check"></i><b>7.8.4</b> Bar plot</a></li>
<li class="chapter" data-level="7.8.5" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#practice-8"><i class="fa fa-check"></i><b>7.8.5</b> Practice</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#exercise-experimental-design"><i class="fa fa-check"></i><b>7.9</b> Exercise: Experimental Design</a><ul>
<li class="chapter" data-level="7.9.1" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#completely-randomized-design"><i class="fa fa-check"></i><b>7.9.1</b> Completely Randomized Design</a></li>
<li class="chapter" data-level="7.9.2" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#randomized-complete-block-design-1"><i class="fa fa-check"></i><b>7.9.2</b> Randomized Complete Block Design</a></li>
<li class="chapter" data-level="7.9.3" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#factorial-design-1"><i class="fa fa-check"></i><b>7.9.3</b> Factorial Design</a></li>
<li class="chapter" data-level="7.9.4" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#split-plot-design-1"><i class="fa fa-check"></i><b>7.9.4</b> Split-Plot Design</a></li>
<li class="chapter" data-level="7.9.5" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#practice-9"><i class="fa fa-check"></i><b>7.9.5</b> Practice</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html"><i class="fa fa-check"></i><b>8</b> Means Separation and Data Presentation</a><ul>
<li class="chapter" data-level="8.1" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#case-study-6"><i class="fa fa-check"></i><b>8.1</b> Case Study</a></li>
<li class="chapter" data-level="8.2" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#least-significant-difference"><i class="fa fa-check"></i><b>8.2</b> Least Significant Difference</a></li>
<li class="chapter" data-level="8.3" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#lsd-output-in-r"><i class="fa fa-check"></i><b>8.3</b> LSD Output in R</a><ul>
<li class="chapter" data-level="8.3.1" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#statistics-table"><i class="fa fa-check"></i><b>8.3.1</b> Statistics Table</a></li>
<li class="chapter" data-level="8.3.2" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#means-table"><i class="fa fa-check"></i><b>8.3.2</b> Means Table</a></li>
<li class="chapter" data-level="8.3.3" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#groups-table"><i class="fa fa-check"></i><b>8.3.3</b> Groups Table</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#comparisonwise-versus-experimentwise-error"><i class="fa fa-check"></i><b>8.4</b> Comparisonwise versus Experimentwise Error</a></li>
<li class="chapter" data-level="8.5" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#tukeys-honest-significant-difference"><i class="fa fa-check"></i><b>8.5</b> Tukey’s Honest Significant Difference</a></li>
<li class="chapter" data-level="8.6" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#linear-contrast"><i class="fa fa-check"></i><b>8.6</b> Linear Contrast</a><ul>
<li class="chapter" data-level="8.6.1" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#coefficients"><i class="fa fa-check"></i><b>8.6.1</b> Coefficients</a></li>
<li class="chapter" data-level="8.6.2" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#linear-contrasts-with-r"><i class="fa fa-check"></i><b>8.6.2</b> Linear Contrasts with R</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#means-presentation"><i class="fa fa-check"></i><b>8.7</b> Means Presentation</a><ul>
<li class="chapter" data-level="8.7.1" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#means-tables"><i class="fa fa-check"></i><b>8.7.1</b> Means Tables</a></li>
<li class="chapter" data-level="8.7.2" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#plotting-means"><i class="fa fa-check"></i><b>8.7.2</b> Plotting Means</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#exercise-lsd-and-tukeys-hsd"><i class="fa fa-check"></i><b>8.8</b> Exercise: LSD and Tukey’s HSD</a><ul>
<li class="chapter" data-level="8.8.1" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#case-study-common-bean"><i class="fa fa-check"></i><b>8.8.1</b> Case Study: Common Bean</a></li>
<li class="chapter" data-level="8.8.2" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#least-significant-difference-1"><i class="fa fa-check"></i><b>8.8.2</b> Least Significant Difference</a></li>
<li class="chapter" data-level="8.8.3" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#tukey-hsd"><i class="fa fa-check"></i><b>8.8.3</b> Tukey HSD</a></li>
<li class="chapter" data-level="8.8.4" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#practice-apple"><i class="fa fa-check"></i><b>8.8.4</b> Practice: Apple</a></li>
<li class="chapter" data-level="8.8.5" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#practice-wheat-treatment-with-mildew"><i class="fa fa-check"></i><b>8.8.5</b> Practice: Wheat Treatment with Mildew</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#exercise-linear-contrasts"><i class="fa fa-check"></i><b>8.9</b> Exercise: Linear Contrasts</a><ul>
<li class="chapter" data-level="8.9.1" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#case-study-winter-canola-cultivar-trial."><i class="fa fa-check"></i><b>8.9.1</b> Case Study: Winter Canola Cultivar Trial.</a></li>
<li class="chapter" data-level="8.9.2" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#running-the-contrast"><i class="fa fa-check"></i><b>8.9.2</b> Running the Contrast</a></li>
<li class="chapter" data-level="8.9.3" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#practice-corn-nitrogen-source-and-timing"><i class="fa fa-check"></i><b>8.9.3</b> Practice: Corn Nitrogen Source and Timing</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#exercise-means-tables"><i class="fa fa-check"></i><b>8.10</b> Exercise: Means Tables</a><ul>
<li class="chapter" data-level="8.10.1" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#case-study-corn-nitrogen-source-and-timing"><i class="fa fa-check"></i><b>8.10.1</b> Case Study: Corn Nitrogen Source and Timing</a></li>
<li class="chapter" data-level="8.10.2" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#practice-canola"><i class="fa fa-check"></i><b>8.10.2</b> Practice: Canola</a></li>
<li class="chapter" data-level="8.10.3" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#practice-broccoli-lsd"><i class="fa fa-check"></i><b>8.10.3</b> Practice: Broccoli LSD</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html"><i class="fa fa-check"></i><b>9</b> Messy and Missing Data</a><ul>
<li class="chapter" data-level="9.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#inspecting-data-for-normal-distributions"><i class="fa fa-check"></i><b>9.1</b> Inspecting data for Normal Distributions</a><ul>
<li class="chapter" data-level="9.1.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#histograms-1"><i class="fa fa-check"></i><b>9.1.1</b> Histograms</a></li>
<li class="chapter" data-level="9.1.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#rank-percentile-plots"><i class="fa fa-check"></i><b>9.1.2</b> Rank Percentile Plots</a></li>
<li class="chapter" data-level="9.1.3" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#box-plots"><i class="fa fa-check"></i><b>9.1.3</b> Box Plots</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#inspecting-data-for-equal-variances"><i class="fa fa-check"></i><b>9.2</b> Inspecting Data for Equal Variances</a><ul>
<li class="chapter" data-level="9.2.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#mean-variance-plot"><i class="fa fa-check"></i><b>9.2.1</b> Mean-Variance Plot</a></li>
<li class="chapter" data-level="9.2.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#homogeneity-of-variance-tests"><i class="fa fa-check"></i><b>9.2.2</b> Homogeneity of Variance Tests</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#dealing-with-messy-data"><i class="fa fa-check"></i><b>9.3</b> Dealing with Messy Data</a><ul>
<li class="chapter" data-level="9.3.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#outliers"><i class="fa fa-check"></i><b>9.3.1</b> Outliers</a></li>
<li class="chapter" data-level="9.3.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#non-normal-data-and-unequal-variances"><i class="fa fa-check"></i><b>9.3.2</b> Non-normal Data and Unequal Variances</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#dealing-with-missing-data"><i class="fa fa-check"></i><b>9.4</b> Dealing with Missing Data</a></li>
<li class="chapter" data-level="9.5" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#summary"><i class="fa fa-check"></i><b>9.5</b> Summary</a></li>
<li class="chapter" data-level="9.6" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#exercise-visual-data-inspection"><i class="fa fa-check"></i><b>9.6</b> Exercise: Visual Data Inspection</a><ul>
<li class="chapter" data-level="9.6.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#case-study-1-2"><i class="fa fa-check"></i><b>9.6.1</b> Case Study 1</a></li>
<li class="chapter" data-level="9.6.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#histogram"><i class="fa fa-check"></i><b>9.6.2</b> Histogram</a></li>
<li class="chapter" data-level="9.6.3" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#rank-percentile"><i class="fa fa-check"></i><b>9.6.3</b> Rank-Percentile</a></li>
<li class="chapter" data-level="9.6.4" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#case-study-2-2"><i class="fa fa-check"></i><b>9.6.4</b> Case Study 2</a></li>
<li class="chapter" data-level="9.6.5" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#box-plot"><i class="fa fa-check"></i><b>9.6.5</b> Box Plot</a></li>
<li class="chapter" data-level="9.6.6" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#practice-10"><i class="fa fa-check"></i><b>9.6.6</b> Practice</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#exercise-identifying-unequal-variances"><i class="fa fa-check"></i><b>9.7</b> Exercise: Identifying Unequal Variances"</a><ul>
<li class="chapter" data-level="9.7.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#case-study-grape-colapsis-in-seed-corn"><i class="fa fa-check"></i><b>9.7.1</b> Case Study: Grape Colapsis in Seed Corn</a></li>
<li class="chapter" data-level="9.7.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#practice-pigweed-height"><i class="fa fa-check"></i><b>9.7.2</b> Practice: Pigweed Height</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#exercise-transforming-and-analyzing-data"><i class="fa fa-check"></i><b>9.8</b> Exercise: Transforming and Analyzing Data</a><ul>
<li class="chapter" data-level="9.8.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#case-study-grape-colapsis-in-seed-corn-1"><i class="fa fa-check"></i><b>9.8.1</b> Case Study: Grape Colapsis in Seed Corn</a></li>
<li class="chapter" data-level="9.8.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#practice-pigweed-height-1"><i class="fa fa-check"></i><b>9.8.2</b> Practice: Pigweed Height</a></li>
<li class="chapter" data-level="9.8.3" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#practice-pigweed-biomass"><i class="fa fa-check"></i><b>9.8.3</b> Practice: Pigweed Biomass</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#exercise-imputing-missing-data"><i class="fa fa-check"></i><b>9.9</b> Exercise: Imputing Missing Data</a><ul>
<li class="chapter" data-level="9.9.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#case-study-wheat-genotype-trial"><i class="fa fa-check"></i><b>9.9.1</b> Case Study: Wheat Genotype Trial</a></li>
<li class="chapter" data-level="9.9.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#practice-1-2"><i class="fa fa-check"></i><b>9.9.2</b> Practice 1</a></li>
<li class="chapter" data-level="9.9.3" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#practice-2-2"><i class="fa fa-check"></i><b>9.9.3</b> Practice 2</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Agricultural Professionals</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="multiple-treatment-designs" class="section level1">
<h1><span class="header-section-number">Chapter 7</span> Multiple Treatment Designs</h1>
<p>In the last unit, we were introduced to multiple-treatment experiments, using an example with which many of you are familiar: a hybrid research or demonstration trial. Recall how the analysis of variance worked: we compared two sources of variation to see how much of that variation each of them explained. There were two effects in our original trial: treatment and error</p>
<p><span class="math display">\[ Y_{ij}=\mu + T_i + \epsilon_{i(j)}\]</span></p>
<p>The Analysis of Variance (ANOVA) was used to calculate and compare these variances. First, the sums of squares from the treatment means and the error (the summed distributions of observations around each treatment mean) were calculated. By dividing the sum of squares by their degrees of freedom, the we obtained the treatment and error mean squares, also known as their variances. The F-value was derived from the ratio of the treatment variance to the error variance. Finally, the probability that the difference among treatments was zero, given the F-value we observed, was calculated using the F-distribution.</p>
<p>This experimental design is known as a <em>Completely Randomized Design</em>. It is the simplest multiple-treatment design there is. In this unit, we will learn two other designs commonly used in trials:</p>
<ul>
<li>Randomized Complete Block Design</li>
<li>Two-Way Factorial Design</li>
</ul>
<p>These designs, we will see, use additional sources of variation to either expand the number of treatments we can evaluate, or reduce the error (unexplained variation) in our trials so that we can better identify treatment effects.</p>
<div id="randomized-complete-block-design" class="section level2">
<h2><span class="header-section-number">7.1</span> Randomized Complete Block Design</h2>
<p>If you have participated in agronomic research, you have likely heard references to a Randomized Complete Block Design (RCBD). We first discussed blocking when we learned about side-by-side trials. When we block treatments, we force treatments to occur in closer proximity to each other than they likely would were they assigned at random. The best way to understand this is to look at a plot map.</p>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="multiple-treatment-designs.html#cb433-1"></a><span class="kw">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## -- Attaching packages --------------------------------------- tidyverse 1.3.0 --</code></pre>
<pre><code>## v ggplot2 3.3.3     v purrr   0.3.4
## v tibble  3.1.0     v dplyr   1.0.5
## v tidyr   1.1.3     v stringr 1.4.0
## v readr   1.4.0     v forcats 0.5.1</code></pre>
<pre><code>## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="multiple-treatment-designs.html#cb437-1"></a>col =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">each=</span><span class="dv">4</span>)</span>
<span id="cb437-2"><a href="multiple-treatment-designs.html#cb437-2"></a>row =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb437-3"><a href="multiple-treatment-designs.html#cb437-3"></a></span>
<span id="cb437-4"><a href="multiple-treatment-designs.html#cb437-4"></a>block =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">each=</span><span class="dv">4</span>)</span>
<span id="cb437-5"><a href="multiple-treatment-designs.html#cb437-5"></a></span>
<span id="cb437-6"><a href="multiple-treatment-designs.html#cb437-6"></a><span class="kw">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb437-7"><a href="multiple-treatment-designs.html#cb437-7"></a>crd =<span class="st"> </span><span class="kw">sample</span>(col, <span class="dv">16</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb437-8"><a href="multiple-treatment-designs.html#cb437-8"></a>rcbd_list =<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb437-9"><a href="multiple-treatment-designs.html#cb437-9"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>)){</span>
<span id="cb437-10"><a href="multiple-treatment-designs.html#cb437-10"></a>  <span class="kw">set.seed</span>(i)</span>
<span id="cb437-11"><a href="multiple-treatment-designs.html#cb437-11"></a>  z =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">4</span>, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb437-12"><a href="multiple-treatment-designs.html#cb437-12"></a>  rcbd_list[[i]] =<span class="st"> </span>z</span>
<span id="cb437-13"><a href="multiple-treatment-designs.html#cb437-13"></a>}</span>
<span id="cb437-14"><a href="multiple-treatment-designs.html#cb437-14"></a></span>
<span id="cb437-15"><a href="multiple-treatment-designs.html#cb437-15"></a>rcbd =<span class="st"> </span><span class="kw">do.call</span>(c, rcbd_list)</span>
<span id="cb437-16"><a href="multiple-treatment-designs.html#cb437-16"></a></span>
<span id="cb437-17"><a href="multiple-treatment-designs.html#cb437-17"></a>dataset =<span class="st"> </span><span class="kw">cbind</span>(col, row, block, crd, rcbd) <span class="op">%&gt;%</span></span>
<span id="cb437-18"><a href="multiple-treatment-designs.html#cb437-18"></a><span class="st">  </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb437-19"><a href="multiple-treatment-designs.html#cb437-19"></a><span class="st">  </span><span class="kw">gather</span>(design, treatment, crd, rcbd) <span class="op">%&gt;%</span></span>
<span id="cb437-20"><a href="multiple-treatment-designs.html#cb437-20"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">design =</span> <span class="kw">toupper</span>(design)) <span class="op">%&gt;%</span></span>
<span id="cb437-21"><a href="multiple-treatment-designs.html#cb437-21"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">block_effect =</span> <span class="kw">case_when</span>(col<span class="op">==</span><span class="dv">1</span> <span class="op">~</span><span class="st"> </span><span class="dv">3</span>,</span>
<span id="cb437-22"><a href="multiple-treatment-designs.html#cb437-22"></a>                                  col<span class="op">==</span><span class="dv">2</span> <span class="op">~</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb437-23"><a href="multiple-treatment-designs.html#cb437-23"></a>                                  col<span class="op">==</span><span class="dv">3</span> <span class="op">~</span><span class="st"> </span><span class="dv">-1</span>,</span>
<span id="cb437-24"><a href="multiple-treatment-designs.html#cb437-24"></a>                                  col<span class="op">==</span><span class="dv">4</span> <span class="op">~</span><span class="st"> </span><span class="dv">-3</span>)) </span>
<span id="cb437-25"><a href="multiple-treatment-designs.html#cb437-25"></a></span>
<span id="cb437-26"><a href="multiple-treatment-designs.html#cb437-26"></a>dataset <span class="op">%&gt;%</span></span>
<span id="cb437-27"><a href="multiple-treatment-designs.html#cb437-27"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>col, <span class="dt">y=</span>row, <span class="dt">label=</span>treatment)) <span class="op">+</span></span>
<span id="cb437-28"><a href="multiple-treatment-designs.html#cb437-28"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">fill=</span><span class="st">&quot;grey&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb437-29"><a href="multiple-treatment-designs.html#cb437-29"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> treatment)) <span class="op">+</span></span>
<span id="cb437-30"><a href="multiple-treatment-designs.html#cb437-30"></a><span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>design)</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>In the plot above, the Completely Randomized Design (CRD) is shown on the left, and the Randomized Complete Block Design (RCBD) on the right. In the Completely Randomized Design, any treatment can occur anywhere in the the plot. Note that in the left plot, treatment 3 occurs twice in the first column of plots while treatment 2 does not occur at all. Treatment 2 occurs twice in the second column, but there is no treatment 1. In the Randomized Complete Block Design, each treatment must occur once, and only once, per column. In this case, the treatments are blocked on column.</p>
<p>Why block? Let’s suppose each column in the plot map above has a different soil type, with soils transitioning from more productive to less productive as columns increase from 1 to 4:</p>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="multiple-treatment-designs.html#cb438-1"></a>dataset <span class="op">%&gt;%</span></span>
<span id="cb438-2"><a href="multiple-treatment-designs.html#cb438-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>col, <span class="dt">y=</span>row, <span class="dt">label=</span>treatment)) <span class="op">+</span></span>
<span id="cb438-3"><a href="multiple-treatment-designs.html#cb438-3"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill=</span><span class="kw">as.factor</span>(col)), <span class="dt">color=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb438-4"><a href="multiple-treatment-designs.html#cb438-4"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> treatment)) <span class="op">+</span></span>
<span id="cb438-5"><a href="multiple-treatment-designs.html#cb438-5"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;lightgreen&quot;</span>, <span class="st">&quot;yellow2&quot;</span>, <span class="st">&quot;orange1&quot;</span>, <span class="st">&quot;tomato&quot;</span>)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb438-6"><a href="multiple-treatment-designs.html#cb438-6"></a><span class="st">  </span><span class="kw">facet_grid</span>(. <span class="op">~</span><span class="st"> </span>design) <span class="op">+</span></span>
<span id="cb438-7"><a href="multiple-treatment-designs.html#cb438-7"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>Note that treatment 3 occurs three times in the more productive soils of columns 1 and 2, and only once in the less productive soils of columns 3 and 4. Conversely, treatment 1 occurs three times in the less productive soils of columns 3 and 4, but only once in the more productive soil of columns 1 or 2.</p>
<p>If the mean effect of treatment 3 is greater than the mean effect of treatment 1, how will we distinguish the effects of treatment and error? It is a moot question: we can’t. Our linear model is <em>additive</em>:</p>
<p><span class="math display">\[ Y_{ij}=\mu + T_i + \epsilon_{i(j)}\]</span></p>
<p>The term additive is important: it means we assume that treatment and error effects do not interact – they independently add or subtract from the population mean. If the measured effect of treatment is dependent on plot error, the model fails.</p>
<p>The plot on the right has blocked treatments according to column. Doing that allows us to remove the effect of soil type, which consistently varies from column to column, from the effect of error, which is random. Our linear model changes as well:</p>
<p><span class="math display">\[ Y_{ij}=\mu + B_i + T_j + BT_{ij}\]</span></p>
<p>Where <span class="math inline">\(Y_{ij}\)</span> is the individual value, <span class="math inline">\(\mu\)</span> is the population mean, <span class="math inline">\(B_i\)</span> is the block effect, <span class="math inline">\(T_j\)</span> is the treatment effect, and <span class="math inline">\(BT_{ij}\)</span> is the interaction of block and treatment, also known as the error effect.</p>
<div id="case-study-randomized-complete-block-design" class="section level3">
<h3><span class="header-section-number">7.1.1</span> Case Study: Randomized Complete Block Design</h3>
<p>A field trial outside Goshen, Indiana, evaluated the effect of seed treatments on soybean yield. Treatments were as follows:
- A: untreated
- B: metalaxyl only
- C: metalaxyl + insecticide
- D: metalaxyl + insecticide + nematicide</p>
<p>Treatments were arranged in a Randomized Complete Block Design.</p>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="multiple-treatment-designs.html#cb439-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb439-2"><a href="multiple-treatment-designs.html#cb439-2"></a></span>
<span id="cb439-3"><a href="multiple-treatment-designs.html#cb439-3"></a>st =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">obs=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">16</span>))</span>
<span id="cb439-4"><a href="multiple-treatment-designs.html#cb439-4"></a><span class="kw">set.seed</span>(<span class="dv">041383</span>)</span>
<span id="cb439-5"><a href="multiple-treatment-designs.html#cb439-5"></a>mu =<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="fl">68.3</span>))</span>
<span id="cb439-6"><a href="multiple-treatment-designs.html#cb439-6"></a>Block =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">each=</span><span class="dv">4</span>)</span>
<span id="cb439-7"><a href="multiple-treatment-designs.html#cb439-7"></a>B =<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="op">-</span><span class="fl">2.2</span>, <span class="fl">-0.8</span>, <span class="fl">0.3</span>, <span class="fl">1.2</span>), <span class="dt">each =</span> <span class="dv">4</span>)</span>
<span id="cb439-8"><a href="multiple-treatment-designs.html#cb439-8"></a>Treatment =<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>,<span class="st">&quot;D&quot;</span>), <span class="dv">4</span>)</span>
<span id="cb439-9"><a href="multiple-treatment-designs.html#cb439-9"></a>T =<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="op">-</span><span class="fl">1.1</span>, <span class="fl">-0.3</span>, <span class="fl">0.8</span>, <span class="fl">1.6</span>), <span class="dv">4</span>)</span>
<span id="cb439-10"><a href="multiple-treatment-designs.html#cb439-10"></a>BT =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dt">n=</span><span class="dv">16</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>)</span>
<span id="cb439-11"><a href="multiple-treatment-designs.html#cb439-11"></a></span>
<span id="cb439-12"><a href="multiple-treatment-designs.html#cb439-12"></a>st_data =<span class="st"> </span>st <span class="op">%&gt;%</span></span>
<span id="cb439-13"><a href="multiple-treatment-designs.html#cb439-13"></a><span class="st">  </span><span class="kw">cbind</span>(Block, Treatment, mu, B, T, BT) <span class="op">%&gt;%</span></span>
<span id="cb439-14"><a href="multiple-treatment-designs.html#cb439-14"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">BT =</span> <span class="kw">round</span>(BT,<span class="dv">1</span>)) <span class="op">%&gt;%</span></span>
<span id="cb439-15"><a href="multiple-treatment-designs.html#cb439-15"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Y =</span> mu<span class="op">+</span>B<span class="op">+</span>T<span class="op">+</span>BT) <span class="op">%&gt;%</span></span>
<span id="cb439-16"><a href="multiple-treatment-designs.html#cb439-16"></a><span class="st">  </span><span class="kw">group_by</span>(Block) <span class="op">%&gt;%</span></span>
<span id="cb439-17"><a href="multiple-treatment-designs.html#cb439-17"></a><span class="st">  </span><span class="kw">sample_n</span>(<span class="dv">4</span>) <span class="op">%&gt;%</span></span>
<span id="cb439-18"><a href="multiple-treatment-designs.html#cb439-18"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb439-19"><a href="multiple-treatment-designs.html#cb439-19"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>obs) <span class="op">%&gt;%</span></span>
<span id="cb439-20"><a href="multiple-treatment-designs.html#cb439-20"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Block =</span> <span class="kw">as.factor</span>(Block))</span>
<span id="cb439-21"><a href="multiple-treatment-designs.html#cb439-21"></a></span>
<span id="cb439-22"><a href="multiple-treatment-designs.html#cb439-22"></a>st_data<span class="op">$</span>row =<span class="st"> </span><span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">4</span>)</span>
<span id="cb439-23"><a href="multiple-treatment-designs.html#cb439-23"></a></span>
<span id="cb439-24"><a href="multiple-treatment-designs.html#cb439-24"></a>  </span>
<span id="cb439-25"><a href="multiple-treatment-designs.html#cb439-25"></a>st_data <span class="op">%&gt;%</span></span>
<span id="cb439-26"><a href="multiple-treatment-designs.html#cb439-26"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">plot_label =</span> <span class="kw">paste0</span>(<span class="st">&quot;Treatment &quot;</span>, Treatment, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>, Y)) <span class="op">%&gt;%</span></span>
<span id="cb439-27"><a href="multiple-treatment-designs.html#cb439-27"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>block, <span class="dt">y=</span>row, <span class="dt">label=</span>plot_label)) <span class="op">+</span></span>
<span id="cb439-28"><a href="multiple-treatment-designs.html#cb439-28"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">fill=</span><span class="st">&quot;grey&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb439-29"><a href="multiple-treatment-designs.html#cb439-29"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> plot_label))</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<div id="linear-additive-model" class="section level4">
<h4><span class="header-section-number">7.1.1.1</span> Linear Additive Model</h4>
<p>In this example, the linear additive model is:</p>
<p><span class="math display">\[ Y_{ij}=\mu + B_i + T_j + BT_{ij}\]</span></p>
<p>Or, with regard to our particular trial:</p>
<p><span class="math display">\[ Yield = Population \space Mean + Block \space Effect + Treatment \space Effect + Block \times Treatment \space Interaction\]</span></p>
<p>We can see how the additive model works in the following table:</p>
<div class="sourceCode" id="cb440"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb440-1"><a href="multiple-treatment-designs.html#cb440-1"></a>st_effects =<span class="st"> </span>st_data <span class="op">%&gt;%</span></span>
<span id="cb440-2"><a href="multiple-treatment-designs.html#cb440-2"></a><span class="st">  </span><span class="kw">select</span>(Block, row, Treatment, mu, B, T, BT, Y)</span>
<span id="cb440-3"><a href="multiple-treatment-designs.html#cb440-3"></a></span>
<span id="cb440-4"><a href="multiple-treatment-designs.html#cb440-4"></a>knitr<span class="op">::</span><span class="kw">kable</span>(st_effects)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Block</th>
<th align="right">row</th>
<th align="left">Treatment</th>
<th align="right">mu</th>
<th align="right">B</th>
<th align="right">T</th>
<th align="right">BT</th>
<th align="right">Y</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="right">1</td>
<td align="left">D</td>
<td align="right">68.3</td>
<td align="right">-2.2</td>
<td align="right">1.6</td>
<td align="right">-1.1</td>
<td align="right">66.6</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">2</td>
<td align="left">A</td>
<td align="right">68.3</td>
<td align="right">-2.2</td>
<td align="right">-1.1</td>
<td align="right">-0.8</td>
<td align="right">64.2</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="right">3</td>
<td align="left">C</td>
<td align="right">68.3</td>
<td align="right">-2.2</td>
<td align="right">0.8</td>
<td align="right">0.2</td>
<td align="right">67.1</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="right">4</td>
<td align="left">B</td>
<td align="right">68.3</td>
<td align="right">-2.2</td>
<td align="right">-0.3</td>
<td align="right">-1.5</td>
<td align="right">64.3</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="right">1</td>
<td align="left">C</td>
<td align="right">68.3</td>
<td align="right">-0.8</td>
<td align="right">0.8</td>
<td align="right">-0.4</td>
<td align="right">67.9</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">2</td>
<td align="left">A</td>
<td align="right">68.3</td>
<td align="right">-0.8</td>
<td align="right">-1.1</td>
<td align="right">-0.4</td>
<td align="right">66.0</td>
</tr>
<tr class="odd">
<td align="left">2</td>
<td align="right">3</td>
<td align="left">D</td>
<td align="right">68.3</td>
<td align="right">-0.8</td>
<td align="right">1.6</td>
<td align="right">-1.3</td>
<td align="right">67.8</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="right">4</td>
<td align="left">B</td>
<td align="right">68.3</td>
<td align="right">-0.8</td>
<td align="right">-0.3</td>
<td align="right">-0.1</td>
<td align="right">67.1</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">1</td>
<td align="left">C</td>
<td align="right">68.3</td>
<td align="right">0.3</td>
<td align="right">0.8</td>
<td align="right">1.0</td>
<td align="right">70.4</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="right">2</td>
<td align="left">B</td>
<td align="right">68.3</td>
<td align="right">0.3</td>
<td align="right">-0.3</td>
<td align="right">1.5</td>
<td align="right">69.8</td>
</tr>
<tr class="odd">
<td align="left">3</td>
<td align="right">3</td>
<td align="left">A</td>
<td align="right">68.3</td>
<td align="right">0.3</td>
<td align="right">-1.1</td>
<td align="right">1.3</td>
<td align="right">68.8</td>
</tr>
<tr class="even">
<td align="left">3</td>
<td align="right">4</td>
<td align="left">D</td>
<td align="right">68.3</td>
<td align="right">0.3</td>
<td align="right">1.6</td>
<td align="right">-1.6</td>
<td align="right">68.6</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="right">1</td>
<td align="left">A</td>
<td align="right">68.3</td>
<td align="right">1.2</td>
<td align="right">-1.1</td>
<td align="right">-0.1</td>
<td align="right">68.3</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="right">2</td>
<td align="left">B</td>
<td align="right">68.3</td>
<td align="right">1.2</td>
<td align="right">-0.3</td>
<td align="right">2.0</td>
<td align="right">71.2</td>
</tr>
<tr class="odd">
<td align="left">4</td>
<td align="right">3</td>
<td align="left">D</td>
<td align="right">68.3</td>
<td align="right">1.2</td>
<td align="right">1.6</td>
<td align="right">0.4</td>
<td align="right">71.5</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="right">4</td>
<td align="left">C</td>
<td align="right">68.3</td>
<td align="right">1.2</td>
<td align="right">0.8</td>
<td align="right">0.1</td>
<td align="right">70.4</td>
</tr>
</tbody>
</table>
<p>In the first row of the table, we see that the observed yield, Y, is:</p>
<p><span class="math display">\[ Y = 68.3 + (-2.2) + (1.3) + (-1.1) = 66.3 \]</span></p>
<p>Similarly, in the fifth row:</p>
<p><span class="math display">\[ Y = 68.3 + (-0.8) + (0.5) + (-0.4) = 67.6 \]</span></p>
</div>
<div id="analysis-of-variance-1" class="section level4">
<h4><span class="header-section-number">7.1.1.2</span> Analysis of Variance</h4>
<p>We can use the linear additive model above with R to create the proper linear model:</p>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="multiple-treatment-designs.html#cb441-1"></a>model =<span class="st"> </span><span class="kw">aov</span>(Y <span class="op">~</span><span class="st"> </span>Block <span class="op">+</span><span class="st"> </span>Treatment, st_data)</span>
<span id="cb441-2"><a href="multiple-treatment-designs.html#cb441-2"></a><span class="kw">anova</span>(model)</span></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: Y
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## Block      3 56.250 18.7500 23.7175 0.0001313 ***
## Treatment  3 10.485  3.4950  4.4209 0.0359018 *  
## Residuals  9  7.115  0.7906                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Note that in the above model, we only specify the Block and Treatment sources of variation. Any source of variation not included in the model and, if you will “leftover” from the model, is pooled into the Residuals, or error. In the model above, the interaction of Block and Treatment (BT) is not specified, for it is the source of any variation we observe from plot to plot.</p>
<p>Two sources of variation are tested above: Block and Treatment. The F-value for both is calculated by dividing their Mean Square by the Residual (or Error) Mean Square. The probability that the difference among blocks or treatment is zero, given their observed F-value, is reported in the <span class="math inline">\(Pr(&gt;F)\)</span> column.</p>
<p>The Block effect is usually of less interest in analyzing table results. If it is insignificant, that may indicate we don’t need to block in this location in the future, but in the vast majority of trials there will be at least some benefit to blocking.</p>
<p>The most important effect of blocking is seen upon examining the Sum of Squares (“Sum Sq”) column. Here we can see just how much the Residual Sum of Squares was reduced by including blocks in the model. Had we not included the Block term in our model, our Residual Sum of Squares would have been about 63.4. Even given the greater residual degress of freedom (which would have included the three degrees of freedom that were assigned to Block, the residual mean square would have been about <span class="math inline">\(64\div12 = 5.3\)</span>. Without even calculating F, we can see the error mean square would have been larger than the treatment mean square, meaning there was more variance within treatments than between them. The Treatment effect would not have been significant.</p>
</div>
</div>
</div>
<div id="factorial-design" class="section level2">
<h2><span class="header-section-number">7.2</span> Factorial Design</h2>
<p>Agronomy is all about interactions. How do hybrids differ in their response to nitrogen? Response to fungicide? Does a fungicide increase yield more when it is sprayed on corn at V5 or VT? Does the effect of a starter fertilizer depend whether it is applied in-row or in a 2x2 band? How does a crop respond to popuation in 30-inch rows vs 15-inch rows?</p>
<p>To grow a successful crop requires not a single input, but dozens, some of which we can manage and others we can’t. So the issue of how different treatments interact is critical. It is also often more efficient and informative for us to study these interactions together in a single trial, than to study them separately in two or more trials.</p>
<p>Before we go further, some nomenclature. In factorial design, treatments that differ in a single variable are called levels, and these levels together compose a factor. Here are some examples of levels and factors:</p>
<ul>
<li>multiple micronutrient products all applied at the V5 stage in corn – the product composition is the level, the timing the factor</li>
<li>a single fungicide product, applied at V5, V10, or VT in corn – the timing is the level, the fungicide composition the factor</li>
<li>a single adjuvant, tested with different nozzles – the nozzle is the level, the adjuvant composition the factor</li>
<li>multiple hybrids, grown in rotation following soybean – the hybrid is the level, the crop rotation is the factor</li>
</ul>
<p>As you may have anticipated, a factorial design combines two or more factors, each containing two or more levels. For example:</p>
<ul>
<li>Factor “Composition” includes two levels of foliar micronutrient product: Mn and Zn</li>
<li>Factor Timing" includes two levels of timing: V5 and VT</li>
</ul>
<p>In a factorial designm, every level of factor Composition will occur with every level of factor Timing. We can visualize these treatment combinations the same way we might visualize a Punnet square in Mendalian genetics. The main effects are given on the axes and the particular treatment combinations are in the cells.</p>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="multiple-treatment-designs.html#cb443-1"></a>factorial_trts_<span class="dv">1</span> =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Timing =</span> <span class="kw">c</span>(<span class="st">&quot;V5&quot;</span>, <span class="st">&quot;VT&quot;</span>, <span class="st">&quot;V5&quot;</span>, <span class="st">&quot;VT&quot;</span>),</span>
<span id="cb443-2"><a href="multiple-treatment-designs.html#cb443-2"></a>                              <span class="dt">Composition =</span> <span class="kw">c</span>(<span class="st">&quot;Mn&quot;</span>, <span class="st">&quot;Mn&quot;</span>, <span class="st">&quot;Zn&quot;</span>, <span class="st">&quot;Zn&quot;</span>),</span>
<span id="cb443-3"><a href="multiple-treatment-designs.html#cb443-3"></a>                              <span class="dt">trt =</span> <span class="kw">c</span>(<span class="st">&quot;Mn @ V5&quot;</span>,  <span class="st">&quot;Mn @ VT&quot;</span>, <span class="st">&quot;Zn @ V5&quot;</span>, <span class="st">&quot;Zn @ VT&quot;</span>))</span>
<span id="cb443-4"><a href="multiple-treatment-designs.html#cb443-4"></a></span>
<span id="cb443-5"><a href="multiple-treatment-designs.html#cb443-5"></a>factorial_trts_<span class="dv">1</span> <span class="op">%&gt;%</span></span>
<span id="cb443-6"><a href="multiple-treatment-designs.html#cb443-6"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Timing, <span class="dt">y=</span>Composition)) <span class="op">+</span></span>
<span id="cb443-7"><a href="multiple-treatment-designs.html#cb443-7"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;grey&quot;</span>) <span class="op">+</span></span>
<span id="cb443-8"><a href="multiple-treatment-designs.html#cb443-8"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> trt), <span class="dt">size=</span><span class="dv">6</span>) <span class="op">+</span></span>
<span id="cb443-9"><a href="multiple-treatment-designs.html#cb443-9"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">18</span>),</span>
<span id="cb443-10"><a href="multiple-treatment-designs.html#cb443-10"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>))</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>In another example:
- Factor “Composition” consists of two adjuvant ingredients: guar (G) or an polyacrylamide (P)
- Nozzles are Flat Fan (F) or AI nozzle (A)</p>
<p>Our treatments in the factorial design, then, are:</p>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="multiple-treatment-designs.html#cb444-1"></a>factorial_trts_<span class="dv">2</span> =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Nozzle =</span> <span class="kw">c</span>(<span class="st">&quot;FF&quot;</span>, <span class="st">&quot;AI&quot;</span>, <span class="st">&quot;FF&quot;</span>, <span class="st">&quot;AI&quot;</span>),</span>
<span id="cb444-2"><a href="multiple-treatment-designs.html#cb444-2"></a>                              <span class="dt">Composition =</span> <span class="kw">c</span>(<span class="st">&quot;G&quot;</span>, <span class="st">&quot;G&quot;</span>, <span class="st">&quot;P&quot;</span>, <span class="st">&quot;P&quot;</span>),</span>
<span id="cb444-3"><a href="multiple-treatment-designs.html#cb444-3"></a>                              <span class="dt">trt =</span> <span class="kw">c</span>(<span class="st">&quot;FF x G&quot;</span>,  <span class="st">&quot;AI x G&quot;</span>, <span class="st">&quot;FF x P&quot;</span>, <span class="st">&quot;AI x P&quot;</span>))</span>
<span id="cb444-4"><a href="multiple-treatment-designs.html#cb444-4"></a></span>
<span id="cb444-5"><a href="multiple-treatment-designs.html#cb444-5"></a>factorial_trts_<span class="dv">2</span> <span class="op">%&gt;%</span></span>
<span id="cb444-6"><a href="multiple-treatment-designs.html#cb444-6"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Nozzle, <span class="dt">y=</span>Composition)) <span class="op">+</span></span>
<span id="cb444-7"><a href="multiple-treatment-designs.html#cb444-7"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;grey&quot;</span>) <span class="op">+</span></span>
<span id="cb444-8"><a href="multiple-treatment-designs.html#cb444-8"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> trt), <span class="dt">size=</span><span class="dv">6</span>) <span class="op">+</span></span>
<span id="cb444-9"><a href="multiple-treatment-designs.html#cb444-9"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">18</span>),</span>
<span id="cb444-10"><a href="multiple-treatment-designs.html#cb444-10"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>))</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<div id="case-study-1-1" class="section level3">
<h3><span class="header-section-number">7.2.1</span> Case Study 1</h3>
<p>Our case study is a clover forage trial conducted in New Zealand from 1992 to 1994. This dataset is publically available as part of the <em>agridat</em> package in R. For this first case study, we will focus on a subset of the data. The two factors were sulfur (S) and phosphorus (P) fertilizer. Sulfur was applied at 0, 11.25, or 22.5 kg/ha, while phosphorus was applied at 0, 40, and 80 kg/ha. Yield is reported in tons/hectare.</p>
<p>Factorial trials are often nicknames by the number of levels of each factor. In this case, we have a <span class="math inline">\(three-by-three\)</span>, or <span class="math inline">\(3\times3\)</span> trial. We can visualize the factorial combinations as producing the following nine treatments:</p>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="multiple-treatment-designs.html#cb445-1"></a>factorial_trts_<span class="dv">3</span>_main =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Sulfur =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">11.25</span>, <span class="fl">22.5</span>),<span class="dv">3</span>),</span>
<span id="cb445-2"><a href="multiple-treatment-designs.html#cb445-2"></a>                              <span class="dt">Phosphorus =</span> <span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">80</span>,<span class="dv">160</span>), <span class="dt">each=</span><span class="dv">3</span>))</span>
<span id="cb445-3"><a href="multiple-treatment-designs.html#cb445-3"></a></span>
<span id="cb445-4"><a href="multiple-treatment-designs.html#cb445-4"></a>factorial_trts_<span class="dv">3</span>_combos =<span class="st"> </span>factorial_trts_<span class="dv">3</span>_main <span class="op">%&gt;%</span></span>
<span id="cb445-5"><a href="multiple-treatment-designs.html#cb445-5"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">trt =</span> <span class="kw">paste0</span>(<span class="st">&quot;S = &quot;</span>, Sulfur, <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>, <span class="st">&quot;P = &quot;</span>, Phosphorus))</span>
<span id="cb445-6"><a href="multiple-treatment-designs.html#cb445-6"></a>                              </span>
<span id="cb445-7"><a href="multiple-treatment-designs.html#cb445-7"></a>factorial_trts_<span class="dv">3</span>_combos <span class="op">%&gt;%</span></span>
<span id="cb445-8"><a href="multiple-treatment-designs.html#cb445-8"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Sulfur, <span class="dt">y=</span>Phosphorus)) <span class="op">+</span></span>
<span id="cb445-9"><a href="multiple-treatment-designs.html#cb445-9"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;grey&quot;</span>) <span class="op">+</span></span>
<span id="cb445-10"><a href="multiple-treatment-designs.html#cb445-10"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label =</span> trt), <span class="dt">size=</span><span class="dv">6</span>) <span class="op">+</span></span>
<span id="cb445-11"><a href="multiple-treatment-designs.html#cb445-11"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">18</span>),</span>
<span id="cb445-12"><a href="multiple-treatment-designs.html#cb445-12"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>))</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="multiple-treatment-designs.html#cb446-1"></a><span class="kw">library</span>(agridat)</span>
<span id="cb446-2"><a href="multiple-treatment-designs.html#cb446-2"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb446-3"><a href="multiple-treatment-designs.html#cb446-3"></a>clover =<span class="st"> </span>sinclair.clover</span>
<span id="cb446-4"><a href="multiple-treatment-designs.html#cb446-4"></a></span>
<span id="cb446-5"><a href="multiple-treatment-designs.html#cb446-5"></a>clover_dataset =<span class="st"> </span>clover <span class="op">%&gt;%</span></span>
<span id="cb446-6"><a href="multiple-treatment-designs.html#cb446-6"></a><span class="st">  </span><span class="kw">filter</span>(S <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">11.25</span>, <span class="fl">22.50</span>)) <span class="op">%&gt;%</span></span>
<span id="cb446-7"><a href="multiple-treatment-designs.html#cb446-7"></a><span class="st">  </span><span class="kw">filter</span>(P <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">80</span>, <span class="dv">160</span>)) <span class="op">%&gt;%</span></span>
<span id="cb446-8"><a href="multiple-treatment-designs.html#cb446-8"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">S =</span> <span class="kw">as.factor</span>(S),</span>
<span id="cb446-9"><a href="multiple-treatment-designs.html#cb446-9"></a>         <span class="dt">P =</span> <span class="kw">as.factor</span>(P))</span>
<span id="cb446-10"><a href="multiple-treatment-designs.html#cb446-10"></a></span>
<span id="cb446-11"><a href="multiple-treatment-designs.html#cb446-11"></a></span>
<span id="cb446-12"><a href="multiple-treatment-designs.html#cb446-12"></a></span>
<span id="cb446-13"><a href="multiple-treatment-designs.html#cb446-13"></a></span>
<span id="cb446-14"><a href="multiple-treatment-designs.html#cb446-14"></a>clover_data =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">block =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dt">each=</span><span class="dv">9</span>),</span>
<span id="cb446-15"><a href="multiple-treatment-designs.html#cb446-15"></a>                         <span class="dt">treatment =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>, <span class="dv">4</span>),</span>
<span id="cb446-16"><a href="multiple-treatment-designs.html#cb446-16"></a>                         <span class="dt">sulfur =</span> <span class="kw">rep</span>(clover_dataset<span class="op">$</span>S,<span class="dv">4</span>),</span>
<span id="cb446-17"><a href="multiple-treatment-designs.html#cb446-17"></a>                         <span class="dt">phosphorus =</span> <span class="kw">rep</span>(clover_dataset<span class="op">$</span>P,<span class="dv">4</span>),</span>
<span id="cb446-18"><a href="multiple-treatment-designs.html#cb446-18"></a>                         <span class="dt">s_p_means =</span> <span class="kw">rep</span>(clover_dataset<span class="op">$</span>yield,<span class="dv">4</span>))</span>
<span id="cb446-19"><a href="multiple-treatment-designs.html#cb446-19"></a></span>
<span id="cb446-20"><a href="multiple-treatment-designs.html#cb446-20"></a>clover_effects =<span class="st"> </span>clover_data <span class="op">%&gt;%</span></span>
<span id="cb446-21"><a href="multiple-treatment-designs.html#cb446-21"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mu =</span> <span class="kw">mean</span>(s_p_means)) <span class="op">%&gt;%</span></span>
<span id="cb446-22"><a href="multiple-treatment-designs.html#cb446-22"></a><span class="st">  </span><span class="kw">group_by</span>(sulfur) <span class="op">%&gt;%</span></span>
<span id="cb446-23"><a href="multiple-treatment-designs.html#cb446-23"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">S =</span> <span class="kw">mean</span>(s_p_means) <span class="op">-</span><span class="st"> </span>mu) <span class="op">%&gt;%</span></span>
<span id="cb446-24"><a href="multiple-treatment-designs.html#cb446-24"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb446-25"><a href="multiple-treatment-designs.html#cb446-25"></a><span class="st">  </span><span class="kw">group_by</span>(phosphorus) <span class="op">%&gt;%</span></span>
<span id="cb446-26"><a href="multiple-treatment-designs.html#cb446-26"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">P =</span> <span class="kw">mean</span>(s_p_means) <span class="op">-</span><span class="st"> </span>mu) <span class="op">%&gt;%</span></span>
<span id="cb446-27"><a href="multiple-treatment-designs.html#cb446-27"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb446-28"><a href="multiple-treatment-designs.html#cb446-28"></a><span class="st">  </span><span class="kw">group_by</span>(sulfur, phosphorus) <span class="op">%&gt;%</span></span>
<span id="cb446-29"><a href="multiple-treatment-designs.html#cb446-29"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">SP =</span> <span class="kw">mean</span>(s_p_means) <span class="op">-</span><span class="st"> </span>(mu <span class="op">+</span><span class="st"> </span>S <span class="op">+</span><span class="st"> </span>P)) <span class="op">%&gt;%</span></span>
<span id="cb446-30"><a href="multiple-treatment-designs.html#cb446-30"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb446-31"><a href="multiple-treatment-designs.html#cb446-31"></a><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>treatment, <span class="op">-</span>s_p_means) <span class="op">%&gt;%</span></span>
<span id="cb446-32"><a href="multiple-treatment-designs.html#cb446-32"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mu =</span> <span class="kw">round</span>(mu,<span class="dv">2</span>),</span>
<span id="cb446-33"><a href="multiple-treatment-designs.html#cb446-33"></a>         <span class="dt">S =</span> <span class="kw">round</span>(S,<span class="dv">2</span>),</span>
<span id="cb446-34"><a href="multiple-treatment-designs.html#cb446-34"></a>         <span class="dt">P =</span> <span class="kw">round</span>(S,<span class="dv">2</span>),</span>
<span id="cb446-35"><a href="multiple-treatment-designs.html#cb446-35"></a>         <span class="dt">SP =</span> <span class="kw">round</span>(SP,<span class="dv">2</span>))</span>
<span id="cb446-36"><a href="multiple-treatment-designs.html#cb446-36"></a></span>
<span id="cb446-37"><a href="multiple-treatment-designs.html#cb446-37"></a></span>
<span id="cb446-38"><a href="multiple-treatment-designs.html#cb446-38"></a><span class="kw">set.seed</span>(<span class="dv">073020</span>)</span>
<span id="cb446-39"><a href="multiple-treatment-designs.html#cb446-39"></a>clover_final =<span class="st"> </span>clover_effects <span class="op">%&gt;%</span></span>
<span id="cb446-40"><a href="multiple-treatment-designs.html#cb446-40"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Error =</span> <span class="kw">rnorm</span>(<span class="dv">36</span>, <span class="dv">0</span>, <span class="fl">0.4</span>)) <span class="op">%&gt;%</span></span>
<span id="cb446-41"><a href="multiple-treatment-designs.html#cb446-41"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Error =</span> <span class="kw">round</span>(Error, <span class="dv">1</span>)) <span class="op">%&gt;%</span></span>
<span id="cb446-42"><a href="multiple-treatment-designs.html#cb446-42"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Yield =</span> mu <span class="op">+</span><span class="st"> </span>S <span class="op">+</span><span class="st"> </span>P <span class="op">+</span><span class="st"> </span>SP <span class="op">+</span><span class="st"> </span>Error) </span></code></pre></div>
<p>When we deal with factorial designs, it is important to visualize the data. We can observe the data patterns using a line plot. We see clover yield increased with sulfur and phosphorus. We notice, however, the difference in yield between P=80 and P=160 is greater when S=0 than when S=11.25 or S=22.5. We also notice the difference betwee sulfur=0 and sulfur=22.5 is greater for P=160 than P=0.</p>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="multiple-treatment-designs.html#cb447-1"></a>clover_final <span class="op">%&gt;%</span></span>
<span id="cb447-2"><a href="multiple-treatment-designs.html#cb447-2"></a><span class="st">  </span><span class="kw">group_by</span>(sulfur, phosphorus) <span class="op">%&gt;%</span></span>
<span id="cb447-3"><a href="multiple-treatment-designs.html#cb447-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Yield =</span> <span class="kw">mean</span>(Yield)) <span class="op">%&gt;%</span></span>
<span id="cb447-4"><a href="multiple-treatment-designs.html#cb447-4"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb447-5"><a href="multiple-treatment-designs.html#cb447-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>sulfur, <span class="dt">y=</span>Yield, <span class="dt">group=</span>phosphorus)) <span class="op">+</span></span>
<span id="cb447-6"><a href="multiple-treatment-designs.html#cb447-6"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color=</span>phosphorus), <span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb447-7"><a href="multiple-treatment-designs.html#cb447-7"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),</span>
<span id="cb447-8"><a href="multiple-treatment-designs.html#cb447-8"></a>        <span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>),</span>
<span id="cb447-9"><a href="multiple-treatment-designs.html#cb447-9"></a>        <span class="dt">legend.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">12</span>),</span>
<span id="cb447-10"><a href="multiple-treatment-designs.html#cb447-10"></a>        <span class="dt">legend.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;sulfur&#39;. You can override using the `.groups` argument.</code></pre>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>These differences are called <em>interactions</em> and are the most interesting part of a factorial design. In this case, it is no surprise that crop yield increases with sulfur fertiliztion in a sulfur soil. It is interesting, however, that the response to sulfur is appears to be dependent on phosphorus fertilization, and lends support to Liebig’s <em>Law of the Minimum</em>, which states that addition of a particular nutrient will not increase yield if other nutrients are more deficient.</p>
<div id="linear-additive-model-1" class="section level4">
<h4><span class="header-section-number">7.2.1.1</span> Linear Additive Model</h4>
<p>For our trial with two factors, the linear model is:</p>
<p><span class="math display">\[ Y_{ijk} = \mu + S_i + P_j + SP_{ij} + \epsilon_{ij(k)} \]</span>
Each observed value, then, is the sum (additive value) of the population mean (<span class="math inline">\(\mu\)</span>), sulfur effect (<span class="math inline">\(S\)</span>), phosphorus effect (<span class="math inline">\(P\)</span>), the interaction of sulfur and phosphorus (<span class="math inline">\(SP\)</span>), and the error (<span class="math inline">\(\epsilon\)</span>). As in previous models, error is the random source of variation due to environmental and instrumental inconsistency. <span class="math inline">\(S_i\)</span> and <span class="math inline">\(P_j\)</span> are described as <em>main effects</em>. <span class="math inline">\(SP_{ij}\)</span> is the interaction.</p>
<p>In the table below, the effects from this linear model are broken out:</p>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="multiple-treatment-designs.html#cb449-1"></a>knitr<span class="op">::</span><span class="kw">kable</span>(clover_final)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">block</th>
<th align="left">sulfur</th>
<th align="left">phosphorus</th>
<th align="right">mu</th>
<th align="right">S</th>
<th align="right">P</th>
<th align="right">SP</th>
<th align="right">Error</th>
<th align="right">Yield</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="right">5.72</td>
<td align="right">-2.06</td>
<td align="right">-2.06</td>
<td align="right">0.37</td>
<td align="right">-0.1</td>
<td align="right">1.87</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">0</td>
<td align="left">80</td>
<td align="right">5.72</td>
<td align="right">-2.06</td>
<td align="right">-2.06</td>
<td align="right">-0.38</td>
<td align="right">0.2</td>
<td align="right">1.42</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">0</td>
<td align="left">160</td>
<td align="right">5.72</td>
<td align="right">-2.06</td>
<td align="right">-2.06</td>
<td align="right">0.01</td>
<td align="right">0.1</td>
<td align="right">1.71</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">11.25</td>
<td align="left">0</td>
<td align="right">5.72</td>
<td align="right">0.24</td>
<td align="right">0.24</td>
<td align="right">0.29</td>
<td align="right">0.2</td>
<td align="right">6.69</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">11.25</td>
<td align="left">80</td>
<td align="right">5.72</td>
<td align="right">0.24</td>
<td align="right">0.24</td>
<td align="right">0.16</td>
<td align="right">-0.4</td>
<td align="right">5.96</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">11.25</td>
<td align="left">160</td>
<td align="right">5.72</td>
<td align="right">0.24</td>
<td align="right">0.24</td>
<td align="right">-0.44</td>
<td align="right">0.0</td>
<td align="right">5.76</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">22.5</td>
<td align="left">0</td>
<td align="right">5.72</td>
<td align="right">1.81</td>
<td align="right">1.81</td>
<td align="right">-0.66</td>
<td align="right">0.6</td>
<td align="right">9.28</td>
</tr>
<tr class="even">
<td align="right">1</td>
<td align="left">22.5</td>
<td align="left">80</td>
<td align="right">5.72</td>
<td align="right">1.81</td>
<td align="right">1.81</td>
<td align="right">0.23</td>
<td align="right">0.2</td>
<td align="right">9.77</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="left">22.5</td>
<td align="left">160</td>
<td align="right">5.72</td>
<td align="right">1.81</td>
<td align="right">1.81</td>
<td align="right">0.43</td>
<td align="right">-0.3</td>
<td align="right">9.47</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="right">5.72</td>
<td align="right">-2.06</td>
<td align="right">-2.06</td>
<td align="right">0.37</td>
<td align="right">0.4</td>
<td align="right">2.37</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">0</td>
<td align="left">80</td>
<td align="right">5.72</td>
<td align="right">-2.06</td>
<td align="right">-2.06</td>
<td align="right">-0.38</td>
<td align="right">0.0</td>
<td align="right">1.22</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">0</td>
<td align="left">160</td>
<td align="right">5.72</td>
<td align="right">-2.06</td>
<td align="right">-2.06</td>
<td align="right">0.01</td>
<td align="right">0.2</td>
<td align="right">1.81</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">11.25</td>
<td align="left">0</td>
<td align="right">5.72</td>
<td align="right">0.24</td>
<td align="right">0.24</td>
<td align="right">0.29</td>
<td align="right">1.0</td>
<td align="right">7.49</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">11.25</td>
<td align="left">80</td>
<td align="right">5.72</td>
<td align="right">0.24</td>
<td align="right">0.24</td>
<td align="right">0.16</td>
<td align="right">0.1</td>
<td align="right">6.46</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">11.25</td>
<td align="left">160</td>
<td align="right">5.72</td>
<td align="right">0.24</td>
<td align="right">0.24</td>
<td align="right">-0.44</td>
<td align="right">-0.4</td>
<td align="right">5.36</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">22.5</td>
<td align="left">0</td>
<td align="right">5.72</td>
<td align="right">1.81</td>
<td align="right">1.81</td>
<td align="right">-0.66</td>
<td align="right">-0.2</td>
<td align="right">8.48</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="left">22.5</td>
<td align="left">80</td>
<td align="right">5.72</td>
<td align="right">1.81</td>
<td align="right">1.81</td>
<td align="right">0.23</td>
<td align="right">-0.1</td>
<td align="right">9.47</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">22.5</td>
<td align="left">160</td>
<td align="right">5.72</td>
<td align="right">1.81</td>
<td align="right">1.81</td>
<td align="right">0.43</td>
<td align="right">0.2</td>
<td align="right">9.97</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="right">5.72</td>
<td align="right">-2.06</td>
<td align="right">-2.06</td>
<td align="right">0.37</td>
<td align="right">0.4</td>
<td align="right">2.37</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">0</td>
<td align="left">80</td>
<td align="right">5.72</td>
<td align="right">-2.06</td>
<td align="right">-2.06</td>
<td align="right">-0.38</td>
<td align="right">-0.1</td>
<td align="right">1.12</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">0</td>
<td align="left">160</td>
<td align="right">5.72</td>
<td align="right">-2.06</td>
<td align="right">-2.06</td>
<td align="right">0.01</td>
<td align="right">0.7</td>
<td align="right">2.31</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">11.25</td>
<td align="left">0</td>
<td align="right">5.72</td>
<td align="right">0.24</td>
<td align="right">0.24</td>
<td align="right">0.29</td>
<td align="right">0.2</td>
<td align="right">6.69</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">11.25</td>
<td align="left">80</td>
<td align="right">5.72</td>
<td align="right">0.24</td>
<td align="right">0.24</td>
<td align="right">0.16</td>
<td align="right">-0.6</td>
<td align="right">5.76</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">11.25</td>
<td align="left">160</td>
<td align="right">5.72</td>
<td align="right">0.24</td>
<td align="right">0.24</td>
<td align="right">-0.44</td>
<td align="right">0.9</td>
<td align="right">6.66</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">22.5</td>
<td align="left">0</td>
<td align="right">5.72</td>
<td align="right">1.81</td>
<td align="right">1.81</td>
<td align="right">-0.66</td>
<td align="right">0.4</td>
<td align="right">9.08</td>
</tr>
<tr class="even">
<td align="right">3</td>
<td align="left">22.5</td>
<td align="left">80</td>
<td align="right">5.72</td>
<td align="right">1.81</td>
<td align="right">1.81</td>
<td align="right">0.23</td>
<td align="right">-0.3</td>
<td align="right">9.27</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">22.5</td>
<td align="left">160</td>
<td align="right">5.72</td>
<td align="right">1.81</td>
<td align="right">1.81</td>
<td align="right">0.43</td>
<td align="right">0.0</td>
<td align="right">9.77</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="right">5.72</td>
<td align="right">-2.06</td>
<td align="right">-2.06</td>
<td align="right">0.37</td>
<td align="right">0.4</td>
<td align="right">2.37</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">0</td>
<td align="left">80</td>
<td align="right">5.72</td>
<td align="right">-2.06</td>
<td align="right">-2.06</td>
<td align="right">-0.38</td>
<td align="right">-0.6</td>
<td align="right">0.62</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">0</td>
<td align="left">160</td>
<td align="right">5.72</td>
<td align="right">-2.06</td>
<td align="right">-2.06</td>
<td align="right">0.01</td>
<td align="right">0.4</td>
<td align="right">2.01</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">11.25</td>
<td align="left">0</td>
<td align="right">5.72</td>
<td align="right">0.24</td>
<td align="right">0.24</td>
<td align="right">0.29</td>
<td align="right">-0.2</td>
<td align="right">6.29</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">11.25</td>
<td align="left">80</td>
<td align="right">5.72</td>
<td align="right">0.24</td>
<td align="right">0.24</td>
<td align="right">0.16</td>
<td align="right">0.2</td>
<td align="right">6.56</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">11.25</td>
<td align="left">160</td>
<td align="right">5.72</td>
<td align="right">0.24</td>
<td align="right">0.24</td>
<td align="right">-0.44</td>
<td align="right">-0.1</td>
<td align="right">5.66</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">22.5</td>
<td align="left">0</td>
<td align="right">5.72</td>
<td align="right">1.81</td>
<td align="right">1.81</td>
<td align="right">-0.66</td>
<td align="right">-0.3</td>
<td align="right">8.38</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="left">22.5</td>
<td align="left">80</td>
<td align="right">5.72</td>
<td align="right">1.81</td>
<td align="right">1.81</td>
<td align="right">0.23</td>
<td align="right">0.2</td>
<td align="right">9.77</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">22.5</td>
<td align="left">160</td>
<td align="right">5.72</td>
<td align="right">1.81</td>
<td align="right">1.81</td>
<td align="right">0.43</td>
<td align="right">-0.3</td>
<td align="right">9.47</td>
</tr>
</tbody>
</table>
</div>
<div id="analysis-of-variance-2" class="section level4">
<h4><span class="header-section-number">7.2.1.2</span> Analysis of Variance</h4>
<p>In R, we use the same approach as previous weeks. All terms from the linear model, except the population mean and error, are included in the model statement.</p>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="multiple-treatment-designs.html#cb450-1"></a><span class="kw">library</span>(broom)</span>
<span id="cb450-2"><a href="multiple-treatment-designs.html#cb450-2"></a><span class="co"># define the model</span></span>
<span id="cb450-3"><a href="multiple-treatment-designs.html#cb450-3"></a>model =<span class="st"> </span><span class="kw">aov</span>(Yield <span class="op">~</span><span class="st"> </span>sulfur <span class="op">+</span><span class="st"> </span>phosphorus <span class="op">+</span><span class="st"> </span>sulfur<span class="op">:</span>phosphorus, <span class="dt">data =</span> clover_final)</span>
<span id="cb450-4"><a href="multiple-treatment-designs.html#cb450-4"></a><span class="co">#run the anova</span></span>
<span id="cb450-5"><a href="multiple-treatment-designs.html#cb450-5"></a>anova_tab =<span class="st"> </span><span class="kw">tidy</span>(model)</span>
<span id="cb450-6"><a href="multiple-treatment-designs.html#cb450-6"></a></span>
<span id="cb450-7"><a href="multiple-treatment-designs.html#cb450-7"></a>knitr<span class="op">::</span><span class="kw">kable</span>(anova_tab)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">df</th>
<th align="right">sumsq</th>
<th align="right">meansq</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">sulfur</td>
<td align="right">2</td>
<td align="right">349.0468222</td>
<td align="right">174.5234111</td>
<td align="right">1227.117734</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">phosphorus</td>
<td align="right">2</td>
<td align="right">0.6720889</td>
<td align="right">0.3360444</td>
<td align="right">2.362812</td>
<td align="right">0.1133374</td>
</tr>
<tr class="odd">
<td align="left">sulfur:phosphorus</td>
<td align="right">4</td>
<td align="right">5.7705111</td>
<td align="right">1.4426278</td>
<td align="right">10.143477</td>
<td align="right">0.0000381</td>
</tr>
<tr class="even">
<td align="left">Residuals</td>
<td align="right">27</td>
<td align="right">3.8400000</td>
<td align="right">0.1422222</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p>In the table, we see that the main effect of sulfur is significant at the <span class="math inline">\(P \le 0.05\)</span> level. The phosphorus effect is not significant. The interaction (sulfur:phosphorus) effect is also significant at the <span class="math inline">\(P\le0.05\)</span> level.</p>
<p>When an interaction is significant, we should examine the effect of one factor independently at each level of the other. We can group analyses of one factor by levels of another factor using the <em>group_by</em> command in R. In this case we will tell R to run the analysis of variance for the sulfur effect separately for each level of P.</p>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="multiple-treatment-designs.html#cb451-1"></a><span class="kw">library</span>(broom)</span>
<span id="cb451-2"><a href="multiple-treatment-designs.html#cb451-2"></a>slice_<span class="dv">1</span> =<span class="st"> </span>clover_final <span class="op">%&gt;%</span></span>
<span id="cb451-3"><a href="multiple-treatment-designs.html#cb451-3"></a><span class="st">  </span><span class="kw">group_by</span>(phosphorus) <span class="op">%&gt;%</span></span>
<span id="cb451-4"><a href="multiple-treatment-designs.html#cb451-4"></a><span class="st">  </span><span class="kw">do</span>(<span class="kw">tidy</span>(<span class="kw">aov</span>(.<span class="op">$</span>Yield <span class="op">~</span><span class="st"> </span>.<span class="op">$</span>sulfur))) <span class="op">%&gt;%</span></span>
<span id="cb451-5"><a href="multiple-treatment-designs.html#cb451-5"></a><span class="st">  </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb451-6"><a href="multiple-treatment-designs.html#cb451-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">term =</span> <span class="kw">gsub</span>(<span class="st">&quot;[.][$]&quot;</span>, <span class="st">&quot;&quot;</span>, term))</span>
<span id="cb451-7"><a href="multiple-treatment-designs.html#cb451-7"></a></span>
<span id="cb451-8"><a href="multiple-treatment-designs.html#cb451-8"></a>knitr<span class="op">::</span><span class="kw">kable</span>(slice_<span class="dv">1</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">phosphorus</th>
<th align="left">term</th>
<th align="right">df</th>
<th align="right">sumsq</th>
<th align="right">meansq</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="left">sulfur</td>
<td align="right">2</td>
<td align="right">90.33447</td>
<td align="right">45.1672333</td>
<td align="right">264.8242</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">0</td>
<td align="left">Residuals</td>
<td align="right">9</td>
<td align="right">1.53500</td>
<td align="right">0.1705556</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">80</td>
<td align="left">sulfur</td>
<td align="right">2</td>
<td align="right">145.58927</td>
<td align="right">72.7946333</td>
<td align="right">671.9505</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">80</td>
<td align="left">Residuals</td>
<td align="right">9</td>
<td align="right">0.97500</td>
<td align="right">0.1083333</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">160</td>
<td align="left">sulfur</td>
<td align="right">2</td>
<td align="right">118.89360</td>
<td align="right">59.4468000</td>
<td align="right">402.2716</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">160</td>
<td align="left">Residuals</td>
<td align="right">9</td>
<td align="right">1.33000</td>
<td align="right">0.1477778</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p>We see that the effect of sulfur is significant at each level of phosphorus. We can group analyses of phosphorusby each level of sulfur.</p>
<div class="sourceCode" id="cb452"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb452-1"><a href="multiple-treatment-designs.html#cb452-1"></a><span class="kw">library</span>(broom)</span>
<span id="cb452-2"><a href="multiple-treatment-designs.html#cb452-2"></a>slice_<span class="dv">2</span> =<span class="st"> </span>clover_final <span class="op">%&gt;%</span></span>
<span id="cb452-3"><a href="multiple-treatment-designs.html#cb452-3"></a><span class="st">  </span><span class="kw">group_by</span>(sulfur) <span class="op">%&gt;%</span></span>
<span id="cb452-4"><a href="multiple-treatment-designs.html#cb452-4"></a><span class="st">  </span><span class="kw">do</span>(<span class="kw">tidy</span>(<span class="kw">aov</span>(.<span class="op">$</span>Yield <span class="op">~</span><span class="st"> </span>.<span class="op">$</span>phosphorus))) <span class="op">%&gt;%</span></span>
<span id="cb452-5"><a href="multiple-treatment-designs.html#cb452-5"></a><span class="st">  </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb452-6"><a href="multiple-treatment-designs.html#cb452-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">term =</span> <span class="kw">gsub</span>(<span class="st">&quot;[.][$]&quot;</span>, <span class="st">&quot;&quot;</span>, term))</span>
<span id="cb452-7"><a href="multiple-treatment-designs.html#cb452-7"></a></span>
<span id="cb452-8"><a href="multiple-treatment-designs.html#cb452-8"></a>knitr<span class="op">::</span><span class="kw">kable</span>(slice_<span class="dv">2</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">sulfur</th>
<th align="left">term</th>
<th align="right">df</th>
<th align="right">sumsq</th>
<th align="right">meansq</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="left">phosphorus</td>
<td align="right">2</td>
<td align="right">2.869267</td>
<td align="right">1.4346333</td>
<td align="right">17.331141</td>
<td align="right">0.0008196</td>
</tr>
<tr class="even">
<td align="left">0</td>
<td align="left">Residuals</td>
<td align="right">9</td>
<td align="right">0.745000</td>
<td align="right">0.0827778</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">11.25</td>
<td align="left">phosphorus</td>
<td align="right">2</td>
<td align="right">1.782067</td>
<td align="right">0.8910333</td>
<td align="right">3.734249</td>
<td align="right">0.0659399</td>
</tr>
<tr class="even">
<td align="left">11.25</td>
<td align="left">Residuals</td>
<td align="right">9</td>
<td align="right">2.147500</td>
<td align="right">0.2386111</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">22.5</td>
<td align="left">phosphorus</td>
<td align="right">2</td>
<td align="right">1.791267</td>
<td align="right">0.8956333</td>
<td align="right">8.507335</td>
<td align="right">0.0084258</td>
</tr>
<tr class="even">
<td align="left">22.5</td>
<td align="left">Residuals</td>
<td align="right">9</td>
<td align="right">0.947500</td>
<td align="right">0.1052778</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p>Whoa, what is going on here! We can now see the phosphorus effect is significant at S=0 and S=22.5, and almost significant at S=11.25. If we look at the line plot above, we see that phosphorus increases yield when S=0 and S=11.25, but decreases yield when S=22.5. The positive and negative effects cancelled each out when we looked at the overall analysis of variance – the interaction <em>masked</em> the sulfur effect so that its significance was not reflected in the results.</p>
<p>This demonstrates why it is so important to investigate interactions before making inferences about treatments. If we concluded from the first analysis of variance that sulfur affected yield, we would have been accurate. But if we had not analyzed the phosphorus effect separately by sulfur level, we would have erroneously concluded it did not affect yield.</p>
</div>
</div>
<div id="case-study-2-1" class="section level3">
<h3><span class="header-section-number">7.2.2</span> Case Study 2</h3>
<p>For the second case study, we are going to look at an experiment where turnips were planted at different densities in different row spacings. There were 5 densities and 4 row widths. This trial also blocked treatments, so it combines the randomized complete block and factorial designs.</p>
<div id="linear-additive-model-2" class="section level4">
<h4><span class="header-section-number">7.2.2.1</span> Linear Additive Model</h4>
<p>The linear additive model for this trial is:
<span class="math display">\[Y_{ijk} =  B_i + D_j + S_k + DS_{jk} + BDS_{ijk}\]</span>
In this model, <span class="math inline">\(Y_{ijk}\)</span> is yield, <span class="math inline">\(B_i\)</span> is block, <span class="math inline">\(D_j\)</span> is density, <span class="math inline">\(S_k\)</span> is row spacing, <span class="math inline">\(DS_{jk}\)</span> is the interaction of planting density and row spacing, and <span class="math inline">\(BDS_{ijk}\)</span> is the interaction of block, density, and row width, which is used as the residual or error term in this model. We can see the additive effects of the factor levels and their interactions in the table below.</p>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="multiple-treatment-designs.html#cb453-1"></a><span class="kw">library</span>(agridat)</span>
<span id="cb453-2"><a href="multiple-treatment-designs.html#cb453-2"></a>turnip =<span class="st"> </span>mead.turnip</span>
<span id="cb453-3"><a href="multiple-treatment-designs.html#cb453-3"></a></span>
<span id="cb453-4"><a href="multiple-treatment-designs.html#cb453-4"></a>turnip_data =<span class="st"> </span>turnip <span class="op">%&gt;%</span></span>
<span id="cb453-5"><a href="multiple-treatment-designs.html#cb453-5"></a><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span>spacing <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">32</span>)) <span class="op">%&gt;%</span></span>
<span id="cb453-6"><a href="multiple-treatment-designs.html#cb453-6"></a><span class="st">  </span><span class="kw">filter</span>(density <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">8</span>,<span class="dv">20</span>,<span class="dv">32</span>)) <span class="op">%&gt;%</span></span>
<span id="cb453-7"><a href="multiple-treatment-designs.html#cb453-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">spacing =</span> <span class="kw">as.factor</span>(spacing),</span>
<span id="cb453-8"><a href="multiple-treatment-designs.html#cb453-8"></a>         <span class="dt">density =</span> <span class="kw">as.factor</span>(density))</span>
<span id="cb453-9"><a href="multiple-treatment-designs.html#cb453-9"></a></span>
<span id="cb453-10"><a href="multiple-treatment-designs.html#cb453-10"></a>turnip_effects =<span class="st"> </span>turnip_data <span class="op">%&gt;%</span></span>
<span id="cb453-11"><a href="multiple-treatment-designs.html#cb453-11"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mu =</span> <span class="kw">mean</span>(yield)) <span class="op">%&gt;%</span></span>
<span id="cb453-12"><a href="multiple-treatment-designs.html#cb453-12"></a><span class="st">  </span><span class="kw">group_by</span>(block) <span class="op">%&gt;%</span></span>
<span id="cb453-13"><a href="multiple-treatment-designs.html#cb453-13"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">B =</span> <span class="kw">mean</span>(yield) <span class="op">-</span><span class="st"> </span>mu) <span class="op">%&gt;%</span></span>
<span id="cb453-14"><a href="multiple-treatment-designs.html#cb453-14"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb453-15"><a href="multiple-treatment-designs.html#cb453-15"></a><span class="st">  </span><span class="kw">group_by</span>(spacing) <span class="op">%&gt;%</span></span>
<span id="cb453-16"><a href="multiple-treatment-designs.html#cb453-16"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">S =</span> <span class="kw">mean</span>(yield) <span class="op">-</span><span class="st"> </span>mu) <span class="op">%&gt;%</span></span>
<span id="cb453-17"><a href="multiple-treatment-designs.html#cb453-17"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb453-18"><a href="multiple-treatment-designs.html#cb453-18"></a><span class="st">  </span><span class="kw">group_by</span>(density) <span class="op">%&gt;%</span></span>
<span id="cb453-19"><a href="multiple-treatment-designs.html#cb453-19"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">D =</span> <span class="kw">mean</span>(yield) <span class="op">-</span><span class="st"> </span>mu) <span class="op">%&gt;%</span></span>
<span id="cb453-20"><a href="multiple-treatment-designs.html#cb453-20"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb453-21"><a href="multiple-treatment-designs.html#cb453-21"></a><span class="st">  </span><span class="kw">group_by</span>(spacing, density) <span class="op">%&gt;%</span></span>
<span id="cb453-22"><a href="multiple-treatment-designs.html#cb453-22"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">SD =</span> <span class="kw">mean</span>(yield) <span class="op">-</span><span class="st"> </span>(mu <span class="op">+</span><span class="st"> </span>B <span class="op">+</span><span class="st"> </span>S <span class="op">+</span><span class="st"> </span>D)) <span class="op">%&gt;%</span></span>
<span id="cb453-23"><a href="multiple-treatment-designs.html#cb453-23"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb453-24"><a href="multiple-treatment-designs.html#cb453-24"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">Error =</span> yield <span class="op">-</span><span class="st"> </span>(mu <span class="op">+</span><span class="st"> </span>B <span class="op">+</span><span class="st"> </span>S <span class="op">+</span><span class="st"> </span>D <span class="op">+</span><span class="st"> </span>SD)) <span class="op">%&gt;%</span></span>
<span id="cb453-25"><a href="multiple-treatment-designs.html#cb453-25"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">mu =</span> <span class="kw">round</span>(mu,<span class="dv">2</span>),</span>
<span id="cb453-26"><a href="multiple-treatment-designs.html#cb453-26"></a>         <span class="dt">B =</span> <span class="kw">round</span>(B,<span class="dv">2</span>),</span>
<span id="cb453-27"><a href="multiple-treatment-designs.html#cb453-27"></a>         <span class="dt">S =</span> <span class="kw">round</span>(S,<span class="dv">2</span>),</span>
<span id="cb453-28"><a href="multiple-treatment-designs.html#cb453-28"></a>         <span class="dt">D =</span> <span class="kw">round</span>(D,<span class="dv">2</span>),</span>
<span id="cb453-29"><a href="multiple-treatment-designs.html#cb453-29"></a>         <span class="dt">SD =</span> <span class="kw">round</span>(SD,<span class="dv">2</span>),</span>
<span id="cb453-30"><a href="multiple-treatment-designs.html#cb453-30"></a>         <span class="dt">Error =</span> <span class="kw">round</span>(Error, <span class="dv">2</span>)) </span>
<span id="cb453-31"><a href="multiple-treatment-designs.html#cb453-31"></a>  </span>
<span id="cb453-32"><a href="multiple-treatment-designs.html#cb453-32"></a>turnip_final =<span class="st"> </span>turnip_effects <span class="op">%&gt;%</span></span>
<span id="cb453-33"><a href="multiple-treatment-designs.html#cb453-33"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">yield =</span> <span class="kw">if_else</span>(spacing<span class="op">==</span><span class="dv">16</span> <span class="op">&amp;</span><span class="st"> </span>density<span class="op">==</span><span class="dv">32</span>, yield<span class="fl">-0.4</span>, yield)) <span class="op">%&gt;%</span></span>
<span id="cb453-34"><a href="multiple-treatment-designs.html#cb453-34"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">yield =</span> <span class="kw">if_else</span>(spacing<span class="op">==</span><span class="dv">8</span> <span class="op">&amp;</span><span class="st"> </span>density<span class="op">==</span><span class="dv">32</span>, yield<span class="fl">+0.5</span>, yield)) <span class="op">%&gt;%</span></span>
<span id="cb453-35"><a href="multiple-treatment-designs.html#cb453-35"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">yield =</span> <span class="kw">if_else</span>(spacing<span class="op">==</span><span class="dv">4</span> <span class="op">&amp;</span><span class="st"> </span>density<span class="op">==</span><span class="dv">32</span>, yield<span class="fl">+0.3</span>, yield))<span class="op">%&gt;%</span></span>
<span id="cb453-36"><a href="multiple-treatment-designs.html#cb453-36"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">yield =</span> <span class="kw">if_else</span>(spacing<span class="op">==</span><span class="dv">16</span> <span class="op">&amp;</span><span class="st"> </span>density<span class="op">==</span><span class="dv">8</span>, yield<span class="fl">+3.2</span>, yield))</span>
<span id="cb453-37"><a href="multiple-treatment-designs.html#cb453-37"></a></span>
<span id="cb453-38"><a href="multiple-treatment-designs.html#cb453-38"></a><span class="co">#turnip_data</span></span>
<span id="cb453-39"><a href="multiple-treatment-designs.html#cb453-39"></a></span>
<span id="cb453-40"><a href="multiple-treatment-designs.html#cb453-40"></a>knitr<span class="op">::</span><span class="kw">kable</span>(turnip_final)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">yield</th>
<th align="left">block</th>
<th align="left">spacing</th>
<th align="left">density</th>
<th align="right">mu</th>
<th align="right">B</th>
<th align="right">S</th>
<th align="right">D</th>
<th align="right">SD</th>
<th align="right">Error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2.40</td>
<td align="left">B1</td>
<td align="left">4</td>
<td align="left">8</td>
<td align="right">2.67</td>
<td align="right">-0.26</td>
<td align="right">0.02</td>
<td align="right">-0.17</td>
<td align="right">0.29</td>
<td align="right">-0.16</td>
</tr>
<tr class="even">
<td align="right">2.56</td>
<td align="left">B1</td>
<td align="left">4</td>
<td align="left">20</td>
<td align="right">2.67</td>
<td align="right">-0.26</td>
<td align="right">0.02</td>
<td align="right">0.11</td>
<td align="right">0.18</td>
<td align="right">-0.16</td>
</tr>
<tr class="odd">
<td align="right">2.78</td>
<td align="left">B1</td>
<td align="left">4</td>
<td align="left">32</td>
<td align="right">2.67</td>
<td align="right">-0.26</td>
<td align="right">0.02</td>
<td align="right">0.06</td>
<td align="right">0.30</td>
<td align="right">-0.31</td>
</tr>
<tr class="even">
<td align="right">2.33</td>
<td align="left">B1</td>
<td align="left">8</td>
<td align="left">8</td>
<td align="right">2.67</td>
<td align="right">-0.26</td>
<td align="right">0.08</td>
<td align="right">-0.17</td>
<td align="right">0.32</td>
<td align="right">-0.32</td>
</tr>
<tr class="odd">
<td align="right">2.56</td>
<td align="left">B1</td>
<td align="left">8</td>
<td align="left">20</td>
<td align="right">2.67</td>
<td align="right">-0.26</td>
<td align="right">0.08</td>
<td align="right">0.11</td>
<td align="right">0.21</td>
<td align="right">-0.26</td>
</tr>
<tr class="even">
<td align="right">3.03</td>
<td align="left">B1</td>
<td align="left">8</td>
<td align="left">32</td>
<td align="right">2.67</td>
<td align="right">-0.26</td>
<td align="right">0.08</td>
<td align="right">0.06</td>
<td align="right">0.25</td>
<td align="right">-0.27</td>
</tr>
<tr class="odd">
<td align="right">5.21</td>
<td align="left">B1</td>
<td align="left">16</td>
<td align="left">8</td>
<td align="right">2.67</td>
<td align="right">-0.26</td>
<td align="right">-0.10</td>
<td align="right">-0.17</td>
<td align="right">0.17</td>
<td align="right">-0.30</td>
</tr>
<tr class="even">
<td align="right">2.56</td>
<td align="left">B1</td>
<td align="left">16</td>
<td align="left">20</td>
<td align="right">2.67</td>
<td align="right">-0.26</td>
<td align="right">-0.10</td>
<td align="right">0.11</td>
<td align="right">0.38</td>
<td align="right">-0.25</td>
</tr>
<tr class="odd">
<td align="right">1.90</td>
<td align="left">B1</td>
<td align="left">16</td>
<td align="left">32</td>
<td align="right">2.67</td>
<td align="right">-0.26</td>
<td align="right">-0.10</td>
<td align="right">0.06</td>
<td align="right">0.23</td>
<td align="right">-0.30</td>
</tr>
<tr class="even">
<td align="right">2.60</td>
<td align="left">B2</td>
<td align="left">4</td>
<td align="left">8</td>
<td align="right">2.67</td>
<td align="right">0.07</td>
<td align="right">0.02</td>
<td align="right">-0.17</td>
<td align="right">-0.03</td>
<td align="right">0.04</td>
</tr>
<tr class="odd">
<td align="right">2.89</td>
<td align="left">B2</td>
<td align="left">4</td>
<td align="left">20</td>
<td align="right">2.67</td>
<td align="right">0.07</td>
<td align="right">0.02</td>
<td align="right">0.11</td>
<td align="right">-0.15</td>
<td align="right">0.17</td>
</tr>
<tr class="even">
<td align="right">3.06</td>
<td align="left">B2</td>
<td align="left">4</td>
<td align="left">32</td>
<td align="right">2.67</td>
<td align="right">0.07</td>
<td align="right">0.02</td>
<td align="right">0.06</td>
<td align="right">-0.02</td>
<td align="right">-0.03</td>
</tr>
<tr class="odd">
<td align="right">2.63</td>
<td align="left">B2</td>
<td align="left">8</td>
<td align="left">8</td>
<td align="right">2.67</td>
<td align="right">0.07</td>
<td align="right">0.08</td>
<td align="right">-0.17</td>
<td align="right">-0.01</td>
<td align="right">-0.02</td>
</tr>
<tr class="even">
<td align="right">2.69</td>
<td align="left">B2</td>
<td align="left">8</td>
<td align="left">20</td>
<td align="right">2.67</td>
<td align="right">0.07</td>
<td align="right">0.08</td>
<td align="right">0.11</td>
<td align="right">-0.11</td>
<td align="right">-0.13</td>
</tr>
<tr class="odd">
<td align="right">3.48</td>
<td align="left">B2</td>
<td align="left">8</td>
<td align="left">32</td>
<td align="right">2.67</td>
<td align="right">0.07</td>
<td align="right">0.08</td>
<td align="right">0.06</td>
<td align="right">-0.08</td>
<td align="right">0.18</td>
</tr>
<tr class="even">
<td align="right">5.57</td>
<td align="left">B2</td>
<td align="left">16</td>
<td align="left">8</td>
<td align="right">2.67</td>
<td align="right">0.07</td>
<td align="right">-0.10</td>
<td align="right">-0.17</td>
<td align="right">-0.16</td>
<td align="right">0.06</td>
</tr>
<tr class="odd">
<td align="right">3.04</td>
<td align="left">B2</td>
<td align="left">16</td>
<td align="left">20</td>
<td align="right">2.67</td>
<td align="right">0.07</td>
<td align="right">-0.10</td>
<td align="right">0.11</td>
<td align="right">0.06</td>
<td align="right">0.23</td>
</tr>
<tr class="even">
<td align="right">2.31</td>
<td align="left">B2</td>
<td align="left">16</td>
<td align="left">32</td>
<td align="right">2.67</td>
<td align="right">0.07</td>
<td align="right">-0.10</td>
<td align="right">0.06</td>
<td align="right">-0.10</td>
<td align="right">0.11</td>
</tr>
<tr class="odd">
<td align="right">2.67</td>
<td align="left">B3</td>
<td align="left">4</td>
<td align="left">8</td>
<td align="right">2.67</td>
<td align="right">0.19</td>
<td align="right">0.02</td>
<td align="right">-0.17</td>
<td align="right">-0.16</td>
<td align="right">0.11</td>
</tr>
<tr class="even">
<td align="right">2.71</td>
<td align="left">B3</td>
<td align="left">4</td>
<td align="left">20</td>
<td align="right">2.67</td>
<td align="right">0.19</td>
<td align="right">0.02</td>
<td align="right">0.11</td>
<td align="right">-0.27</td>
<td align="right">-0.01</td>
</tr>
<tr class="odd">
<td align="right">3.44</td>
<td align="left">B3</td>
<td align="left">4</td>
<td align="left">32</td>
<td align="right">2.67</td>
<td align="right">0.19</td>
<td align="right">0.02</td>
<td align="right">0.06</td>
<td align="right">-0.15</td>
<td align="right">0.35</td>
</tr>
<tr class="even">
<td align="right">2.98</td>
<td align="left">B3</td>
<td align="left">8</td>
<td align="left">8</td>
<td align="right">2.67</td>
<td align="right">0.19</td>
<td align="right">0.08</td>
<td align="right">-0.17</td>
<td align="right">-0.13</td>
<td align="right">0.33</td>
</tr>
<tr class="odd">
<td align="right">3.21</td>
<td align="left">B3</td>
<td align="left">8</td>
<td align="left">20</td>
<td align="right">2.67</td>
<td align="right">0.19</td>
<td align="right">0.08</td>
<td align="right">0.11</td>
<td align="right">-0.24</td>
<td align="right">0.39</td>
</tr>
<tr class="even">
<td align="right">3.39</td>
<td align="left">B3</td>
<td align="left">8</td>
<td align="left">32</td>
<td align="right">2.67</td>
<td align="right">0.19</td>
<td align="right">0.08</td>
<td align="right">0.06</td>
<td align="right">-0.21</td>
<td align="right">0.09</td>
</tr>
<tr class="odd">
<td align="right">5.76</td>
<td align="left">B3</td>
<td align="left">16</td>
<td align="left">8</td>
<td align="right">2.67</td>
<td align="right">0.19</td>
<td align="right">-0.10</td>
<td align="right">-0.17</td>
<td align="right">-0.29</td>
<td align="right">0.25</td>
</tr>
<tr class="even">
<td align="right">2.83</td>
<td align="left">B3</td>
<td align="left">16</td>
<td align="left">20</td>
<td align="right">2.67</td>
<td align="right">0.19</td>
<td align="right">-0.10</td>
<td align="right">0.11</td>
<td align="right">-0.07</td>
<td align="right">0.02</td>
</tr>
<tr class="odd">
<td align="right">2.40</td>
<td align="left">B3</td>
<td align="left">16</td>
<td align="left">32</td>
<td align="right">2.67</td>
<td align="right">0.19</td>
<td align="right">-0.10</td>
<td align="right">0.06</td>
<td align="right">-0.22</td>
<td align="right">0.20</td>
</tr>
</tbody>
</table>
<p>As we did before, we visually inspect the data for insights into how they may interact.</p>
<div class="sourceCode" id="cb454"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb454-1"><a href="multiple-treatment-designs.html#cb454-1"></a>turnip_final <span class="op">%&gt;%</span></span>
<span id="cb454-2"><a href="multiple-treatment-designs.html#cb454-2"></a><span class="st">  </span><span class="kw">group_by</span>(density, spacing) <span class="op">%&gt;%</span></span>
<span id="cb454-3"><a href="multiple-treatment-designs.html#cb454-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">yield =</span> <span class="kw">mean</span>(yield)) <span class="op">%&gt;%</span></span>
<span id="cb454-4"><a href="multiple-treatment-designs.html#cb454-4"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb454-5"><a href="multiple-treatment-designs.html#cb454-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>spacing, <span class="dt">y=</span>yield, <span class="dt">group=</span>density)) <span class="op">+</span></span>
<span id="cb454-6"><a href="multiple-treatment-designs.html#cb454-6"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color=</span>density), <span class="dt">size=</span><span class="dv">2</span>) </span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;density&#39;. You can override using the `.groups` argument.</code></pre>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-16-1.png" width="672" /></p>
<p>The plot gives critical insight into these data. Increasing spacing from 4 to 8 to 16 seems to cause a slight increase in yield where density=20. But where density=8, yield seems to increase rapidly between row spacing 8 and row spacing 16. Where density = 32, yield increases slighty with row spacing from 4 to 8, and then decreases markedly from 8 to 16.</p>
<p>The mean yield, averaged across row spacings, changes little across planting densities – even though the yields change dramatically within each of the individual row spacings. If we did not visually examine the data above, and instead relied on the ANOVA to alert us to an affect, we could miss this very important insight.</p>
</div>
<div id="analysis-of-variance-3" class="section level4">
<h4><span class="header-section-number">7.2.2.2</span> Analysis of Variance</h4>
<p>Our analysis of variance is similar to that we ran for the first case study, except for it now includes the block term.</p>
<div class="sourceCode" id="cb456"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb456-1"><a href="multiple-treatment-designs.html#cb456-1"></a>model =<span class="st"> </span><span class="kw">aov</span>(yield <span class="op">~</span><span class="st"> </span>block <span class="op">+</span><span class="st"> </span>density <span class="op">+</span><span class="st"> </span>spacing <span class="op">+</span><span class="st"> </span>density<span class="op">:</span>spacing, <span class="dt">data =</span> turnip_final)</span>
<span id="cb456-2"><a href="multiple-treatment-designs.html#cb456-2"></a>anova_tab =<span class="st"> </span><span class="kw">anova</span>(model)</span>
<span id="cb456-3"><a href="multiple-treatment-designs.html#cb456-3"></a></span>
<span id="cb456-4"><a href="multiple-treatment-designs.html#cb456-4"></a>knitr<span class="op">::</span><span class="kw">kable</span>(anova_tab)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">Df</th>
<th align="right">Sum Sq</th>
<th align="right">Mean Sq</th>
<th align="right">F value</th>
<th align="right">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">block</td>
<td align="right">2</td>
<td align="right">0.9770963</td>
<td align="right">0.4885481</td>
<td align="right">25.06684</td>
<td align="right">1.17e-05</td>
</tr>
<tr class="even">
<td align="left">density</td>
<td align="right">2</td>
<td align="right">3.3854519</td>
<td align="right">1.6927259</td>
<td align="right">86.85182</td>
<td align="right">0.00e+00</td>
</tr>
<tr class="odd">
<td align="left">spacing</td>
<td align="right">2</td>
<td align="right">2.6353852</td>
<td align="right">1.3176926</td>
<td align="right">67.60929</td>
<td align="right">0.00e+00</td>
</tr>
<tr class="even">
<td align="left">density:spacing</td>
<td align="right">4</td>
<td align="right">16.3880593</td>
<td align="right">4.0970148</td>
<td align="right">210.21312</td>
<td align="right">0.00e+00</td>
</tr>
<tr class="odd">
<td align="left">Residuals</td>
<td align="right">16</td>
<td align="right">0.3118370</td>
<td align="right">0.0194898</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p>The planting density and plant spacing main effects were significant, as was their interacton.</p>
<p>Was the spacing effect significant at each level of density? We can slice the data to find this out.</p>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="multiple-treatment-designs.html#cb457-1"></a><span class="kw">library</span>(broom)</span>
<span id="cb457-2"><a href="multiple-treatment-designs.html#cb457-2"></a>slice_<span class="dv">1</span> =<span class="st"> </span>turnip_final <span class="op">%&gt;%</span></span>
<span id="cb457-3"><a href="multiple-treatment-designs.html#cb457-3"></a><span class="st">  </span><span class="kw">group_by</span>(density) <span class="op">%&gt;%</span></span>
<span id="cb457-4"><a href="multiple-treatment-designs.html#cb457-4"></a><span class="st">  </span><span class="kw">do</span>(<span class="kw">tidy</span>(<span class="kw">aov</span>(.<span class="op">$</span>yield <span class="op">~</span><span class="st"> </span>.<span class="op">$</span>spacing))) <span class="op">%&gt;%</span></span>
<span id="cb457-5"><a href="multiple-treatment-designs.html#cb457-5"></a><span class="st">  </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb457-6"><a href="multiple-treatment-designs.html#cb457-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">term =</span> <span class="kw">gsub</span>(<span class="st">&quot;[.][$]&quot;</span>, <span class="st">&quot;&quot;</span>, term))</span>
<span id="cb457-7"><a href="multiple-treatment-designs.html#cb457-7"></a></span>
<span id="cb457-8"><a href="multiple-treatment-designs.html#cb457-8"></a>knitr<span class="op">::</span><span class="kw">kable</span>(slice_<span class="dv">1</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">density</th>
<th align="left">term</th>
<th align="right">df</th>
<th align="right">sumsq</th>
<th align="right">meansq</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">8</td>
<td align="left">spacing</td>
<td align="right">2</td>
<td align="right">16.9677556</td>
<td align="right">8.4838778</td>
<td align="right">125.0694513</td>
<td align="right">0.0000129</td>
</tr>
<tr class="even">
<td align="left">8</td>
<td align="left">Residuals</td>
<td align="right">6</td>
<td align="right">0.4070000</td>
<td align="right">0.0678333</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">20</td>
<td align="left">spacing</td>
<td align="right">2</td>
<td align="right">0.0182000</td>
<td align="right">0.0091000</td>
<td align="right">0.1341523</td>
<td align="right">0.8770078</td>
</tr>
<tr class="even">
<td align="left">20</td>
<td align="left">Residuals</td>
<td align="right">6</td>
<td align="right">0.4070000</td>
<td align="right">0.0678333</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">32</td>
<td align="left">spacing</td>
<td align="right">2</td>
<td align="right">2.0374889</td>
<td align="right">1.0187444</td>
<td align="right">12.8701572</td>
<td align="right">0.0067549</td>
</tr>
<tr class="even">
<td align="left">32</td>
<td align="left">Residuals</td>
<td align="right">6</td>
<td align="right">0.4749333</td>
<td align="right">0.0791556</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p>We can see above that the effect of spacing on yield is only significant at <span class="math inline">\(P\le0.05\)</span> density=8 and density=32. If we examining the effect of density separately for each level of spacing:</p>
<div class="sourceCode" id="cb458"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb458-1"><a href="multiple-treatment-designs.html#cb458-1"></a><span class="kw">library</span>(broom)</span>
<span id="cb458-2"><a href="multiple-treatment-designs.html#cb458-2"></a>slice_<span class="dv">2</span> =<span class="st"> </span>turnip_final <span class="op">%&gt;%</span></span>
<span id="cb458-3"><a href="multiple-treatment-designs.html#cb458-3"></a><span class="st">  </span><span class="kw">group_by</span>(spacing) <span class="op">%&gt;%</span></span>
<span id="cb458-4"><a href="multiple-treatment-designs.html#cb458-4"></a><span class="st">  </span><span class="kw">do</span>(<span class="kw">tidy</span>(<span class="kw">aov</span>(.<span class="op">$</span>yield <span class="op">~</span><span class="st"> </span>.<span class="op">$</span>density))) <span class="op">%&gt;%</span></span>
<span id="cb458-5"><a href="multiple-treatment-designs.html#cb458-5"></a><span class="st">  </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb458-6"><a href="multiple-treatment-designs.html#cb458-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">term =</span> <span class="kw">gsub</span>(<span class="st">&quot;[.][$]&quot;</span>, <span class="st">&quot;&quot;</span>, term))</span>
<span id="cb458-7"><a href="multiple-treatment-designs.html#cb458-7"></a></span>
<span id="cb458-8"><a href="multiple-treatment-designs.html#cb458-8"></a>knitr<span class="op">::</span><span class="kw">kable</span>(slice_<span class="dv">2</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">spacing</th>
<th align="left">term</th>
<th align="right">df</th>
<th align="right">sumsq</th>
<th align="right">meansq</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">4</td>
<td align="left">density</td>
<td align="right">2</td>
<td align="right">0.4540667</td>
<td align="right">0.2270333</td>
<td align="right">4.347447</td>
<td align="right">0.0680698</td>
</tr>
<tr class="even">
<td align="left">4</td>
<td align="left">Residuals</td>
<td align="right">6</td>
<td align="right">0.3133333</td>
<td align="right">0.0522222</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">8</td>
<td align="left">density</td>
<td align="right">2</td>
<td align="right">0.6872889</td>
<td align="right">0.3436444</td>
<td align="right">3.670979</td>
<td align="right">0.0909484</td>
</tr>
<tr class="even">
<td align="left">8</td>
<td align="left">Residuals</td>
<td align="right">6</td>
<td align="right">0.5616667</td>
<td align="right">0.0936111</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">16</td>
<td align="left">density</td>
<td align="right">2</td>
<td align="right">18.6321556</td>
<td align="right">9.3160778</td>
<td align="right">135.037365</td>
<td align="right">0.0000103</td>
</tr>
<tr class="even">
<td align="left">16</td>
<td align="left">Residuals</td>
<td align="right">6</td>
<td align="right">0.4139333</td>
<td align="right">0.0689889</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p>We similarly see that density is only significant at <span class="math inline">\(P\le0.05\)</span> where spacing=16.</p>
<p>In this trial, both main (density and spacing) effects are significant. But if don’t explore and explain our analysis further, we might miss how the both the magnitude of and the rank rank of row spacing effects on yield changes with plant density.</p>
</div>
</div>
<div id="discussing-interactions" class="section level3">
<h3><span class="header-section-number">7.2.3</span> Discussing Interactions</h3>
<p>In factorial experiments, there are three kinds of interaction that may occur. We can have no interaction, a spreading interaction, or a crossover interaction.</p>
<div id="no-interaction" class="section level4">
<h4><span class="header-section-number">7.2.3.1</span> No Interaction</h4>
<p>Where there is no interaction, the treatments effects are simply additive – the observed value of each observation in the plot above is the sum of the effect of the level of Factor A plus the effect of the level of Factor B. The difference between levels of Factor A are consistent across levels of Factor B, and vice versa. If we plot the data using a line plot, it will look like this:</p>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="multiple-treatment-designs.html#cb459-1"></a>factA =<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dv">2</span>)</span>
<span id="cb459-2"><a href="multiple-treatment-designs.html#cb459-2"></a>Y =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">6</span>)</span>
<span id="cb459-3"><a href="multiple-treatment-designs.html#cb459-3"></a>factB =<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;T1&quot;</span>, <span class="st">&quot;T2&quot;</span>), <span class="dt">each=</span><span class="dv">3</span>)</span>
<span id="cb459-4"><a href="multiple-treatment-designs.html#cb459-4"></a></span>
<span id="cb459-5"><a href="multiple-treatment-designs.html#cb459-5"></a>dataset =<span class="st"> </span><span class="kw">cbind</span>(factA, Y, factB) <span class="op">%&gt;%</span></span>
<span id="cb459-6"><a href="multiple-treatment-designs.html#cb459-6"></a><span class="st">  </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb459-7"><a href="multiple-treatment-designs.html#cb459-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">factA=</span><span class="kw">as.numeric</span>(factA),</span>
<span id="cb459-8"><a href="multiple-treatment-designs.html#cb459-8"></a>         <span class="dt">Y=</span><span class="kw">as.numeric</span>(Y)) </span>
<span id="cb459-9"><a href="multiple-treatment-designs.html#cb459-9"></a></span>
<span id="cb459-10"><a href="multiple-treatment-designs.html#cb459-10"></a>dataset <span class="op">%&gt;%</span></span>
<span id="cb459-11"><a href="multiple-treatment-designs.html#cb459-11"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>factA, <span class="dt">y=</span>Y, <span class="dt">group=</span>factB)) <span class="op">+</span></span>
<span id="cb459-12"><a href="multiple-treatment-designs.html#cb459-12"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color=</span>factB), <span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb459-13"><a href="multiple-treatment-designs.html#cb459-13"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Factor A&quot;</span>, <span class="dt">legend=</span><span class="st">&quot;Factor B&quot;</span>, <span class="dt">color=</span><span class="st">&quot;Factor B&quot;</span>)</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-20-1.png" width="672" /></p>
<p>In a bar plot, it should look like this:</p>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="multiple-treatment-designs.html#cb460-1"></a>dataset <span class="op">%&gt;%</span></span>
<span id="cb460-2"><a href="multiple-treatment-designs.html#cb460-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>factA, <span class="dt">y=</span>Y, <span class="dt">group=</span>factB)) <span class="op">+</span></span>
<span id="cb460-3"><a href="multiple-treatment-designs.html#cb460-3"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="kw">aes</span>(<span class="dt">fill=</span>factB), <span class="dt">position =</span> <span class="st">&quot;dodge&quot;</span>) <span class="op">+</span></span>
<span id="cb460-4"><a href="multiple-treatment-designs.html#cb460-4"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Factor A&quot;</span>, <span class="dt">legend=</span><span class="st">&quot;Factor B&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;Factor B&quot;</span>)</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-21-1.png" width="672" /></p>
<p>Finally, there will be no change in the ranking of levels within factors. Rank is the order of levels according to their obseved effects, from least to greatest. For factor A, the ranking of levels within Factor A is <span class="math inline">\(1 &gt; 2 &gt; 3\)</span>, while within Factor B, level T2 always ranks higher than level T1.</p>
</div>
<div id="spreading-interaction" class="section level4">
<h4><span class="header-section-number">7.2.3.2</span> Spreading Interaction</h4>
<p>In a spreading interaction, the ranking of levels within factors does not change, but the difference between them does.</p>
<div class="sourceCode" id="cb461"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb461-1"><a href="multiple-treatment-designs.html#cb461-1"></a>factA =<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dv">2</span>)</span>
<span id="cb461-2"><a href="multiple-treatment-designs.html#cb461-2"></a>Y =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>)</span>
<span id="cb461-3"><a href="multiple-treatment-designs.html#cb461-3"></a>factB =<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;T1&quot;</span>, <span class="st">&quot;T2&quot;</span>), <span class="dt">each=</span><span class="dv">3</span>)</span>
<span id="cb461-4"><a href="multiple-treatment-designs.html#cb461-4"></a></span>
<span id="cb461-5"><a href="multiple-treatment-designs.html#cb461-5"></a>dataset =<span class="st"> </span><span class="kw">cbind</span>(factA, Y, factB) <span class="op">%&gt;%</span></span>
<span id="cb461-6"><a href="multiple-treatment-designs.html#cb461-6"></a><span class="st">  </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb461-7"><a href="multiple-treatment-designs.html#cb461-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">factA=</span><span class="kw">as.numeric</span>(factA),</span>
<span id="cb461-8"><a href="multiple-treatment-designs.html#cb461-8"></a>         <span class="dt">Y=</span><span class="kw">as.numeric</span>(Y)) </span>
<span id="cb461-9"><a href="multiple-treatment-designs.html#cb461-9"></a></span>
<span id="cb461-10"><a href="multiple-treatment-designs.html#cb461-10"></a>dataset <span class="op">%&gt;%</span></span>
<span id="cb461-11"><a href="multiple-treatment-designs.html#cb461-11"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>factA, <span class="dt">y=</span>Y, <span class="dt">group=</span>factB)) <span class="op">+</span></span>
<span id="cb461-12"><a href="multiple-treatment-designs.html#cb461-12"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color=</span>factB), <span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb461-13"><a href="multiple-treatment-designs.html#cb461-13"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Factor A&quot;</span>, <span class="dt">legend=</span><span class="st">&quot;Factor B&quot;</span>, <span class="dt">color=</span><span class="st">&quot;Factor B&quot;</span>)</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-22-1.png" width="672" /></p>
<p>In the above plot, we can see the levels of Factor A still rank <span class="math inline">\(1&lt;2&lt;3\)</span> in their effect on the observed value Y, for both level T1 and level T2 of Factor B. We also note that the levels of Factor B rank <span class="math inline">\(T1&lt;T2\)</span> at each level of Factor A. In this spreading interaction, however, the difference between T1 and T2 of factor B increases as the levels of Factor A increase. Similarly, the differences among levels of Factor A are greater for level T2 than level T1 of Factor B.</p>
<p>We saw a spreading interaction before in Case Study 1. The effect of sulfur increased with the level of phosphorus, and vice versa.</p>
</div>
<div id="crossover-interaction" class="section level4">
<h4><span class="header-section-number">7.2.3.3</span> Crossover Interaction</h4>
<p>A crossover interaction is similar to a spreading interacton in that the differences between levels within one factor change with the levels of a second factor, but different in that the ranking of levels changes as well. In addition, as we saw above, crossover reactions can mask the effects of factor levels.</p>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="multiple-treatment-designs.html#cb462-1"></a>factA =<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dv">2</span>)</span>
<span id="cb462-2"><a href="multiple-treatment-designs.html#cb462-2"></a>Y =<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb462-3"><a href="multiple-treatment-designs.html#cb462-3"></a>factB =<span class="st"> </span><span class="kw">rep</span>(<span class="kw">c</span>(<span class="st">&quot;T1&quot;</span>, <span class="st">&quot;T2&quot;</span>), <span class="dt">each=</span><span class="dv">3</span>)</span>
<span id="cb462-4"><a href="multiple-treatment-designs.html#cb462-4"></a></span>
<span id="cb462-5"><a href="multiple-treatment-designs.html#cb462-5"></a>dataset =<span class="st"> </span><span class="kw">cbind</span>(factA, Y, factB) <span class="op">%&gt;%</span></span>
<span id="cb462-6"><a href="multiple-treatment-designs.html#cb462-6"></a><span class="st">  </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb462-7"><a href="multiple-treatment-designs.html#cb462-7"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">factA=</span><span class="kw">as.numeric</span>(factA),</span>
<span id="cb462-8"><a href="multiple-treatment-designs.html#cb462-8"></a>         <span class="dt">Y=</span><span class="kw">as.numeric</span>(Y)) </span>
<span id="cb462-9"><a href="multiple-treatment-designs.html#cb462-9"></a></span>
<span id="cb462-10"><a href="multiple-treatment-designs.html#cb462-10"></a>dataset <span class="op">%&gt;%</span></span>
<span id="cb462-11"><a href="multiple-treatment-designs.html#cb462-11"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>factA, <span class="dt">y=</span>Y, <span class="dt">group=</span>factB)) <span class="op">+</span></span>
<span id="cb462-12"><a href="multiple-treatment-designs.html#cb462-12"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color=</span>factB), <span class="dt">size=</span><span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb462-13"><a href="multiple-treatment-designs.html#cb462-13"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;Factor A&quot;</span>, <span class="dt">legend=</span><span class="st">&quot;Factor B&quot;</span>, <span class="dt">color=</span><span class="st">&quot;Factor B&quot;</span>)</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-23-1.png" width="672" /></p>
<p>In the plot above, the ranking of levels within Factor B is <span class="math inline">\(T2&gt;T1\)</span> for levels 1 and 2 of Factor A, but <span class="math inline">\(T1&gt;T2\)</span> for level 3 of Factor A. In other words, whether T2 is greater than T1 depends on the level of Factor A. In addition, the levels of Factor B behave differently in response to the levels of Factor A. Level T1 of Factor B increases with the level of Factor B, while level T2 decreases.</p>
<p>We observed a crossover reaction in Case Study 2 above, where the effect of the widest row spacing on yield was greater than the narrow row spacings at the lowest planting density, but was less than the narrow spacings at the greatest planting density.</p>
</div>
<div id="discussing-interactions-1" class="section level4">
<h4><span class="header-section-number">7.2.3.4</span> Discussing Interactions</h4>
<p>Interactions are exciting. Spreading interactions show us how the proper combination of of management practices or inputs can have a combined effect that is greater than the individual effect of inputs. Conversely, crossover interactions show us how the advantage of one practice can be lost with the mismanagement of a second practice. This is the essence of agronomy.</p>
<p>When we identify spreading interactions, we learn how to build more productive <em>cropping systems</em>, as opposed to one-off solutions. Don’t get me wrong – there are some wonderful one-off solutions. But almost every input or practice can be made more effective by understanding how it interacts with other practices. In addition, trials can be designed to test how the effect of that input interacts with different environmental conditions, such as temperature and precipitation.</p>
<p>Interactions should always be highlighted when discussing the findings of an Analysis of Variance. The essense of an interaction is that the effect of one factor is <em>dependent</em> on the level of a second factor. If you don’t discuss the interaction between factors, you don’t completely describe the effect of either factor.</p>
<p>As we saw above, crossover interactions can mask the effects of factors. In the second case study, had we simply concluded from the main effect that yield did not differ with plant density, we would have failed to report what the data actually show: yield differs profoundly with plant density – but that row spacing affects the direction of that difference.</p>
</div>
</div>
</div>
<div id="split-plot-design" class="section level2">
<h2><span class="header-section-number">7.3</span> Split-Plot Design</h2>
<p>The <em>Split-Plot Design</em> is a special kind of factorial experiment, in which one factor is nested within another. Let’s jump to an illustration.</p>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="multiple-treatment-designs.html#cb463-1"></a><span class="kw">library</span>(agricolae)</span>
<span id="cb463-2"><a href="multiple-treatment-designs.html#cb463-2"></a></span>
<span id="cb463-3"><a href="multiple-treatment-designs.html#cb463-3"></a>main_factor =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>)</span>
<span id="cb463-4"><a href="multiple-treatment-designs.html#cb463-4"></a>sub_factor =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;A&quot;</span>,<span class="st">&quot;B&quot;</span>,<span class="st">&quot;C&quot;</span>,<span class="st">&quot;D&quot;</span>,<span class="st">&quot;E&quot;</span>)</span>
<span id="cb463-5"><a href="multiple-treatment-designs.html#cb463-5"></a>trt_rand =<span class="st"> </span><span class="kw">design.split</span>(main_factor,</span>
<span id="cb463-6"><a href="multiple-treatment-designs.html#cb463-6"></a>                        sub_factor,</span>
<span id="cb463-7"><a href="multiple-treatment-designs.html#cb463-7"></a>                        <span class="dt">r=</span><span class="dv">2</span>,</span>
<span id="cb463-8"><a href="multiple-treatment-designs.html#cb463-8"></a>                        <span class="dt">design =</span> <span class="st">&quot;rcbd&quot;</span>,</span>
<span id="cb463-9"><a href="multiple-treatment-designs.html#cb463-9"></a>                        <span class="dt">seed=</span><span class="dv">2</span>)</span>
<span id="cb463-10"><a href="multiple-treatment-designs.html#cb463-10"></a></span>
<span id="cb463-11"><a href="multiple-treatment-designs.html#cb463-11"></a>plot_map =<span class="st"> </span>trt_rand<span class="op">$</span>book </span>
<span id="cb463-12"><a href="multiple-treatment-designs.html#cb463-12"></a></span>
<span id="cb463-13"><a href="multiple-treatment-designs.html#cb463-13"></a>plot_map <span class="op">%&gt;%</span></span>
<span id="cb463-14"><a href="multiple-treatment-designs.html#cb463-14"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>plots, <span class="dt">y=</span>splots), <span class="dt">group=</span>main_factor) <span class="op">+</span></span>
<span id="cb463-15"><a href="multiple-treatment-designs.html#cb463-15"></a><span class="st">  </span><span class="kw">geom_tile</span>(<span class="kw">aes</span>(<span class="dt">fill=</span>main_factor), <span class="dt">color=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb463-16"><a href="multiple-treatment-designs.html#cb463-16"></a><span class="st">  </span><span class="kw">geom_text</span>(<span class="kw">aes</span>(<span class="dt">label=</span>sub_factor))</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-24-1.png" width="672" /></p>
<p>In the experiment show above, there are two factors: the main factor and the sub-factor. The main factor has two levels, while the sub-factor has 5 levels. The design is a randomized complete block design. As with any randomized complete block design, all treatments must occur once within each block.</p>
<p>Main factor levels are indicated by color. Sub-factor levels are indicated by letter.</p>
<p>In the above plot map, the main factors occur once in Block 1 (plots 101 and 102) and Block 2 (plots 103 and 104). Within each occurrence of the main factor, all five levels of the sub-factor are nested. The levels of the main factor are randomized within each block, and the levels of the subfactor are randomized within each main plot.</p>
<p>So now that we know what a split-plot design looks like, we will address the question: why would we want to do this? The first answer has to do with practicality. Say the first factor is composed of fungicide treatments that we are going to apply with a Hagge applicator with a 100 ft boom. The second factor is composed of treatments (hybrid, in-furrow fertilizer, etc) that can be apply in 20-foot widths. We can apply our treatments much more easily if we use a split-plot design and nest the second factor (the sub-factor) within the first factor (the main factor).</p>
<p>The second answer is that a thoughtfully-designed split-plot experiment will be more sensitive to differences among levels of the sub-factor than a randomized complete block trial. This is because, no matter how hard we try, plots that are closer together are more likely to be similar than plots that are further apart. By putting the sub-factor treatments close together, we can better estimate and test treatment effects.</p>
<p>The greater sensitivity to subfactor treatments, however, comes at a cost: we sacrifice some of our ability to detect differences among levels of our main factor. Sometimes, however, the levels of the main plot factor are so markedly different that we know we will detect differences among them, even if they are placed further apart. Plus, we may be more interested in the interaction between the main factor and sub-factor, and our ability to estimate and test this interaction, too, is enhanced by the split plot design.</p>
<p>###Case Study: Habenero Peppers
If you are a chili pepper fan like me, you enjoy habanero chilies, also called “Scotch bonnets” in strict moderation. They are hotter than the jalapeno, but not devastating like the Carolina Reaper. In this study, habanero peppers were grown in pots of soils characterized by their color. They were harvested at two stages of ripening, green and orange, and their polyphenol concentrations measured. Soil was the main factor and harvest time the subfactor.</p>
<div class="sourceCode" id="cb464"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb464-1"><a href="multiple-treatment-designs.html#cb464-1"></a>habanero =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data-unit-7/habenero.csv&quot;</span>)</span>
<span id="cb464-2"><a href="multiple-treatment-designs.html#cb464-2"></a><span class="kw">head</span>(habanero)</span></code></pre></div>
<pre><code>##   block  soil harvest_stage total_polyphenols
## 1    R1   red         green         109.84958
## 2    R1   red        orange         186.71777
## 3    R1 brown         green         130.53991
## 4    R1 brown        orange         207.00041
## 5    R1 black         green          97.86705
## 6    R1 black        orange         212.19618</code></pre>
</div>
<div id="linear-additive-model-3" class="section level2">
<h2><span class="header-section-number">7.4</span> Linear Additive Model</h2>
<p><span class="math display">\[ Y_{ijk} = \mu + M_{j} + Error(B_i + BM_{ij}) + S_{k} + MS_{ik} + Error(BS_{ik}+BMS_{ijk})\]</span>
Bear with me. We can break this model down in to two sections. Let’s start with the first three terms. These focus on explaining the observed variance among the main plots.</p>
<p><span class="math inline">\(B_i\)</span> is the effect of block <span class="math inline">\(i\)</span></p>
<p><span class="math inline">\(M_j\)</span> is the effect of level <span class="math inline">\(j\)</span> of the main factor</p>
<p><span class="math inline">\(Error(BM_{ij})\)</span> is the error (unexplained variance) associated with the block <span class="math inline">\(i\)</span> and level <span class="math inline">\(j\)</span> of the main factor. When we calculate the F-value for the main factor, we use this error term.</p>
<p>The second three terms focus on explaining the observed variance among subplots.</p>
<p><span class="math inline">\(S_k\)</span> is the effect of level <span class="math inline">\(k\)</span> of the sub-factor</p>
<p><span class="math inline">\(MS_{ik}\)</span> is the interaction between level <span class="math inline">\(i\)</span> of the main factor and level <span class="math inline">\(k\)</span> of the subfactor</p>
<p><span class="math inline">\(Error(BS_{ik}+BMS_{ijk})\)</span> is the unexplained variance associated with the given levels of the sub factor and the main factor - sub-factor interaction. It is used in testing the significance of both those effects</p>
<p>Ugh. What a dumpster fire. Let’s look at the ANOVA table for our habenero trial to make more sense of this.</p>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="multiple-treatment-designs.html#cb466-1"></a>habanero_model =<span class="st"> </span><span class="kw">aov</span>(total_polyphenols <span class="op">~</span><span class="st"> </span>soil <span class="op">+</span><span class="st"> </span>harvest_stage <span class="op">+</span><span class="st"> </span>soil<span class="op">:</span>harvest_stage <span class="op">+</span><span class="st"> </span><span class="kw">Error</span>(block<span class="op">:</span>soil), <span class="dt">data=</span>habanero)</span></code></pre></div>
<pre><code>## Warning in aov(total_polyphenols ~ soil + harvest_stage + soil:harvest_stage + :
## Error() model is singular</code></pre>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="multiple-treatment-designs.html#cb468-1"></a><span class="kw">summary</span>(habanero_model)</span></code></pre></div>
<pre><code>## 
## Error: block:soil
##           Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## soil       2 1322.7   661.3   8.691 0.00791 **
## Residuals  9  684.9    76.1                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Error: Within
##                    Df Sum Sq Mean Sq F value  Pr(&gt;F)    
## harvest_stage       1  42120   42120  176.72 3.2e-07 ***
## soil:harvest_stage  2   5938    2969   12.46 0.00256 ** 
## Residuals           9   2145     238                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>We have two ANOVA tables. The top table evaluates the effect of soil in our main plots. Looking at the degrees of freedom, we can see we have <em>3 soils - 1 = 2</em> degrees of freedom for soil and <em>(4 blocks - 1) x 3 = 9</em> degrees of freedom for the error. The F-value is the ratio of the mean square for soil and the mean square for the main factor error (residuals).</p>
<p>The second table evalulates the effect of of the harvest stage and the interaction between soil and harvest stage in the subplots. There are <em>2 stages - 1 = 1</em> degree of freedom for harvest stage and *(3 soils - 1) x (2 stages - 1) = 2 degrees of freedom for the interaction. The F-values for the harvest stage and interaction effects are the ratios of their mean squares to the mean square for the subplot error (residuals).</p>
<p>We analyze the ANOVA results the same as we would for any factorial trial. Looking at our table, we see significant results for soil, harvest stage, and their interaction. So lets go straight to the interaction plot.</p>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="multiple-treatment-designs.html#cb470-1"></a>habanero <span class="op">%&gt;%</span></span>
<span id="cb470-2"><a href="multiple-treatment-designs.html#cb470-2"></a><span class="st">  </span><span class="kw">group_by</span>(soil, harvest_stage) <span class="op">%&gt;%</span></span>
<span id="cb470-3"><a href="multiple-treatment-designs.html#cb470-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">total_polyphenols =</span> <span class="kw">mean</span>(total_polyphenols)) <span class="op">%&gt;%</span></span>
<span id="cb470-4"><a href="multiple-treatment-designs.html#cb470-4"></a><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span></span>
<span id="cb470-5"><a href="multiple-treatment-designs.html#cb470-5"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>harvest_stage, <span class="dt">y=</span>total_polyphenols, <span class="dt">group =</span> soil)) <span class="op">+</span></span>
<span id="cb470-6"><a href="multiple-treatment-designs.html#cb470-6"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color=</span>soil))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;soil&#39;. You can override using the `.groups` argument.</code></pre>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-27-1.png" width="672" /></p>
<p>We can see the the total polyphenol concentration was affected by harvest stage in each soil. Orange habaneros had greater total polyphenos than green ones. Furthermore, we can see that black soils produced the fewest total polyphenols when habaneros where harvested green, but the most when they were harvested orange.</p>
<p>Looking at our interaction tables, we see soil has a significant effect on total polyphenols at both harvest stages.</p>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="multiple-treatment-designs.html#cb472-1"></a><span class="kw">library</span>(broom)</span>
<span id="cb472-2"><a href="multiple-treatment-designs.html#cb472-2"></a>slice_<span class="dv">1</span> =<span class="st"> </span>habanero <span class="op">%&gt;%</span></span>
<span id="cb472-3"><a href="multiple-treatment-designs.html#cb472-3"></a><span class="st">  </span><span class="kw">group_by</span>(harvest_stage) <span class="op">%&gt;%</span></span>
<span id="cb472-4"><a href="multiple-treatment-designs.html#cb472-4"></a><span class="st">  </span><span class="kw">do</span>(<span class="kw">tidy</span>(<span class="kw">aov</span>(.<span class="op">$</span>total_polyphenols <span class="op">~</span><span class="st"> </span>.<span class="op">$</span>block <span class="op">+</span><span class="st"> </span>.<span class="op">$</span>soil))) <span class="op">%&gt;%</span></span>
<span id="cb472-5"><a href="multiple-treatment-designs.html#cb472-5"></a><span class="st">  </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb472-6"><a href="multiple-treatment-designs.html#cb472-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">term =</span> <span class="kw">gsub</span>(<span class="st">&quot;[.][$]&quot;</span>, <span class="st">&quot;&quot;</span>, term))</span>
<span id="cb472-7"><a href="multiple-treatment-designs.html#cb472-7"></a></span>
<span id="cb472-8"><a href="multiple-treatment-designs.html#cb472-8"></a>knitr<span class="op">::</span><span class="kw">kable</span>(slice_<span class="dv">1</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">harvest_stage</th>
<th align="left">term</th>
<th align="right">df</th>
<th align="right">sumsq</th>
<th align="right">meansq</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">green</td>
<td align="left">block</td>
<td align="right">3</td>
<td align="right">312.1119</td>
<td align="right">104.03731</td>
<td align="right">0.4324894</td>
<td align="right">0.7375426</td>
</tr>
<tr class="even">
<td align="left">green</td>
<td align="left">soil</td>
<td align="right">2</td>
<td align="right">5006.9642</td>
<td align="right">2503.48208</td>
<td align="right">10.4071271</td>
<td align="right">0.0112036</td>
</tr>
<tr class="odd">
<td align="left">green</td>
<td align="left">Residuals</td>
<td align="right">6</td>
<td align="right">1443.3275</td>
<td align="right">240.55458</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">orange</td>
<td align="left">block</td>
<td align="right">3</td>
<td align="right">79.2278</td>
<td align="right">26.40927</td>
<td align="right">0.1592069</td>
<td align="right">0.9199513</td>
</tr>
<tr class="odd">
<td align="left">orange</td>
<td align="left">soil</td>
<td align="right">2</td>
<td align="right">2253.3551</td>
<td align="right">1126.67757</td>
<td align="right">6.7921174</td>
<td align="right">0.0287564</td>
</tr>
<tr class="even">
<td align="left">orange</td>
<td align="left">Residuals</td>
<td align="right">6</td>
<td align="right">995.2810</td>
<td align="right">165.88017</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
<p>And that harvest stage had a significant effect at each level of soil.</p>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="multiple-treatment-designs.html#cb473-1"></a><span class="kw">library</span>(broom)</span>
<span id="cb473-2"><a href="multiple-treatment-designs.html#cb473-2"></a>slice_<span class="dv">2</span> =<span class="st"> </span>habanero <span class="op">%&gt;%</span></span>
<span id="cb473-3"><a href="multiple-treatment-designs.html#cb473-3"></a><span class="st">  </span><span class="kw">group_by</span>(soil) <span class="op">%&gt;%</span></span>
<span id="cb473-4"><a href="multiple-treatment-designs.html#cb473-4"></a><span class="st">  </span><span class="kw">do</span>(<span class="kw">tidy</span>(<span class="kw">aov</span>(.<span class="op">$</span>total_polyphenols <span class="op">~</span><span class="st"> </span>.<span class="op">$</span>block <span class="op">+</span><span class="st"> </span>.<span class="op">$</span>harvest_stage))) <span class="op">%&gt;%</span></span>
<span id="cb473-5"><a href="multiple-treatment-designs.html#cb473-5"></a><span class="st">  </span><span class="kw">as.data.frame</span>() <span class="op">%&gt;%</span></span>
<span id="cb473-6"><a href="multiple-treatment-designs.html#cb473-6"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">term =</span> <span class="kw">gsub</span>(<span class="st">&quot;[.][$]&quot;</span>, <span class="st">&quot;&quot;</span>, term))</span>
<span id="cb473-7"><a href="multiple-treatment-designs.html#cb473-7"></a></span>
<span id="cb473-8"><a href="multiple-treatment-designs.html#cb473-8"></a>knitr<span class="op">::</span><span class="kw">kable</span>(slice_<span class="dv">2</span>)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">soil</th>
<th align="left">term</th>
<th align="right">df</th>
<th align="right">sumsq</th>
<th align="right">meansq</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">black</td>
<td align="left">block</td>
<td align="right">3</td>
<td align="right">79.03859</td>
<td align="right">26.34620</td>
<td align="right">0.0555253</td>
<td align="right">0.9798439</td>
</tr>
<tr class="even">
<td align="left">black</td>
<td align="left">harvest_stage</td>
<td align="right">1</td>
<td align="right">32872.72483</td>
<td align="right">32872.72483</td>
<td align="right">69.2801410</td>
<td align="right">0.0036344</td>
</tr>
<tr class="odd">
<td align="left">black</td>
<td align="left">Residuals</td>
<td align="right">3</td>
<td align="right">1423.46960</td>
<td align="right">474.48987</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">brown</td>
<td align="left">block</td>
<td align="right">3</td>
<td align="right">214.87947</td>
<td align="right">71.62649</td>
<td align="right">0.5937286</td>
<td align="right">0.6605111</td>
</tr>
<tr class="odd">
<td align="left">brown</td>
<td align="left">harvest_stage</td>
<td align="right">1</td>
<td align="right">7062.17490</td>
<td align="right">7062.17490</td>
<td align="right">58.5400106</td>
<td align="right">0.0046367</td>
</tr>
<tr class="even">
<td align="left">brown</td>
<td align="left">Residuals</td>
<td align="right">3</td>
<td align="right">361.91529</td>
<td align="right">120.63843</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">red</td>
<td align="left">block</td>
<td align="right">3</td>
<td align="right">390.95481</td>
<td align="right">130.31827</td>
<td align="right">1.0869202</td>
<td align="right">0.4734925</td>
</tr>
<tr class="even">
<td align="left">red</td>
<td align="left">harvest_stage</td>
<td align="right">1</td>
<td align="right">8122.82365</td>
<td align="right">8122.82365</td>
<td align="right">67.7484520</td>
<td align="right">0.0037542</td>
</tr>
<tr class="odd">
<td align="left">red</td>
<td align="left">Residuals</td>
<td align="right">3</td>
<td align="right">359.69045</td>
<td align="right">119.89682</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
</div>
<div id="conclusion" class="section level2">
<h2><span class="header-section-number">7.5</span> Conclusion</h2>
<p>Experimental design of multiple treatment experiments plays a critical role in the quality of our data and the inferences that can be made. In most cases, you will probably run randomized complete block design experiments with a single factor, where blocking will reduce the error among plots within each block.</p>
<p>The factorial design allows greater efficiency if you are interested in studying two factors. It is also the only way to study the interaction between two factors.</p>
<p>Finally, where one factor is known to be more subtle (and therefore, harder to test signficance for) than a second factor, or where differences in equipment size make it more practical to nest one factor inside the other, the split-plot design can be very useful.</p>
</div>
<div id="exercise-randomized-complete-block-design" class="section level2">
<h2><span class="header-section-number">7.6</span> Exercise: Randomized Complete Block Design</h2>
<p>While the lecture is long this week, fortunately running the analyses in R is very fast. We start the exercies with the Randomized Complete Block Design. To run a Randomized Complete Block Design, we will again use same analysis of variance approach we did last week. We only need two lines of code: the first to define the model we wish to test, and the second to tell R to summarise the results.</p>
<div id="case-study-5" class="section level3">
<h3><span class="header-section-number">7.6.1</span> Case Study</h3>
<p>Barley varieties were compared using a Randomized Complete Block Design. Yield is in grams per plot. Five varieties were grown in three replicates.</p>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="multiple-treatment-designs.html#cb474-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb474-2"><a href="multiple-treatment-designs.html#cb474-2"></a>barley =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data-unit-7/exercise_data/barley_besag.csv&quot;</span>)</span>
<span id="cb474-3"><a href="multiple-treatment-designs.html#cb474-3"></a><span class="kw">head</span>(barley)</span></code></pre></div>
<pre><code>##   block gen yield
## 1     1 G37 10.92
## 2     1 G55 12.07
## 3     1 G58  9.51
## 4     1 G63  9.23
## 5     1 G09  8.03
## 6     2 G37 10.24</code></pre>
</div>
<div id="anova-1" class="section level3">
<h3><span class="header-section-number">7.6.2</span> ANOVA</h3>
<p>For this analysis of variance, we need two lines of code. The first is the model statement:</p>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="multiple-treatment-designs.html#cb476-1"></a>barley_model =<span class="st"> </span><span class="kw">aov</span>(yield <span class="op">~</span><span class="st"> </span>block <span class="op">+</span><span class="st"> </span>gen, <span class="dt">data=</span>barley)</span></code></pre></div>
<p>In the above code:</p>
<ul>
<li>barley_model defines the object to which the ANOVA results will be saved</li>
<li>“aov” tells R to run an analysis of variance</li>
<li>“yield ~ block + gen” tells R our linear additive model. When using R, we leave out mu and the error term – R knows to calculate these.</li>
<li>“data=barley” tells R to fit our ANOVA model to the barley dataset</li>
</ul>
<p>Reviewing our results is simple:</p>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="multiple-treatment-designs.html#cb477-1"></a><span class="kw">summary</span>(barley_model)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## block        1  2.611   2.611   7.476 0.023066 *  
## gen          4 19.758   4.940  14.142 0.000642 ***
## Residuals    9  3.144   0.349                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>In our result above, we see the effect of barley variety (gen) is highly significant.</p>
</div>
<div id="plotting-the-results" class="section level3">
<h3><span class="header-section-number">7.6.3</span> Plotting the Results</h3>
<p>Although we get into the presentation of treatment means in more detail late in the course, lets take a quick look at our treatment means. We will use ggplot.</p>
<div class="sourceCode" id="cb479"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb479-1"><a href="multiple-treatment-designs.html#cb479-1"></a>barley_plot =<span class="st"> </span><span class="kw">ggplot</span>(barley, <span class="kw">aes</span>(<span class="dt">x=</span>gen, <span class="dt">y=</span>yield)) <span class="op">+</span></span>
<span id="cb479-2"><a href="multiple-treatment-designs.html#cb479-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="dt">fun=</span><span class="st">&quot;mean&quot;</span>)</span></code></pre></div>
<p>In the plot above:
* barley is the object to which we are saving the plot
* ggplot() starts the ggplot function
* “ggplot(barley, aes(x=gen, y=yield))” tells R that our plot will be based on the barley dataset. Anything in ggplot that occurs in aes() brackets is an “aesthetic”. An aesthetic is any value that is based on a variable from our plot and changes in value from treatment to treatment. x=gen tells R the horizontal position of whatever we draw (points, parts, etc.) is determined by the gen variable. y=yield tells R the vertical position (height) of our object is based on the yield variable.
* “geom_bar” tells R we want to draw bars with our data.
* With geom bar, we can also calculate summary statistics on the fly. stat=“summary” tells R we are going to calculate a summary statistic. fun=“mean” tells R to use the mean as that statistic.</p>
<p>Now we can display the plot at any time by running barley_plot:</p>
<div class="sourceCode" id="cb480"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb480-1"><a href="multiple-treatment-designs.html#cb480-1"></a>barley_plot</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-34-1.png" width="672" /></p>
<p>This is so drab! While I don’t want you to get bogged down in formatting plots, let’s tweak a few details just so you can see the power of ggplot to make publication-quality plots.</p>
<p>Let’s change the bar color by adding the “fill” command to our code:</p>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="multiple-treatment-designs.html#cb481-1"></a>barley_plot =<span class="st"> </span><span class="kw">ggplot</span>(barley, <span class="kw">aes</span>(<span class="dt">x=</span>gen, <span class="dt">y=</span>yield)) <span class="op">+</span></span>
<span id="cb481-2"><a href="multiple-treatment-designs.html#cb481-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="dt">fun=</span><span class="st">&quot;mean&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;darkolivegreen&quot;</span>)</span>
<span id="cb481-3"><a href="multiple-treatment-designs.html#cb481-3"></a></span>
<span id="cb481-4"><a href="multiple-treatment-designs.html#cb481-4"></a>barley_plot</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-35-1.png" width="672" /></p>
<p>Let’s draw a black line around the outside of the bars by adding “color” to our geom_bar statement.</p>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="multiple-treatment-designs.html#cb482-1"></a>barley_plot =<span class="st"> </span><span class="kw">ggplot</span>(barley, <span class="kw">aes</span>(<span class="dt">x=</span>gen, <span class="dt">y=</span>yield)) <span class="op">+</span></span>
<span id="cb482-2"><a href="multiple-treatment-designs.html#cb482-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="dt">fun=</span><span class="st">&quot;mean&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;darkolivegreen&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>)</span>
<span id="cb482-3"><a href="multiple-treatment-designs.html#cb482-3"></a>barley_plot</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-36-1.png" width="672" /></p>
<p>Let’s make the outline a little thicker using the size command:</p>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="multiple-treatment-designs.html#cb483-1"></a>barley_plot =<span class="st"> </span><span class="kw">ggplot</span>(barley, <span class="kw">aes</span>(<span class="dt">x=</span>gen, <span class="dt">y=</span>yield)) <span class="op">+</span></span>
<span id="cb483-2"><a href="multiple-treatment-designs.html#cb483-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="dt">fun=</span><span class="st">&quot;mean&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;darkolivegreen&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>, <span class="dt">size=</span><span class="fl">1.5</span>)</span>
<span id="cb483-3"><a href="multiple-treatment-designs.html#cb483-3"></a>barley_plot</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
<p>The axis titles are little hard to read. We can change text formatting, legend formatting, and other objects using the “theme” function. In the theme function below, let’s change the “axis.title” size using the “element_text” command and setting the size to 18.</p>
<div class="sourceCode" id="cb484"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb484-1"><a href="multiple-treatment-designs.html#cb484-1"></a>barley_plot =<span class="st"> </span><span class="kw">ggplot</span>(barley, <span class="kw">aes</span>(<span class="dt">x=</span>gen, <span class="dt">y=</span>yield)) <span class="op">+</span></span>
<span id="cb484-2"><a href="multiple-treatment-designs.html#cb484-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="dt">fun=</span><span class="st">&quot;mean&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;darkolivegreen&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb484-3"><a href="multiple-treatment-designs.html#cb484-3"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">18</span>))</span>
<span id="cb484-4"><a href="multiple-treatment-designs.html#cb484-4"></a>barley_plot</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-38-1.png" width="672" /></p>
<p>Let’s similarly increase the size of the axis.text (tick labels) to 14pt.</p>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="multiple-treatment-designs.html#cb485-1"></a>barley_plot =<span class="st"> </span><span class="kw">ggplot</span>(barley, <span class="kw">aes</span>(<span class="dt">x=</span>gen, <span class="dt">y=</span>yield)) <span class="op">+</span></span>
<span id="cb485-2"><a href="multiple-treatment-designs.html#cb485-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="dt">fun=</span><span class="st">&quot;mean&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;darkolivegreen&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb485-3"><a href="multiple-treatment-designs.html#cb485-3"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">18</span>),</span>
<span id="cb485-4"><a href="multiple-treatment-designs.html#cb485-4"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>))</span>
<span id="cb485-5"><a href="multiple-treatment-designs.html#cb485-5"></a>barley_plot</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>Finally, let’s rename our axis titles using the lab() command.</p>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="multiple-treatment-designs.html#cb486-1"></a>barley_plot =<span class="st"> </span><span class="kw">ggplot</span>(barley, <span class="kw">aes</span>(<span class="dt">x=</span>gen, <span class="dt">y=</span>yield)) <span class="op">+</span></span>
<span id="cb486-2"><a href="multiple-treatment-designs.html#cb486-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="dt">fun=</span><span class="st">&quot;mean&quot;</span>, <span class="dt">fill=</span><span class="st">&quot;darkolivegreen&quot;</span>, <span class="dt">color=</span><span class="st">&quot;black&quot;</span>) <span class="op">+</span></span>
<span id="cb486-3"><a href="multiple-treatment-designs.html#cb486-3"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">18</span>),</span>
<span id="cb486-4"><a href="multiple-treatment-designs.html#cb486-4"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>)) <span class="op">+</span></span>
<span id="cb486-5"><a href="multiple-treatment-designs.html#cb486-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">x=</span><span class="st">&quot;variety&quot;</span>, <span class="dt">y=</span><span class="st">&quot;Yield (tons ha-1)&quot;</span>)</span>
<span id="cb486-6"><a href="multiple-treatment-designs.html#cb486-6"></a>barley_plot</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-40-1.png" width="672" /></p>
<p>Like I said, I don’t want you to get too bogged down in formatting your plots. And, yes, a simple plot like this could be made just as quickly in Excel. But building the plot in R Studio has multiple advantages. First, you don’t have to cut and paste your data to Excel. Second, you don’t have to copy your completed chart back to R or your report document. You can include it right in your R Notebook with your data. That way, if you are working on your creative component, you can have one document, instead of multiple documents all over the place. Third, if you are working on the multiple plots, you can coordinate them by reusing your theme code from plot to plot, rather than having to click and change each field in each plot. Finally, and most importantly, you have way more options for creating your plot in R than just about any software I know!</p>
</div>
<div id="practice-6" class="section level3">
<h3><span class="header-section-number">7.6.4</span> Practice</h3>
<p>Navy bean varieties were evaluated in a randomized complete block trial .</p>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="multiple-treatment-designs.html#cb487-1"></a>beans =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data-unit-7/exercise_data/besag_beans.csv&quot;</span>)</span>
<span id="cb487-2"><a href="multiple-treatment-designs.html#cb487-2"></a><span class="kw">head</span>(beans)</span></code></pre></div>
<pre><code>##   block     gen yield
## 1    R1   Maris   350
## 2    R1   Dwarf   230
## 3    R1  Minica   355
## 4    R1  Stella   370
## 5    R1 Topless   280
## 6    R1 Metissa   185</code></pre>
<p>Run the analysis in R. Your output should match the following:</p>
<pre><code>         Df Sum Sq Mean Sq F value  Pr(&gt;F)    </code></pre>
<p>block 23 294256 12794 2.324 0.00182 **
gen 5 719695 143939 26.147 &lt; 2e-16 ***
Residuals 115 633063 5505</p>
<p>Signif. codes: 0 ‘<em><strong>’ 0.001 ‘</strong>’ 0.01 ‘</em>’ 0.05 ‘.’ 0.1 ‘ ’ 1</p>
<p>What do you conclude from the analysis of variance?</p>
</div>
</div>
<div id="exercise-factorial-anova" class="section level2">
<h2><span class="header-section-number">7.7</span> Exercise: Factorial ANOVA</h2>
<p>For the second exercise this week, we will work with factorial experimental designs. Remember, a factorial design has two or more factors; within each factor are two or more levels, which we commonly refer to as treatments. For a factorial design, our analysis becomes a little more complex, but not terribly so. Factorial experiments may have Completely Randomized Designs or Randomized Complete Block Designs. The latter is more common.</p>
<div id="case-study-biochar" class="section level3">
<h3><span class="header-section-number">7.7.1</span> Case Study: Biochar</h3>
<p>For our case study, we will use a dataset inspired from a recent paper:</p>
<p>Ahmad, M.; Wang, X.; Hilger, T.H.; Luqman, M.; Nazli, F.; Hussain, A.; Zahir, Z.A.; Latif, M.; Saeed, Q.; Malik, H.A.; Mustafa, A. Evaluating Biochar-Microbe Synergies for Improved Growth, Yield of Maize, and Post-Harvest Soil Characteristics in a Semi-Arid Climate. Agronomy 2020, 10, 1055.</p>
<p>This trial, in Pakistan, looked at the factorial effects of biochar soil amendments and and seed innoculum on maize growth. I am not an expert on biochar – it is basically an amendment made from burned crop residues – a charcoal of sorts. More information can be found in the paper above, which is open-source.</p>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="multiple-treatment-designs.html#cb490-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb490-2"><a href="multiple-treatment-designs.html#cb490-2"></a>biochar =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data-unit-7/exercise_data/biochar_innoculum.csv&quot;</span>)</span>
<span id="cb490-3"><a href="multiple-treatment-designs.html#cb490-3"></a><span class="kw">head</span>(biochar)</span></code></pre></div>
<pre><code>##   Block Innoculation                      Amendment    Yield
## 1    B1   Inoculated                        Control 7.426576
## 2    B1   Inoculated Egyptian.acacia.biochar..0.1.. 6.848225
## 3    B1   Inoculated Egyptian.acacia.biochar..0.2.. 8.130492
## 4    B1   Inoculated             FYM.biochar..0.1.. 6.349240
## 5    B1   Inoculated             FYM.biochar..0.2.. 8.463009
## 6    B1   Inoculated     Wheat.straw.biochar..0.1.. 7.647091</code></pre>
<p>I tend to skip over the treatments, so let’s discuss them in greater detail. There are 2 levels of the Innoculation factor: innoculated, or not Innoculated. There are 7 levels of the factor biochar: one control plus 6 biochar treatments of different sources and rates. There are 6 blocks. Yield is reported in tons per hectare.</p>
</div>
<div id="anova-2" class="section level3">
<h3><span class="header-section-number">7.7.2</span> ANOVA</h3>
<p>We use the same two lines of code we have used for other analyses of variance. First, our model statement. Before we enter that, let’s review the linear additive model for this factorial experiment:</p>
<p>Yield = mu + Block + Innoculation + Amendment + Innoculation*Amendment + Error</p>
<p>This includes the effect of Block (which is assumed, by nature of the design, to not interact with the Innoculation or Amendment factors), Innoculation, Amendment, and their interaction, Innoculation*Amendment.</p>
<p>Having identified the linear additive model, we can write out model statement in R.</p>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="multiple-treatment-designs.html#cb492-1"></a>biochar_model =<span class="st"> </span><span class="kw">aov</span>(Yield <span class="op">~</span><span class="st"> </span>Block <span class="op">+</span><span class="st"> </span>Innoculation <span class="op">+</span><span class="st"> </span>Amendment <span class="op">+</span><span class="st"> </span>Innoculation<span class="op">:</span>Amendment, <span class="dt">data =</span> biochar)</span></code></pre></div>
<p>Just the same as for other trials, the statement above defines an object, “biochar” model, and assigns it the output of an analysis of variance (aov), based on our linear model and the dataset “biochar”.</p>
<p>We can look at the ANOVA table by using the <em>summary()</em> function.</p>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="multiple-treatment-designs.html#cb493-1"></a><span class="kw">summary</span>(biochar_model)</span></code></pre></div>
<pre><code>##                        Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## Block                   5  26.98   5.396   8.782 2.09e-06 ***
## Innoculation            1   4.24   4.244   6.907 0.010703 *  
## Amendment               6  19.10   3.183   5.181 0.000208 ***
## Innoculation:Amendment  6   4.44   0.740   1.205 0.315335    
## Residuals              65  39.94   0.614                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Looking first at our main effects, we see the effects of both factors, Innoculation aren Amendment, are significant at the P=0.05 level. The interaction is not significant.</p>
</div>
<div id="interaction-plots" class="section level3">
<h3><span class="header-section-number">7.7.3</span> Interaction Plots</h3>
<p>As we learned in the lecture, it is important when analyzing factorial design experiments to plot the interactions between the data. Although line plots are normally used in the final presentation of qualitative factors like products and practices, they are useful to visualize the nature of interactions.</p>
<p>The first step in creating our plot is to create a dataset of means. To do this, we need to group our data using the <em>group_by()</em> function, calculate the means for each combination of Innoculation and Amendment, and <em>ungroup()</em> the data. We can link these functions with “%&gt;%”</p>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="multiple-treatment-designs.html#cb495-1"></a>grouped_data =<span class="st"> </span>biochar <span class="op">%&gt;%</span><span class="st">     </span><span class="co"># this feeds the biochar dataset to the next line</span></span>
<span id="cb495-2"><a href="multiple-treatment-designs.html#cb495-2"></a><span class="st">  </span><span class="kw">group_by</span>(Innoculation, Amendment) <span class="op">%&gt;%</span><span class="st">     </span><span class="co"># group by the interactions of Innoculation and Amendment</span></span>
<span id="cb495-3"><a href="multiple-treatment-designs.html#cb495-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">Yield =</span> <span class="kw">mean</span>(Yield)) <span class="op">%&gt;%</span><span class="st">     </span><span class="co"># calculate the means for the interactions</span></span>
<span id="cb495-4"><a href="multiple-treatment-designs.html#cb495-4"></a><span class="st">  </span><span class="kw">ungroup</span>()    <span class="co"># ungroup the data for further processing</span></span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;Innoculation&#39;. You can override using the `.groups` argument.</code></pre>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="multiple-treatment-designs.html#cb497-1"></a>grouped_data</span></code></pre></div>
<pre><code>## # A tibble: 14 x 3
##    Innoculation  Amendment                      Yield
##    &lt;chr&gt;         &lt;chr&gt;                          &lt;dbl&gt;
##  1 Inoculated    Control                         8.38
##  2 Inoculated    Egyptian.acacia.biochar..0.1..  7.84
##  3 Inoculated    Egyptian.acacia.biochar..0.2..  8.05
##  4 Inoculated    FYM.biochar..0.1..              8.33
##  5 Inoculated    FYM.biochar..0.2..              9.19
##  6 Inoculated    Wheat.straw.biochar..0.1..      8.75
##  7 Inoculated    Wheat.straw.biochar..0.2..      9.57
##  8 Un-Inoculated Control                         7.45
##  9 Un-Inoculated Egyptian.acacia.biochar..0.1..  7.54
## 10 Un-Inoculated Egyptian.acacia.biochar..0.2..  8.13
## 11 Un-Inoculated FYM.biochar..0.1..              8.16
## 12 Un-Inoculated FYM.biochar..0.2..              8.20
## 13 Un-Inoculated Wheat.straw.biochar..0.1..      8.86
## 14 Un-Inoculated Wheat.straw.biochar..0.2..      8.62</code></pre>
<p>We can now feed our grouped data into ggplot to create our line plot. The aes() argument tells R that the position of the points connected by our lines will be determined by their level of the Innoculation factor and their Yield. It further tells R that lines should be drawn between points with the same level of the Amendment factor.</p>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="multiple-treatment-designs.html#cb499-1"></a>grouped_data <span class="op">%&gt;%</span></span>
<span id="cb499-2"><a href="multiple-treatment-designs.html#cb499-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Innoculation, <span class="dt">y=</span>Yield, <span class="dt">group=</span>Amendment)) </span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<p>We need to add one more line telling R what shapes (geometries) to draw. We add the <em>geom_line</em> argument. In it we include an aes() argument to associate line color to with level of Innoclulation.</p>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="multiple-treatment-designs.html#cb500-1"></a>grouped_data <span class="op">%&gt;%</span></span>
<span id="cb500-2"><a href="multiple-treatment-designs.html#cb500-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>Innoculation, <span class="dt">y=</span>Yield, <span class="dt">group=</span>Amendment)) <span class="op">+</span></span>
<span id="cb500-3"><a href="multiple-treatment-designs.html#cb500-3"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color=</span>Amendment))</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-47-1.png" width="672" />
Our plot above reflects our ANOVA results. Maize yield with most amendments decreased when the crop was un-innoculated. The maize response was flat or even slightly increased for a few levels of Amendment, but the interaction only had a P-value of about 0.32, so the interaction was not significant. Similarly, the ranking of Amendments changed somewhat with level of Innoculation, but not enough to be significant.</p>
</div>
<div id="testing-factors-individually" class="section level3">
<h3><span class="header-section-number">7.7.4</span> Testing Factors Individually</h3>
<p>Sometimes we may want to know whether one factor has a significant effect at each level of the other factor.
To do this requires three lines of code. The last is a little tricky, but we will get there.</p>
<p>The first couple of lines should look familiar. We take the biochar data.frame, and we use group_by to group it by Innoculation level.</p>
<p>The third line requires further explation. What we ae doing is telling R to run a separate analysis of variance for Amendment at each level of Innnoculation.</p>
<p>*aov(.<span class="math inline">\(Yield ~ .\)</span>Block + .<span class="math inline">\(Amendment))* is our anova model, but it looks different than the ones we have specified before. Normally we would just write: *aov(Yield ~ Block + Amendment, data = biochar)*. We can&#39;t do that here, though, because the model is using the data groups fed by the group_by() function just above. Instead, the &quot;.\)</span>" tells R that each term in the model is a column from the data that is being fed to it.</p>
<p><em>tidy</em> tells R to return the anova as a data.frame() This allows us to stack the ANOVAs for different levels of Innoculant on top of each other. <em>tidy</em> is part of the <em>broom</em> package, so we use <em>library(broom)</em> to load that package before we begin.</p>
<p>Finally, <em>do()</em> is the magical command that tells R to, well, do something – anything – with the groups of data that are fed to it.</p>
<p>So when we put it all together, the third line tells R to <em>do</em> something with the two levels of Innoculant, specifically to create <em>tidy</em> data.frames of the analyses of variance for both of them.</p>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="multiple-treatment-designs.html#cb501-1"></a><span class="kw">library</span>(broom)</span>
<span id="cb501-2"><a href="multiple-treatment-designs.html#cb501-2"></a></span>
<span id="cb501-3"><a href="multiple-treatment-designs.html#cb501-3"></a>biochar <span class="op">%&gt;%</span></span>
<span id="cb501-4"><a href="multiple-treatment-designs.html#cb501-4"></a><span class="st">  </span><span class="kw">group_by</span>(Innoculation) <span class="op">%&gt;%</span></span>
<span id="cb501-5"><a href="multiple-treatment-designs.html#cb501-5"></a><span class="st">  </span><span class="kw">do</span>(<span class="kw">tidy</span>(<span class="kw">aov</span>(.<span class="op">$</span>Yield <span class="op">~</span><span class="st"> </span>.<span class="op">$</span>Block <span class="op">+</span><span class="st"> </span>.<span class="op">$</span>Amendment)))</span></code></pre></div>
<pre><code>## # A tibble: 6 x 7
## # Groups:   Innoculation [2]
##   Innoculation  term           df sumsq meansq statistic     p.value
##   &lt;chr&gt;         &lt;chr&gt;       &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;       &lt;dbl&gt;
## 1 Inoculated    .$Block         5 22.1   4.42      11.6   0.00000272
## 2 Inoculated    .$Amendment     6 14.0   2.33       6.10  0.000291  
## 3 Inoculated    Residuals      30 11.5   0.382     NA    NA         
## 4 Un-Inoculated .$Block         5 13.3   2.67       4.00  0.00669   
## 5 Un-Inoculated .$Amendment     6  9.58  1.60       2.39  0.0521    
## 6 Un-Inoculated Residuals      30 20.0   0.667     NA    NA</code></pre>
<p>We can see from the output that the effect of Amendment is significant at both levels of Innoculant.</p>
<p>What about the other way around? We simply take the code above and reverse the positions of Amendment and Innoculation.</p>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="multiple-treatment-designs.html#cb503-1"></a>biochar <span class="op">%&gt;%</span></span>
<span id="cb503-2"><a href="multiple-treatment-designs.html#cb503-2"></a><span class="st">  </span><span class="kw">group_by</span>(Amendment) <span class="op">%&gt;%</span></span>
<span id="cb503-3"><a href="multiple-treatment-designs.html#cb503-3"></a><span class="st">  </span><span class="kw">do</span>(<span class="kw">tidy</span>(<span class="kw">aov</span>(.<span class="op">$</span>Yield <span class="op">~</span><span class="st"> </span>.<span class="op">$</span>Block <span class="op">+</span><span class="st"> </span>.<span class="op">$</span>Innoculation)))</span></code></pre></div>
<pre><code>## # A tibble: 21 x 7
## # Groups:   Amendment [7]
##    Amendment                  term           df   sumsq meansq statistic p.value
##    &lt;chr&gt;                      &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;     &lt;dbl&gt;   &lt;dbl&gt;
##  1 Control                    .$Block         5  2.26   0.452     1.27    0.401 
##  2 Control                    .$Innocula~     1  2.61   2.61      7.32    0.0425
##  3 Control                    Residuals       5  1.78   0.357    NA      NA     
##  4 Egyptian.acacia.biochar..~ .$Block         5  4.01   0.801     1.68    0.292 
##  5 Egyptian.acacia.biochar..~ .$Innocula~     1  0.266  0.266     0.556   0.489 
##  6 Egyptian.acacia.biochar..~ Residuals       5  2.39   0.478    NA      NA     
##  7 Egyptian.acacia.biochar..~ .$Block         5  4.67   0.934     0.779   0.604 
##  8 Egyptian.acacia.biochar..~ .$Innocula~     1  0.0225 0.0225    0.0188  0.896 
##  9 Egyptian.acacia.biochar..~ Residuals       5  5.99   1.20     NA      NA     
## 10 FYM.biochar..0.1..         .$Block         5 12.3    2.47      3.30    0.108 
## # ... with 11 more rows</code></pre>
<p>We see the effect of Innoculant on yield is only significant for the Control and Wheat Straw Biochar 2X rate. It is insignificant with all other levels of Amendment.</p>
</div>
<div id="bar-plots" class="section level3">
<h3><span class="header-section-number">7.7.5</span> Bar Plots</h3>
<p>Similar to the other exercise, we can also create a bar plot of the treatment means. We have two factors, however, so we will need to tweak our code. The first thing to do is to pick one of the factors to be plotted along the X axis. Lets go with the Amendment factor. We can create a simple bar graph for our Amendment treatments</p>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="multiple-treatment-designs.html#cb505-1"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>biochar, <span class="kw">aes</span>(<span class="dt">x=</span>Amendment, <span class="dt">y=</span>Yield)) <span class="op">+</span></span>
<span id="cb505-2"><a href="multiple-treatment-designs.html#cb505-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;summary&quot;</span>, <span class="dt">fun=</span><span class="st">&quot;mean&quot;</span>)</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-50-1.png" width="672" /></p>
<p>The treatment names are running together a little, so lets add a theme argument with “angle =” to pitch those at a 45 degree angle to the axis and "hjust=1) to right-justify them from the axis.</p>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="multiple-treatment-designs.html#cb506-1"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>biochar, <span class="kw">aes</span>(<span class="dt">x=</span>Amendment, <span class="dt">y=</span>Yield)) <span class="op">+</span></span>
<span id="cb506-2"><a href="multiple-treatment-designs.html#cb506-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;summary&quot;</span>, <span class="dt">fun=</span><span class="st">&quot;mean&quot;</span>) <span class="op">+</span></span>
<span id="cb506-3"><a href="multiple-treatment-designs.html#cb506-3"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<p>We can plot the innoculum effect the same way, just substituting “Innoculation” for “Amendment” in our code above.</p>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="multiple-treatment-designs.html#cb507-1"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>biochar, <span class="kw">aes</span>(<span class="dt">x=</span>Innoculation, <span class="dt">y=</span>Yield)) <span class="op">+</span></span>
<span id="cb507-2"><a href="multiple-treatment-designs.html#cb507-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;summary&quot;</span>, <span class="dt">fun=</span><span class="st">&quot;mean&quot;</span>)</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-52-1.png" width="672" /></p>
<p>Of course, in a factorial experiment, we may want to see both treatments together. In the plot below, we will plot Amendment along the X axis, Yield on the Y axis, and group the bars by level of Innoculation. Our plot starts out similar to the Amendment plot above. But in the first line we need to add the argument “group=Innoculation”. This tells R we will group our bars by the level of innoculation.</p>
<p>To our second line, we need to add an aesthetics argument (aes). Why? Because we want the color of the bar to change with the valuable of a variable, in this case the level of innoculation. Our complete argmument reads “aes(fill = Innoculation)”</p>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="multiple-treatment-designs.html#cb508-1"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>biochar, <span class="kw">aes</span>(<span class="dt">x=</span>Amendment, <span class="dt">y=</span>Yield, <span class="dt">group=</span>Innoculation)) <span class="op">+</span><span class="st">  </span><span class="co"># add group statement to this line</span></span>
<span id="cb508-2"><a href="multiple-treatment-designs.html#cb508-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;summary&quot;</span>, <span class="dt">fun=</span><span class="st">&quot;mean&quot;</span>, <span class="kw">aes</span>(<span class="dt">fill=</span>Innoculation)) <span class="op">+</span><span class="st">  </span><span class="co"># add fill statement to this line</span></span>
<span id="cb508-3"><a href="multiple-treatment-designs.html#cb508-3"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-53-1.png" width="672" /></p>
<p>Ok, we’ve got different colored bars – but they are stacked! We want them side-by-side. So we need to add one more argument to our second line: position=“dodge”. This tells R to position the bars so they “dodge” each other. It’s a weird choice of words, but technically it works.</p>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="multiple-treatment-designs.html#cb509-1"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>biochar, <span class="kw">aes</span>(<span class="dt">x=</span>Amendment, <span class="dt">y=</span>Yield, <span class="dt">group=</span>Innoculation)) <span class="op">+</span><span class="st">  </span><span class="co"># add group statement to this line</span></span>
<span id="cb509-2"><a href="multiple-treatment-designs.html#cb509-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;summary&quot;</span>, <span class="dt">fun=</span><span class="st">&quot;mean&quot;</span>, <span class="kw">aes</span>(<span class="dt">fill=</span>Innoculation), <span class="dt">position=</span><span class="st">&quot;dodge&quot;</span>) <span class="op">+</span><span class="st">  </span><span class="co"># add fill statement to this line</span></span>
<span id="cb509-3"><a href="multiple-treatment-designs.html#cb509-3"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-54-1.png" width="672" /></p>
<p>And Voila, we have our plot. Whew, those color bars are high-contrast, which is great for accessibility. If we want to change the colors to something closer to our preferred palate, however,</p>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="multiple-treatment-designs.html#cb510-1"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>biochar, <span class="kw">aes</span>(<span class="dt">x=</span>Amendment, <span class="dt">y=</span>Yield, <span class="dt">group=</span>Innoculation)) <span class="op">+</span><span class="st">  </span><span class="co"># add group statement to this line</span></span>
<span id="cb510-2"><a href="multiple-treatment-designs.html#cb510-2"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;summary&quot;</span>, <span class="dt">fun=</span><span class="st">&quot;mean&quot;</span>, <span class="kw">aes</span>(<span class="dt">fill=</span>Innoculation), <span class="dt">position=</span><span class="st">&quot;dodge&quot;</span>) <span class="op">+</span><span class="st">  </span><span class="co"># add fill statement to this line</span></span>
<span id="cb510-3"><a href="multiple-treatment-designs.html#cb510-3"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="dv">1</span>)) <span class="op">+</span></span>
<span id="cb510-4"><a href="multiple-treatment-designs.html#cb510-4"></a><span class="st">  </span><span class="kw">scale_fill_manual</span>(<span class="dt">values =</span> <span class="kw">c</span>(<span class="st">&quot;darkgreen&quot;</span>, <span class="st">&quot;orange&quot;</span>))</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-55-1.png" width="672" /></p>
</div>
<div id="practice-7" class="section level3">
<h3><span class="header-section-number">7.7.6</span> Practice</h3>
<p>For practice we have a dataset inspired by “Plant population and row spacing effects on corn: Plant growth, phenology, and grain yield” (2020), published by Brad J. Bernhard Frederick E. Below in Agronomy Journal. The article is open source.</p>
<p>In this study, corn was grown with two row spacings and four plant populations. The trial was a complete random block design.</p>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="multiple-treatment-designs.html#cb511-1"></a>corn =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data-unit-7/exercise_data/corn_pop_spacing.csv&quot;</span>)</span>
<span id="cb511-2"><a href="multiple-treatment-designs.html#cb511-2"></a><span class="kw">head</span>(corn)</span></code></pre></div>
<pre><code>##   block    pop spacing    yield
## 1     1  94000      76 16.90595
## 2     1  94000      51 16.72022
## 3     1 109000      76 15.69209
## 4     1 109000      51 18.51509
## 5     1 124000      76 16.26873
## 6     1 124000      51 17.26152</code></pre>
<p>We need to do a couple of things to our dataset before we can run an analysis of variance. We need to reformat the data for block, pop, and spacing. Although I did not intend to make this part of the exercise, I’m glad it is in here.</p>
<p>ANOVA is based on named effects. But if we look under the words block, pop, and spacing, we see the expression “<int>”. The problem is that we are using numbers to represent our treatments. If we run the analysis of variance on these data as-is, our table will look like this:</p>
<pre><code>       Df Sum Sq Mean Sq F value   Pr(&gt;F)    </code></pre>
<p>block 1 17.808 17.808 24.850 3.17e-05 *<strong>
pop 1 2.028 2.028 2.831 0.10402<br />
spacing 1 5.550 5.550 7.745 0.00971 </strong>
<a href="pop:spacing" class="uri">pop:spacing</a> 1 1.318 1.318 1.839 0.18633<br />
Residuals 27 19.349 0.717</p>
<p>If you see nothing wrong, be comforted this has happened to me <em>many</em> times. But look again, particularly at the degrees of freedom. Do you see it now? We have four blocks in this trial, so we should have three degrees of freedom. We have four populations, so again we should have three degrees of freedom. Our degrees of freedom for population should be equal to the population degrees of freedom (4-1 = 3) times the spacing degrees of freedom (2-1 = 1), or three degrees.</p>
<p>What is going on is R thingks we want to create a regression model, and it will just have to be patient because we don’t get to that until Unit 9! To tell R to run this analysis correctly, let’s tell it to treat block, pop, and spacing as the factors they are, rather than as integers.</p>
<p>We are going to use the “as.factor” command to tell R these variables are factors. We use the ominous sounding command “mutate” to change our variables.</p>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="multiple-treatment-designs.html#cb514-1"></a>corn_fixed =<span class="st"> </span>corn <span class="op">%&gt;%</span><span class="st">  </span><span class="co"># the &quot;%&gt;%&quot; tells R to take the corn dataset and use it in the next line of code</span></span>
<span id="cb514-2"><a href="multiple-treatment-designs.html#cb514-2"></a><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">block =</span> <span class="kw">as.factor</span>(block),  <span class="co"># mutate tells R to change the variables according to the formula given</span></span>
<span id="cb514-3"><a href="multiple-treatment-designs.html#cb514-3"></a>         <span class="dt">pop =</span> <span class="kw">as.factor</span>(pop),</span>
<span id="cb514-4"><a href="multiple-treatment-designs.html#cb514-4"></a>         <span class="dt">spacing =</span> <span class="kw">as.factor</span>(spacing))</span></code></pre></div>
<div id="anova-3" class="section level4">
<h4><span class="header-section-number">7.7.6.1</span> ANOVA</h4>
<p>Now, run your ANOVA on the new dataset, corn_fixed. The degrees of freedom will be correct. Your ANOVA output should look like:</p>
<pre><code>        Df Sum Sq Mean Sq F value   Pr(&gt;F)    </code></pre>
<p>block 3 18.791 6.264 12.841 5.53e-05 <strong><em>
pop 3 6.860 2.287 4.688 0.01169 </em><br />
spacing 1 5.550 5.550 11.379 0.00287 </strong>
<a href="pop:spacing" class="uri">pop:spacing</a> 3 4.609 1.536 3.150 0.04645 *<br />
Residuals 21 10.243 0.488</p>
<p>Signif. codes: 0 ‘<em><strong>’ 0.001 ‘</strong>’ 0.01 ‘</em>’ 0.05 ‘.’ 0.1 ‘ ’ 1</p>
</div>
<div id="test-factors-individually" class="section level4">
<h4><span class="header-section-number">7.7.6.2</span> Test Factors Individually</h4>
<p>Test the effect of spacing at each level of pop. Your results should look like:</p>
<p>pop term df sumsq meansq statistic p.value
<fct> <chr> <dbl> <dbl> <dbl> <dbl> <dbl>
1 94000 .<span class="math inline">\(block 3 2.20 0.733 5.93 0.0889  2 94000 .\)</span>spacing 1 0.336 0.336 2.72 0.198
3 94000 Residuals 3 0.371 0.124 NA NA<br />
4 109000 .<span class="math inline">\(block 3 6.00 2.00 1.74 0.330  5 109000 .\)</span>spacing 1 4.65 4.65 4.05 0.138
6 109000 Residuals 3 3.45 1.15 NA NA<br />
7 124000 .<span class="math inline">\(block 3 5.88 1.96 3.01 0.195  8 124000 .\)</span>spacing 1 3.72 3.72 5.71 0.0968
9 124000 Residuals 3 1.95 0.651 NA NA<br />
10 139000 .<span class="math inline">\(block 3 8.70 2.90 18.0 0.0201 11 139000 .\)</span>spacing 1 1.46 1.46 9.07 0.0571
12 139000 Residuals 3 0.482 0.161 NA NA</p>
<p>Test the effects of pop at each level of spacing. Your results should look like:</p>
<p>spacing term df sumsq meansq statistic p.value
<fct> <chr> <dbl> <dbl> <dbl> <dbl> <dbl>
1 51 .<span class="math inline">\(block 3 8.24 2.75 5.25 0.0228 2 51 .\)</span>pop 3 8.06 2.69 5.13 0.0243
3 51 Residuals 9 4.71 0.523 NA NA<br />
4 76 .<span class="math inline">\(block 3 11.3 3.76 7.03 0.00984 5 76 .\)</span>pop 3 3.41 1.14 2.13 0.167<br />
6 76 Residuals 9 4.81 0.534 NA NA</p>
</div>
</div>
</div>
<div id="exercise-split-plot-design" class="section level2">
<h2><span class="header-section-number">7.8</span> Exercise: Split-Plot Design</h2>
<p>The split-plot design is similar to the factorial design but, as we learned in the lecture, has two error terms: one for the main factor, and the second for the sub-factor. This requires we use different R code than for the factorial design.</p>
<div id="case-study-corn-soybean-systems-trial" class="section level3">
<h3><span class="header-section-number">7.8.1</span> Case Study: Corn-Soybean Systems Trial</h3>
<p>A cropping systems trial was conducted in Wisconsin to investigate the combined effects of tillage and in-furrow fungicide on soybean yield. This dataset was inspired by the following article, which is open-source:</p>
<p>Potratz, DJ, Mourtzinis, S, Gaska, J, Lauer, J, Arriaga, FJ, Conley, SP. Strip‐till, other management strategies, and their interactive effects on corn grain and soybean seed yield. Agronomy Journal. 2020; 112: 72– 80. <a href="https://doi.org/10.1002/agj2.20067" class="uri">https://doi.org/10.1002/agj2.20067</a></p>
<p>The trial was a split-plot design with two levels of tillage (no-till, NT, and strip-till, ST) as the main factor and two levels of fungicide (Fungicide and No Fungicide) as the sub-factor. There were four replications. Main factor levels were blocked.</p>
<div class="sourceCode" id="cb516"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb516-1"><a href="multiple-treatment-designs.html#cb516-1"></a><span class="kw">library</span>(tidyverse)</span>
<span id="cb516-2"><a href="multiple-treatment-designs.html#cb516-2"></a>soybean =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data-unit-7/exercise_data/tillage_fungicide_soybean.csv&quot;</span>)</span>
<span id="cb516-3"><a href="multiple-treatment-designs.html#cb516-3"></a><span class="kw">head</span>(soybean)</span></code></pre></div>
<pre><code>##   block tillage    fungicide    yield
## 1    B1      NT    Fungicide 3.698314
## 2    B1      NT No Fungicide 3.452027
## 3    B1      ST    Fungicide 4.059679
## 4    B1      ST No Fungicide 3.867225
## 5    B2      NT    Fungicide 4.045291
## 6    B2      NT No Fungicide 3.902678</code></pre>
</div>
<div id="anova-4" class="section level3">
<h3><span class="header-section-number">7.8.2</span> ANOVA</h3>
<p>Lets first construct our linear model:</p>
<p>Y = mu + T + Error(B + BT) + F + TF + Error(BF + BTF)</p>
<p>So our anova output should include include the effects of tillage (T), fungicide (F), and their interaction (TF). We also need to tell R to use the interaction of block and tillage to test the main factor tillage effect. We code this in R as follows.</p>
<div class="sourceCode" id="cb518"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb518-1"><a href="multiple-treatment-designs.html#cb518-1"></a>soybean_model =<span class="st"> </span><span class="kw">aov</span>(yield <span class="op">~</span><span class="st"> </span>tillage <span class="op">+</span><span class="st"> </span>fungicide <span class="op">+</span><span class="st"> </span>tillage<span class="op">:</span>fungicide <span class="op">+</span><span class="st"> </span><span class="kw">Error</span>(block<span class="op">:</span>tillage), <span class="dt">data=</span>soybean)</span></code></pre></div>
<pre><code>## Warning in aov(yield ~ tillage + fungicide + tillage:fungicide +
## Error(block:tillage), : Error() model is singular</code></pre>
<div class="sourceCode" id="cb520"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb520-1"><a href="multiple-treatment-designs.html#cb520-1"></a>soybean_model =<span class="st"> </span><span class="kw">with</span>(soybean, <span class="kw">sp.plot</span>(block, tillage, fungicide, yield))</span></code></pre></div>
<pre><code>## 
## ANALYSIS SPLIT PLOT:  yield 
## Class level information
## 
## tillage  :  NT ST 
## fungicide    :  Fungicide No Fungicide 
## block    :  B1 B2 B3 B4 
## 
## Number of observations:  16 
## 
## Analysis of Variance Table
## 
## Response: yield
##                   Df  Sum Sq Mean Sq F value   Pr(&gt;F)   
## block              3 2.17303 0.72434 90.9367 0.001920 **
## tillage            1 0.38181 0.38181 47.9344 0.006177 **
## Ea                 3 0.02390 0.00797                    
## fungicide          1 0.26756 0.26756 23.4352 0.002878 **
## tillage:fungicide  1 0.00017 0.00017  0.0147 0.907315   
## Eb                 6 0.06850 0.01142                    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## cv(a) = 2.1 %, cv(b) = 2.5 %, Mean = 4.289329</code></pre>
<p>Of particular note is the new “Error” term we have added. This tells R which error to use for testing the tillage effect.</p>
<p>The ANOVA output is created using the <em>summary()</em> function.</p>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="multiple-treatment-designs.html#cb522-1"></a><span class="kw">summary</span>(soybean_model)</span></code></pre></div>
<pre><code>##       Length Class  Mode   
## ANOVA 5      anova  list   
## gl.a  1      -none- numeric
## gl.b  1      -none- numeric
## Ea    1      -none- numeric
## Eb    1      -none- numeric</code></pre>
<p>As we saw in lecture, the ANOVA output for a split-plot experiment includes two tables. The top table tests the main factor effect. At the top of that table, it specifies we are using the block:tillage interaction as our error term. The bottom table tests the sub-factor effect and the interaction between the main factor and the sub-factor.</p>
<p>We can see tillage did not have an effect. Fungicide did affect yield.</p>
</div>
<div id="interaction-plot" class="section level3">
<h3><span class="header-section-number">7.8.3</span> Interaction Plot</h3>
<p>Although the interaction is not singificant, we can still draw a line plot to visualize the relationship between tillage and fungicide effects. First, we need to create a summary dataset with mean yields for the interactions of tillage and fugicide.</p>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="multiple-treatment-designs.html#cb524-1"></a>soybean_group =<span class="st"> </span>soybean <span class="op">%&gt;%</span><span class="st">    </span><span class="co"># build new dataframe, soybean_group, on summary of soybean dataframe</span></span>
<span id="cb524-2"><a href="multiple-treatment-designs.html#cb524-2"></a><span class="st">  </span><span class="kw">group_by</span>(tillage, fungicide) <span class="op">%&gt;%</span><span class="st">   </span><span class="co"># summarise based on interaction of tillage and fungicide</span></span>
<span id="cb524-3"><a href="multiple-treatment-designs.html#cb524-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">yield =</span> <span class="kw">mean</span>(yield)) <span class="op">%&gt;%</span><span class="st">   </span><span class="co"># summarise by means across replications</span></span>
<span id="cb524-4"><a href="multiple-treatment-designs.html#cb524-4"></a><span class="st">  </span><span class="kw">ungroup</span>()    <span class="co"># ungroup for further processing</span></span></code></pre></div>
<pre><code>## `summarise()` has grouped output by &#39;tillage&#39;. You can override using the `.groups` argument.</code></pre>
<p>Then we create our line plot. We can start the plot with the ggplot() function. The aes() argument tells R to position the data points according to their tillage level and yield. It also tells R to group the points by fungicide level.</p>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="multiple-treatment-designs.html#cb526-1"></a>soybean_group <span class="op">%&gt;%</span></span>
<span id="cb526-2"><a href="multiple-treatment-designs.html#cb526-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>tillage, <span class="dt">y=</span>yield, <span class="dt">group=</span>fungicide))</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-62-1.png" width="672" /></p>
<p>Next we add line geometries to our plot using geom_line(). We use another aes() argument to tell R to differentiate line color by level of fungicide.</p>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="multiple-treatment-designs.html#cb527-1"></a>soybean_group <span class="op">%&gt;%</span></span>
<span id="cb527-2"><a href="multiple-treatment-designs.html#cb527-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>tillage, <span class="dt">y=</span>yield, <span class="dt">group=</span>fungicide)) <span class="op">+</span></span>
<span id="cb527-3"><a href="multiple-treatment-designs.html#cb527-3"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="kw">aes</span>(<span class="dt">color=</span>fungicide))</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-63-1.png" width="672" /></p>
</div>
<div id="bar-plot" class="section level3">
<h3><span class="header-section-number">7.8.4</span> Bar plot</h3>
<p>We can create a bar plot just as we did for the factorial trial.</p>
<p>First, we tell ggplot with the aes() argument to position the bars according to their tillage level and their yield, and to group means with the same fungicide level together so they are the same color.</p>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="multiple-treatment-designs.html#cb528-1"></a>soybean <span class="op">%&gt;%</span></span>
<span id="cb528-2"><a href="multiple-treatment-designs.html#cb528-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>tillage, <span class="dt">y=</span>yield, <span class="dt">group=</span>fungicide))</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<p>Then we add our geometry with the geom_bar() argument. We will add an aes() argument to tell R that bar color should be matched to fungicide level. We also need to use the <em>stat=“summary”</em> argument that the statistic to be plotted is a summary statistic to be calculated. The we need to tell it with <em>fun=“mean”</em> that the statistic to be calculated is the mean.</p>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="multiple-treatment-designs.html#cb529-1"></a>soybean <span class="op">%&gt;%</span></span>
<span id="cb529-2"><a href="multiple-treatment-designs.html#cb529-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>tillage, <span class="dt">y=</span>yield, <span class="dt">group=</span>fungicide)) <span class="op">+</span></span>
<span id="cb529-3"><a href="multiple-treatment-designs.html#cb529-3"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">fill=</span>fungicide), <span class="dt">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="dt">fun=</span><span class="st">&quot;mean&quot;</span>)</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-65-1.png" width="672" /></p>
<p>Whoops! We need to add a final argument to geom_bar(), to tell it to plot the two levels of fungicide next to each other, instead of stacking them. We add <em>position=“dodge”</em> accordingly.</p>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="multiple-treatment-designs.html#cb530-1"></a>soybean <span class="op">%&gt;%</span></span>
<span id="cb530-2"><a href="multiple-treatment-designs.html#cb530-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>tillage, <span class="dt">y=</span>yield, <span class="dt">group=</span>fungicide)) <span class="op">+</span></span>
<span id="cb530-3"><a href="multiple-treatment-designs.html#cb530-3"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">fill=</span>fungicide), <span class="dt">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="dt">fun=</span><span class="st">&quot;mean&quot;</span>, <span class="dt">position=</span><span class="st">&quot;dodge&quot;</span>)</span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-66-1.png" width="672" /></p>
<p>Finally, if we want, we can add a couple of theme() arguments to increase the font size of the axis titles and labels.</p>
<div class="sourceCode" id="cb531"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb531-1"><a href="multiple-treatment-designs.html#cb531-1"></a>soybean <span class="op">%&gt;%</span></span>
<span id="cb531-2"><a href="multiple-treatment-designs.html#cb531-2"></a><span class="st">  </span><span class="kw">ggplot</span>(<span class="kw">aes</span>(<span class="dt">x=</span>tillage, <span class="dt">y=</span>yield, <span class="dt">group=</span>fungicide)) <span class="op">+</span></span>
<span id="cb531-3"><a href="multiple-treatment-designs.html#cb531-3"></a><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">fill=</span>fungicide), <span class="dt">stat =</span> <span class="st">&quot;summary&quot;</span>, <span class="dt">fun=</span><span class="st">&quot;mean&quot;</span>, <span class="dt">position=</span><span class="st">&quot;dodge&quot;</span>) <span class="op">+</span></span>
<span id="cb531-4"><a href="multiple-treatment-designs.html#cb531-4"></a><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.title =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">18</span>),</span>
<span id="cb531-5"><a href="multiple-treatment-designs.html#cb531-5"></a>        <span class="dt">axis.text =</span> <span class="kw">element_text</span>(<span class="dt">size=</span><span class="dv">14</span>))  <span class="co"># element_text() tells R we are modifying the font, as opposed to the position of the axis title</span></span></code></pre></div>
<p><img src="07-Multiple-Treatment-Designs_files/figure-html/unnamed-chunk-67-1.png" width="672" /></p>
</div>
<div id="practice-8" class="section level3">
<h3><span class="header-section-number">7.8.5</span> Practice</h3>
<p>The same study above produced a corn dataset. The main factor was rotation and the sub-factor was fungicide.</p>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="multiple-treatment-designs.html#cb532-1"></a>corn =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data-unit-7/exercise_data/rotation_fungicide_corn.csv&quot;</span>)</span>
<span id="cb532-2"><a href="multiple-treatment-designs.html#cb532-2"></a><span class="kw">head</span>(corn)</span></code></pre></div>
<pre><code>##   block rotation    fungicide    yield
## 1    B1       CS    Fungicide 12.95823
## 2    B1       CS No Fungicide 12.40752
## 3    B1       CC    Fungicide 11.49778
## 4    B1       CC No Fungicide 11.60836
## 5    B2       CS    Fungicide 14.19937
## 6    B2       CS No Fungicide 13.69898</code></pre>
<div id="anova-5" class="section level4">
<h4><span class="header-section-number">7.8.5.1</span> ANOVA</h4>
<p>Create an analysis of variance for the data above. Your results should look like:</p>
<p>Error: block:rotation
Df Sum Sq Mean Sq F value Pr(&gt;F)
rotation 1 4.99 4.987 0.896 0.38
Residuals 6 33.39 5.565</p>
<p>Error: Within
Df Sum Sq Mean Sq F value Pr(&gt;F)<br />
fungicide 1 0.1309 0.1309 64.19 0.000202 <strong><em>
rotation:fungicide 1 0.3492 0.3492 171.19 1.23e-05 </em></strong>
Residuals 6 0.0122 0.0020</p>
<p>Signif. codes: 0 ‘<em><strong>’ 0.001 ‘</strong>’ 0.01 ‘</em>’ 0.05 ‘.’ 0.1 ‘ ’ 1</p>
</div>
<div id="test-factors-individually-1" class="section level4">
<h4><span class="header-section-number">7.8.5.2</span> Test Factors Individually</h4>
<p>First, test the effect of rotation at each level of fungicide. Your results should look like:</p>
<p>fungicide term df sumsq meansq statistic p.value
<fct> <chr> <dbl> <dbl> <dbl> <dbl> <dbl>
1 Fungicide .<span class="math inline">\(block 3 16.6 5.52 6385. 0.00000333 2 Fungicide .\)</span>rotation 1 3.99 3.99 4612. 0.00000703
3 Fungicide Residuals 3 0.00259 0.000865 NA NA<br />
4 No Fungicide .<span class="math inline">\(block 3 16.8 5.61 6068. 0.00000359 5 No Fungicide .\)</span>rotation 1 1.35 1.35 1458. 0.0000395
6 No Fungicide Residuals 3 0.00277 0.000925 NA NA</p>
<p>Second, test the effect of fungicide at each level of rotation. Your results should look like:</p>
<p>rotation term df sumsq meansq statistic p.value
<fct> <chr> <dbl> <dbl> <dbl> <dbl> <dbl>
1 CC .<span class="math inline">\(block 3 16.7 5.58 4075. 0.00000652 2 CC .\)</span>fungicide 1 0.0262 0.0262 19.2 0.0220<br />
3 CC Residuals 3 0.00410 0.00137 NA NA<br />
4 CS .<span class="math inline">\(block 3 16.7 5.56 2049. 0.0000183 5 CS .\)</span>fungicide 1 0.454 0.454 167. 0.000997<br />
6 CS Residuals 3 0.00814 0.00271 NA NA</p>
</div>
<div id="create-a-line-plot-to-view-the-interaction-between-rotation-and-fungicide." class="section level4">
<h4><span class="header-section-number">7.8.5.3</span> Create a line plot to view the interaction between rotation and fungicide.</h4>
</div>
</div>
</div>
<div id="exercise-experimental-design" class="section level2">
<h2><span class="header-section-number">7.9</span> Exercise: Experimental Design</h2>
<p>Now that you have been introoduced to four powerful experimental designs – completely randomized, randomized complete block, factorial, and split-plot, how can you use R to create your plot layout and randomize your treatments?</p>
<p>Of course, R has a package for that. We will use the <em>agricolae()</em> packages and its multiple tools for experimental design.</p>
<div id="completely-randomized-design" class="section level3">
<h3><span class="header-section-number">7.9.1</span> Completely Randomized Design</h3>
<p>We have a hemp trial with five varieties: “China Cat”, “Eyes”, “Scarlet”, “Fire”, and “Tower”. How do we randomize it? We use the <em>design.crd()</em> function.</p>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="multiple-treatment-designs.html#cb534-1"></a><span class="kw">library</span>(agricolae)</span>
<span id="cb534-2"><a href="multiple-treatment-designs.html#cb534-2"></a></span>
<span id="cb534-3"><a href="multiple-treatment-designs.html#cb534-3"></a><span class="co"># First, we need to define the varieties as a vector:</span></span>
<span id="cb534-4"><a href="multiple-treatment-designs.html#cb534-4"></a>varieties =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;China Cat&quot;</span>, <span class="st">&quot;Eyes&quot;</span>, <span class="st">&quot;Scarlet&quot;</span>, <span class="st">&quot;Fire&quot;</span>, <span class="st">&quot;Tower&quot;</span>)</span>
<span id="cb534-5"><a href="multiple-treatment-designs.html#cb534-5"></a></span>
<span id="cb534-6"><a href="multiple-treatment-designs.html#cb534-6"></a><span class="co"># Then we define the number of replications we want:</span></span>
<span id="cb534-7"><a href="multiple-treatment-designs.html#cb534-7"></a>reps =<span class="st"> </span><span class="dv">6</span></span>
<span id="cb534-8"><a href="multiple-treatment-designs.html#cb534-8"></a></span>
<span id="cb534-9"><a href="multiple-treatment-designs.html#cb534-9"></a><span class="co"># One more thing we can do is provide a &quot;seed&quot;.  A seed tells R where to start in randomizing the plot.  This is often useful in case we need to recreate a set of random numbers.  In case we need to recreate this plot map from scratch, we will provide a seed.</span></span>
<span id="cb534-10"><a href="multiple-treatment-designs.html#cb534-10"></a>seed_no =<span class="st"> </span><span class="dv">910</span></span>
<span id="cb534-11"><a href="multiple-treatment-designs.html#cb534-11"></a></span>
<span id="cb534-12"><a href="multiple-treatment-designs.html#cb534-12"></a></span>
<span id="cb534-13"><a href="multiple-treatment-designs.html#cb534-13"></a><span class="co"># then we just feed these to the design.crd argument</span></span>
<span id="cb534-14"><a href="multiple-treatment-designs.html#cb534-14"></a>crd =<span class="st"> </span><span class="kw">design.crd</span>(<span class="dt">trt=</span>varieties, <span class="dt">r=</span>reps, <span class="dt">seed =</span> seed_no)</span></code></pre></div>
<p>design.crd outputs a list (a collection of R objects). To view the treatment assignments in our new plot plan, “crd”, we add “$book” to the end of it.</p>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="multiple-treatment-designs.html#cb535-1"></a>crd<span class="op">$</span>book</span></code></pre></div>
<pre><code>##    plots r varieties
## 1    101 1      Fire
## 2    102 1      Eyes
## 3    103 2      Eyes
## 4    104 1   Scarlet
## 5    105 2   Scarlet
## 6    106 2      Fire
## 7    107 3      Eyes
## 8    108 3      Fire
## 9    109 4      Eyes
## 10   110 1     Tower
## 11   111 4      Fire
## 12   112 2     Tower
## 13   113 5      Fire
## 14   114 1 China Cat
## 15   115 5      Eyes
## 16   116 2 China Cat
## 17   117 3 China Cat
## 18   118 3   Scarlet
## 19   119 3     Tower
## 20   120 4   Scarlet
## 21   121 4     Tower
## 22   122 6      Eyes
## 23   123 6      Fire
## 24   124 5     Tower
## 25   125 5   Scarlet
## 26   126 4 China Cat
## 27   127 6     Tower
## 28   128 5 China Cat
## 29   129 6 China Cat
## 30   130 6   Scarlet</code></pre>
</div>
<div id="randomized-complete-block-design-1" class="section level3">
<h3><span class="header-section-number">7.9.2</span> Randomized Complete Block Design</h3>
<p>What if we want to block our treatments? For this, we use the <em>design.rcbd()</em> function. The values we feed to it will be identical to the completely randomized design above.</p>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="multiple-treatment-designs.html#cb537-1"></a><span class="co"># First, we need to define the varieties as a vector:</span></span>
<span id="cb537-2"><a href="multiple-treatment-designs.html#cb537-2"></a>varieties =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;China Cat&quot;</span>, <span class="st">&quot;Eyes&quot;</span>, <span class="st">&quot;Scarlet&quot;</span>, <span class="st">&quot;Fire&quot;</span>, <span class="st">&quot;Tower&quot;</span>)</span>
<span id="cb537-3"><a href="multiple-treatment-designs.html#cb537-3"></a></span>
<span id="cb537-4"><a href="multiple-treatment-designs.html#cb537-4"></a><span class="co"># Then we define the number of replications we want:</span></span>
<span id="cb537-5"><a href="multiple-treatment-designs.html#cb537-5"></a>reps =<span class="st"> </span><span class="dv">6</span></span>
<span id="cb537-6"><a href="multiple-treatment-designs.html#cb537-6"></a></span>
<span id="cb537-7"><a href="multiple-treatment-designs.html#cb537-7"></a><span class="co"># One more thing we can do is provide a &quot;seed&quot;.  A seed tells R where to start in randomizing the plot.  This is often useful in case we need to recreate a set of random numbers.  In case we need to recreate this plot map from scratch, we will provide a seed.</span></span>
<span id="cb537-8"><a href="multiple-treatment-designs.html#cb537-8"></a>seed_no =<span class="st"> </span><span class="dv">910</span></span>
<span id="cb537-9"><a href="multiple-treatment-designs.html#cb537-9"></a></span>
<span id="cb537-10"><a href="multiple-treatment-designs.html#cb537-10"></a>rcbd =<span class="st"> </span><span class="kw">design.rcbd</span>(<span class="dt">trt =</span> varieties, <span class="dt">r=</span>reps, <span class="dt">seed =</span> seed_no)</span></code></pre></div>
<p>We can review our treatment assignments using “rcbd$book”.</p>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="multiple-treatment-designs.html#cb538-1"></a>rcbd<span class="op">$</span>book</span></code></pre></div>
<pre><code>##    plots block varieties
## 1    101     1 China Cat
## 2    102     1      Fire
## 3    103     1   Scarlet
## 4    104     1      Eyes
## 5    105     1     Tower
## 6    201     2      Fire
## 7    202     2      Eyes
## 8    203     2     Tower
## 9    204     2   Scarlet
## 10   205     2 China Cat
## 11   301     3      Fire
## 12   302     3 China Cat
## 13   303     3   Scarlet
## 14   304     3     Tower
## 15   305     3      Eyes
## 16   401     4      Fire
## 17   402     4   Scarlet
## 18   403     4 China Cat
## 19   404     4      Eyes
## 20   405     4     Tower
## 21   501     5 China Cat
## 22   502     5   Scarlet
## 23   503     5     Tower
## 24   504     5      Eyes
## 25   505     5      Fire
## 26   601     6     Tower
## 27   602     6   Scarlet
## 28   603     6      Fire
## 29   604     6      Eyes
## 30   605     6 China Cat</code></pre>
<p>We can save this data.frame to our local directory – for use in our spreadsheet – using the <em>write.csv()</em> function.</p>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="multiple-treatment-designs.html#cb540-1"></a><span class="co"># the write.csv arguments are (name of data.frame, filename, row.names=FALSE)</span></span>
<span id="cb540-2"><a href="multiple-treatment-designs.html#cb540-2"></a><span class="kw">write.csv</span>(rcbd<span class="op">$</span>book, <span class="st">&quot;field_book.csv&quot;</span>, <span class="dt">row.names =</span> <span class="ot">FALSE</span>)</span></code></pre></div>
</div>
<div id="factorial-design-1" class="section level3">
<h3><span class="header-section-number">7.9.3</span> Factorial Design</h3>
<p>We use the <em>design.ab()</em> function to create our plot layout.</p>
<p>The factorial experimental design is slightly different. We cannot give R named treatments. We can only tell it how many treatments are in each factor. Let’s say we wanted to run a factorial experiment with three levels of hemp variety and two levels of soil amdendments. We would call this a “3 x 2” factorial.</p>
<p>One additonal change is we can tell R whether to arrange our treatments in a completely randomized design or a randomized complete block design. We will use the <em>design = “rcbd”</em> argment to tell R to create a randomized complete block design. (If we wanted to create a completely randomized design, we would use <em>design=“crd”</em> instead</p>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="multiple-treatment-designs.html#cb541-1"></a><span class="co"># the line below tells R that we have three levels of the first factor and two levels of the second factor.</span></span>
<span id="cb541-2"><a href="multiple-treatment-designs.html#cb541-2"></a>factors =<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb541-3"><a href="multiple-treatment-designs.html#cb541-3"></a>reps =<span class="st"> </span><span class="dv">4</span></span>
<span id="cb541-4"><a href="multiple-treatment-designs.html#cb541-4"></a>seed_no=<span class="dv">910</span></span>
<span id="cb541-5"><a href="multiple-treatment-designs.html#cb541-5"></a></span>
<span id="cb541-6"><a href="multiple-treatment-designs.html#cb541-6"></a>fact =<span class="st"> </span><span class="kw">design.ab</span>(<span class="dt">trt =</span> factors, <span class="dt">r =</span> reps, <span class="dt">seed =</span> seed_no, <span class="dt">design =</span> <span class="st">&quot;rcbd&quot;</span>)</span></code></pre></div>
<p>We can again review our treatment assignments by using <em>$book</em>.</p>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="multiple-treatment-designs.html#cb542-1"></a>fact<span class="op">$</span>book</span></code></pre></div>
<pre><code>##    plots block A B
## 1    101     1 1 1
## 2    102     1 2 1
## 3    103     1 1 2
## 4    104     1 2 2
## 5    105     1 3 1
## 6    106     1 3 2
## 7    107     2 2 2
## 8    108     2 1 1
## 9    109     2 2 1
## 10   110     2 3 1
## 11   111     2 3 2
## 12   112     2 1 2
## 13   113     3 2 2
## 14   114     3 1 1
## 15   115     3 1 2
## 16   116     3 3 1
## 17   117     3 2 1
## 18   118     3 3 2
## 19   119     4 2 2
## 20   120     4 3 1
## 21   121     4 2 1
## 22   122     4 3 2
## 23   123     4 1 2
## 24   124     4 1 1</code></pre>
</div>
<div id="split-plot-design-1" class="section level3">
<h3><span class="header-section-number">7.9.4</span> Split-Plot Design</h3>
<p>Lets say we are going to use equipment to spread our compost. The applicator creates a 6-meter swath, while our three varieties are being grown in plots 2 meters wide. We deside to conduct a split plot trial with soil amendment as our main factor and variety as our sub-factor.</p>
<p>For the split plot design, will define the levels of our two factors, varieties and amendments, by name</p>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="multiple-treatment-designs.html#cb544-1"></a><span class="co"># First, we need to define the varieties as a vector:</span></span>
<span id="cb544-2"><a href="multiple-treatment-designs.html#cb544-2"></a>varieties =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Eyes&quot;</span>, <span class="st">&quot;Scarlet&quot;</span>, <span class="st">&quot;Fire&quot;</span>)</span>
<span id="cb544-3"><a href="multiple-treatment-designs.html#cb544-3"></a></span>
<span id="cb544-4"><a href="multiple-treatment-designs.html#cb544-4"></a><span class="co"># Second, we define our amendment treatments</span></span>
<span id="cb544-5"><a href="multiple-treatment-designs.html#cb544-5"></a>amendments =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;compost&quot;</span>)</span>
<span id="cb544-6"><a href="multiple-treatment-designs.html#cb544-6"></a><span class="co"># </span></span>
<span id="cb544-7"><a href="multiple-treatment-designs.html#cb544-7"></a><span class="co"># Then we define the number of replications we want:</span></span>
<span id="cb544-8"><a href="multiple-treatment-designs.html#cb544-8"></a>reps =<span class="st"> </span><span class="dv">4</span></span>
<span id="cb544-9"><a href="multiple-treatment-designs.html#cb544-9"></a></span>
<span id="cb544-10"><a href="multiple-treatment-designs.html#cb544-10"></a><span class="co"># One more thing we can do is provide a &quot;seed&quot;.  A seed tells R where to start in randomizing the plot.  This is often useful in case we need to recreate a set of random numbers.  In case we need to recreate this plot map from scratch, we will provide a seed.</span></span>
<span id="cb544-11"><a href="multiple-treatment-designs.html#cb544-11"></a>seed_no =<span class="st"> </span><span class="dv">910</span></span>
<span id="cb544-12"><a href="multiple-treatment-designs.html#cb544-12"></a></span>
<span id="cb544-13"><a href="multiple-treatment-designs.html#cb544-13"></a><span class="co"># The design.split() function is similar to the factorial design.ab function above.  The main difference is we now define a &quot;trt1&quot; and a &quot;trt2&quot;.  trt1 is the factor you want in the main plots; trt2 is the factor you want in the subplots.  The other arguments are the same.</span></span>
<span id="cb544-14"><a href="multiple-treatment-designs.html#cb544-14"></a><span class="co"># </span></span>
<span id="cb544-15"><a href="multiple-treatment-designs.html#cb544-15"></a>spdesign =<span class="st"> </span><span class="kw">design.split</span>(<span class="dt">trt1 =</span> amendments, <span class="dt">trt2 =</span> varieties, <span class="dt">r=</span><span class="dv">4</span>, <span class="dt">seed =</span> seed_no, <span class="dt">design =</span> <span class="st">&quot;rcbd&quot;</span>)</span></code></pre></div>
<p>Our treatment assignments are below:</p>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="multiple-treatment-designs.html#cb545-1"></a>spdesign<span class="op">$</span>book</span></code></pre></div>
<pre><code>##    plots splots block amendments varieties
## 1    101      1     1    control   Scarlet
## 2    101      2     1    control      Eyes
## 3    101      3     1    control      Fire
## 4    102      1     1    compost      Eyes
## 5    102      2     1    compost      Fire
## 6    102      3     1    compost   Scarlet
## 7    103      1     2    control      Fire
## 8    103      2     2    control      Eyes
## 9    103      3     2    control   Scarlet
## 10   104      1     2    compost      Fire
## 11   104      2     2    compost      Eyes
## 12   104      3     2    compost   Scarlet
## 13   105      1     3    compost      Eyes
## 14   105      2     3    compost      Fire
## 15   105      3     3    compost   Scarlet
## 16   106      1     3    control      Eyes
## 17   106      2     3    control      Fire
## 18   106      3     3    control   Scarlet
## 19   107      1     4    compost   Scarlet
## 20   107      2     4    compost      Fire
## 21   107      3     4    compost      Eyes
## 22   108      1     4    control      Fire
## 23   108      2     4    control   Scarlet
## 24   108      3     4    control      Eyes</code></pre>
</div>
<div id="practice-9" class="section level3">
<h3><span class="header-section-number">7.9.5</span> Practice</h3>
<p>We now have a new hemp trial comparing varieties “Chicago”, “New York”, and “Detroit”. The critics say they’re all on the same “street” (whatever), but we would like to compare them.</p>
<div id="completely-randomized-design-1" class="section level4">
<h4><span class="header-section-number">7.9.5.1</span> Completely Randomized Design</h4>
<p>Create a completely randomized design with 4 replicates. Please use seed_no=123 so our results will match.</p>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="multiple-treatment-designs.html#cb547-1"></a>varieties =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Chicago&quot;</span>, <span class="st">&quot;New York&quot;</span>, <span class="st">&quot;Detroit&quot;</span>)</span>
<span id="cb547-2"><a href="multiple-treatment-designs.html#cb547-2"></a>reps=<span class="dv">4</span></span>
<span id="cb547-3"><a href="multiple-treatment-designs.html#cb547-3"></a>seed_no=<span class="dv">123</span></span></code></pre></div>
<p>Your plan should look like:</p>
<p>plots r varieties
1 101 1 New York
2 102 1 Detroit
3 103 1 Chicago
4 104 2 Chicago
5 105 2 Detroit
6 106 3 Chicago
7 107 3 Detroit
8 108 2 New York
9 109 4 Detroit
10 110 3 New York
11 111 4 Chicago
12 112 4 New York</p>
</div>
<div id="randomized-complete-block-design-2" class="section level4">
<h4><span class="header-section-number">7.9.5.2</span> Randomized Complete Block Design</h4>
<p>Create a randomized complete block design using the same three varieties as above. Please again use seed_no=123 so our results will match.</p>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="multiple-treatment-designs.html#cb548-1"></a>varieties =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Chicago&quot;</span>, <span class="st">&quot;New York&quot;</span>, <span class="st">&quot;Detroit&quot;</span>)</span>
<span id="cb548-2"><a href="multiple-treatment-designs.html#cb548-2"></a>reps=<span class="dv">4</span></span>
<span id="cb548-3"><a href="multiple-treatment-designs.html#cb548-3"></a>seed_no=<span class="dv">123</span></span></code></pre></div>
<p>Your plan should look like:</p>
<p>plots block varieties
1 101 1 Detroit
2 102 1 Chicago
3 103 1 New York
4 201 2 Detroit
5 202 2 Chicago
6 203 2 New York
7 301 3 New York
8 302 3 Chicago
9 303 3 Detroit
10 401 4 New York
11 402 4 Detroit
12 403 4 Chicago</p>
</div>
<div id="factorial-design-2" class="section level4">
<h4><span class="header-section-number">7.9.5.3</span> Factorial Design</h4>
<p>Now lets take our 3 levels of hemp variety and treat each with two levels of foliar spray (control and kelp). We will arrange our treatments in blocked (design=“rcbd”) factorial design. We will use 2 reps (only to keep our practice data set small – more reps would be better!). Please again use seed_no=123</p>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="multiple-treatment-designs.html#cb549-1"></a>factors =<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">2</span>)</span>
<span id="cb549-2"><a href="multiple-treatment-designs.html#cb549-2"></a>reps=<span class="dv">2</span></span>
<span id="cb549-3"><a href="multiple-treatment-designs.html#cb549-3"></a>seed_no=<span class="dv">123</span></span></code></pre></div>
<p>Your results should look like:
plots block A B
1 101 1 1 1
2 102 1 3 2
3 103 1 2 2
4 104 1 1 2
5 105 1 3 1
6 106 1 2 1
7 107 2 2 2
8 108 2 1 2
9 109 2 3 2
10 110 2 1 1
11 111 2 3 1
12 112 2 2 1</p>
</div>
<div id="split-plot-design-2" class="section level4">
<h4><span class="header-section-number">7.9.5.4</span> Split Plot Design</h4>
<p>Now lets suppose we had a 9-meter spray boom and variety plots that were 3-meters wide. Lets design a split plot trial with foliar spray as the main factor and hemp variety as the subfactor. We will block the main plots (design=“rcbd”). Please again use seed_no=123 and fill in the remaining code.</p>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="multiple-treatment-designs.html#cb550-1"></a>varieties =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Chicago&quot;</span>, <span class="st">&quot;New York&quot;</span>, <span class="st">&quot;Detroit&quot;</span>)</span>
<span id="cb550-2"><a href="multiple-treatment-designs.html#cb550-2"></a>foliar =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;kelp&quot;</span>)</span>
<span id="cb550-3"><a href="multiple-treatment-designs.html#cb550-3"></a>reps=<span class="dv">2</span></span>
<span id="cb550-4"><a href="multiple-treatment-designs.html#cb550-4"></a>seed_no=<span class="dv">123</span></span></code></pre></div>
<p>Your results should look like:</p>
<p>plots splots block foliar varieties
1 101 1 1 control Chicago
2 101 2 1 control New York
3 101 3 1 control Detroit
4 102 1 1 kelp New York
5 102 2 1 kelp Chicago
6 102 3 1 kelp Detroit
7 103 1 2 control New York
8 103 2 2 control Detroit
9 103 3 2 control Chicago
10 104 1 2 kelp New York
11 104 2 2 kelp Chicago
12 104 3 2 kelp Detroit</p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="multiple-treatment-trials.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="means-separation-and-data-presentation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-start.pdf", "bookdown-start.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
