<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 9 Messy and Missing Data | Data Science for Agricultural Professionals</title>
  <meta name="description" content="Practical statistics for those involved in agronomy and related agricultural sciences." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 9 Messy and Missing Data | Data Science for Agricultural Professionals" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="https://mharbur.github.io/data-science-for-agricultural-professionals/" />
  
  <meta property="og:description" content="Practical statistics for those involved in agronomy and related agricultural sciences." />
  <meta name="github-repo" content="https://github.com/mharbur/data-science-for-agricultural-professionals" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 9 Messy and Missing Data | Data Science for Agricultural Professionals" />
  
  <meta name="twitter:description" content="Practical statistics for those involved in agronomy and related agricultural sciences." />
  

<meta name="author" content="Marin L. Harbur" />


<meta name="date" content="2021-06-30" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="means-separation-and-data-presentation.html"/>
<link rel="next" href="correlation-and-simple-regression.html"/>
<script src="libs/header-attrs-2.7/header-attrs.js"></script>
<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.3/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>
<link href="libs/leaflet-1.3.1/leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-1.3.1/leaflet.js"></script>
<link href="libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet" />
<script src="libs/proj4-2.6.2/proj4.min.js"></script>
<script src="libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet" />
<script src="libs/leaflet-binding-2.0.4.1/leaflet.js"></script>
<script src="libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="libs/leaflet-providers-plugin-2.0.4.1/leaflet-providers-plugin.js"></script>
<script src="libs/stars-1/data_stars_stars7025ba.txt"></script>
<script src="libs/joda-0.0.1/joda.js"></script>
<script src="libs/joda-0.0.1/addImageQuery-bindings.js"></script>
<script src="libs/kePrint-0.0.1/kePrint.js"></script>
<link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Bookdown Book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#welcome"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#r-language"><i class="fa fa-check"></i>R-language</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="population-statistics.html"><a href="population-statistics.html"><i class="fa fa-check"></i><b>1</b> Population Statistics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="population-statistics.html"><a href="population-statistics.html#populations"><i class="fa fa-check"></i><b>1.1</b> Populations</a></li>
<li class="chapter" data-level="1.2" data-path="population-statistics.html"><a href="population-statistics.html#case-study-yield-map"><i class="fa fa-check"></i><b>1.2</b> Case Study: Yield Map</a></li>
<li class="chapter" data-level="1.3" data-path="population-statistics.html"><a href="population-statistics.html#distributions"><i class="fa fa-check"></i><b>1.3</b> Distributions</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="population-statistics.html"><a href="population-statistics.html#histograms"><i class="fa fa-check"></i><b>1.3.1</b> Histograms</a></li>
<li class="chapter" data-level="1.3.2" data-path="population-statistics.html"><a href="population-statistics.html#percentiles"><i class="fa fa-check"></i><b>1.3.2</b> Percentiles</a></li>
<li class="chapter" data-level="1.3.3" data-path="population-statistics.html"><a href="population-statistics.html#normal-distribution-model"><i class="fa fa-check"></i><b>1.3.3</b> Normal Distribution Model</a></li>
<li class="chapter" data-level="1.3.4" data-path="population-statistics.html"><a href="population-statistics.html#measures-of-center"><i class="fa fa-check"></i><b>1.3.4</b> Measures of Center</a></li>
<li class="chapter" data-level="1.3.5" data-path="population-statistics.html"><a href="population-statistics.html#measures-of-dispersion"><i class="fa fa-check"></i><b>1.3.5</b> Measures of Dispersion</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="population-statistics.html"><a href="population-statistics.html#exercise-introduction-to-r"><i class="fa fa-check"></i><b>1.4</b> Exercise: Introduction to R</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="population-statistics.html"><a href="population-statistics.html#your-very-first-code"><i class="fa fa-check"></i><b>1.4.1</b> Your Very First Code</a></li>
<li class="chapter" data-level="1.4.2" data-path="population-statistics.html"><a href="population-statistics.html#reading-and-working-with-data-frames"><i class="fa fa-check"></i><b>1.4.2</b> Reading and Working with Data Frames</a></li>
<li class="chapter" data-level="1.4.3" data-path="population-statistics.html"><a href="population-statistics.html#basic-operations-on-columns"><i class="fa fa-check"></i><b>1.4.3</b> Basic Operations on Columns</a></li>
<li class="chapter" data-level="1.4.4" data-path="population-statistics.html"><a href="population-statistics.html#knitting-your-results-into-a-document"><i class="fa fa-check"></i><b>1.4.4</b> Knitting Your Results into a Document</a></li>
<li class="chapter" data-level="1.4.5" data-path="population-statistics.html"><a href="population-statistics.html#practice"><i class="fa fa-check"></i><b>1.4.5</b> Practice</a></li>
</ul></li>
<li class="chapter" data-level="1.5" data-path="population-statistics.html"><a href="population-statistics.html#exercise-introduction-to-shapefiles"><i class="fa fa-check"></i><b>1.5</b> Exercise: Introduction to Shapefiles</a>
<ul>
<li class="chapter" data-level="1.5.1" data-path="population-statistics.html"><a href="population-statistics.html#r-packages"><i class="fa fa-check"></i><b>1.5.1</b> R Packages</a></li>
<li class="chapter" data-level="1.5.2" data-path="population-statistics.html"><a href="population-statistics.html#reading-shapefiles"><i class="fa fa-check"></i><b>1.5.2</b> Reading Shapefiles</a></li>
<li class="chapter" data-level="1.5.3" data-path="population-statistics.html"><a href="population-statistics.html#examining-spatial-feature-data-frames"><i class="fa fa-check"></i><b>1.5.3</b> Examining Spatial Feature Data Frames</a></li>
<li class="chapter" data-level="1.5.4" data-path="population-statistics.html"><a href="population-statistics.html#visualizing-data"><i class="fa fa-check"></i><b>1.5.4</b> Visualizing Data</a></li>
<li class="chapter" data-level="1.5.5" data-path="population-statistics.html"><a href="population-statistics.html#create-your-own-maps"><i class="fa fa-check"></i><b>1.5.5</b> Create Your Own Maps</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="population-statistics.html"><a href="population-statistics.html#exercise-histograms"><i class="fa fa-check"></i><b>1.6</b> Exercise: Histograms</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="population-statistics.html"><a href="population-statistics.html#case-study"><i class="fa fa-check"></i><b>1.6.1</b> Case Study</a></li>
<li class="chapter" data-level="1.6.2" data-path="population-statistics.html"><a href="population-statistics.html#basic-histogram"><i class="fa fa-check"></i><b>1.6.2</b> Basic Histogram</a></li>
<li class="chapter" data-level="1.6.3" data-path="population-statistics.html"><a href="population-statistics.html#histograms-with-ggplot"><i class="fa fa-check"></i><b>1.6.3</b> Histograms with ggplot</a></li>
<li class="chapter" data-level="1.6.4" data-path="population-statistics.html"><a href="population-statistics.html#practice-1"><i class="fa fa-check"></i><b>1.6.4</b> Practice</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html"><i class="fa fa-check"></i><b>2</b> Distributions and Probability</a>
<ul>
<li class="chapter" data-level="2.1" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#case-study-1"><i class="fa fa-check"></i><b>2.1</b> Case Study</a></li>
<li class="chapter" data-level="2.2" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#the-normal-distribution-model"><i class="fa fa-check"></i><b>2.2</b> The Normal Distribution Model</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#the-bell-curve"><i class="fa fa-check"></i><b>2.2.1</b> The Bell Curve</a></li>
<li class="chapter" data-level="2.2.2" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#distribution-and-probability"><i class="fa fa-check"></i><b>2.2.2</b> Distribution and Probability</a></li>
<li class="chapter" data-level="2.2.3" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#probability-and-the-normal-distribution-curve"><i class="fa fa-check"></i><b>2.2.3</b> Probability and the Normal Distribution Curve</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#the-z-distribution"><i class="fa fa-check"></i><b>2.3</b> The Z-Distribution</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#important-numbers-95-and-5"><i class="fa fa-check"></i><b>2.3.1</b> Important Numbers: 95% and 5%</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#exercise-z-distribution-and-probability"><i class="fa fa-check"></i><b>2.4</b> Exercise: Z-Distribution and Probability</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#case-study-barley-data"><i class="fa fa-check"></i><b>2.4.1</b> Case Study: Barley Data</a></li>
<li class="chapter" data-level="2.4.2" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#measuring-the-population-distribution-mean-and-standard-deviation"><i class="fa fa-check"></i><b>2.4.2</b> Measuring the Population Distribution: Mean and Standard Deviation</a></li>
<li class="chapter" data-level="2.4.3" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#the-shadedist-function"><i class="fa fa-check"></i><b>2.4.3</b> The shadeDist Function</a></li>
<li class="chapter" data-level="2.4.4" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#probabilities-in-lower-tails"><i class="fa fa-check"></i><b>2.4.4</b> Probabilities in Lower Tails</a></li>
<li class="chapter" data-level="2.4.5" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#probabilities-in-upper-tails"><i class="fa fa-check"></i><b>2.4.5</b> Probabilities in Upper Tails</a></li>
<li class="chapter" data-level="2.4.6" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#probabilities-within-a-range"><i class="fa fa-check"></i><b>2.4.6</b> Probabilities Within A Range</a></li>
<li class="chapter" data-level="2.4.7" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#probabilities-outside-a-range"><i class="fa fa-check"></i><b>2.4.7</b> Probabilities Outside a Range</a></li>
<li class="chapter" data-level="2.4.8" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#probability-and-sd"><i class="fa fa-check"></i><b>2.4.8</b> Probability and SD</a></li>
<li class="chapter" data-level="2.4.9" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#practice-cotton-dataset"><i class="fa fa-check"></i><b>2.4.9</b> Practice: Cotton Dataset</a></li>
<li class="chapter" data-level="2.4.10" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#practice-tomato-dataset"><i class="fa fa-check"></i><b>2.4.10</b> Practice: Tomato Dataset</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sample-statistics.html"><a href="sample-statistics.html"><i class="fa fa-check"></i><b>3</b> Sample Statistics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="sample-statistics.html"><a href="sample-statistics.html#samples"><i class="fa fa-check"></i><b>3.1</b> Samples</a></li>
<li class="chapter" data-level="3.2" data-path="sample-statistics.html"><a href="sample-statistics.html#case-study-2"><i class="fa fa-check"></i><b>3.2</b> Case Study</a></li>
<li class="chapter" data-level="3.3" data-path="sample-statistics.html"><a href="sample-statistics.html#distribution-of-sample-means"><i class="fa fa-check"></i><b>3.3</b> Distribution of Sample Means</a></li>
<li class="chapter" data-level="3.4" data-path="sample-statistics.html"><a href="sample-statistics.html#central-limit-theorem"><i class="fa fa-check"></i><b>3.4</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="3.5" data-path="sample-statistics.html"><a href="sample-statistics.html#standard-error"><i class="fa fa-check"></i><b>3.5</b> Standard Error</a></li>
<li class="chapter" data-level="3.6" data-path="sample-statistics.html"><a href="sample-statistics.html#degrees-of-freedom"><i class="fa fa-check"></i><b>3.6</b> Degrees of Freedom</a></li>
<li class="chapter" data-level="3.7" data-path="sample-statistics.html"><a href="sample-statistics.html#the-t-distribution"><i class="fa fa-check"></i><b>3.7</b> The t-Distribution</a></li>
<li class="chapter" data-level="3.8" data-path="sample-statistics.html"><a href="sample-statistics.html#confidence-interval"><i class="fa fa-check"></i><b>3.8</b> Confidence Interval</a></li>
<li class="chapter" data-level="3.9" data-path="sample-statistics.html"><a href="sample-statistics.html#confidence-interval-and-probability"><i class="fa fa-check"></i><b>3.9</b> Confidence Interval and Probability</a></li>
<li class="chapter" data-level="3.10" data-path="sample-statistics.html"><a href="sample-statistics.html#exercise-standard-error"><i class="fa fa-check"></i><b>3.10</b> Exercise: Standard Error</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="sample-statistics.html"><a href="sample-statistics.html#case-study-tomatoes"><i class="fa fa-check"></i><b>3.10.1</b> Case Study: Tomatoes</a></li>
<li class="chapter" data-level="3.10.2" data-path="sample-statistics.html"><a href="sample-statistics.html#calculating-standard-error"><i class="fa fa-check"></i><b>3.10.2</b> Calculating Standard Error</a></li>
<li class="chapter" data-level="3.10.3" data-path="sample-statistics.html"><a href="sample-statistics.html#practice-barley"><i class="fa fa-check"></i><b>3.10.3</b> Practice: Barley</a></li>
<li class="chapter" data-level="3.10.4" data-path="sample-statistics.html"><a href="sample-statistics.html#practice-cotton"><i class="fa fa-check"></i><b>3.10.4</b> Practice: Cotton</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="sample-statistics.html"><a href="sample-statistics.html#exercise-t-distribution"><i class="fa fa-check"></i><b>3.11</b> Exercise: t-Distribution</a>
<ul>
<li class="chapter" data-level="3.11.1" data-path="sample-statistics.html"><a href="sample-statistics.html#plotting-the-distribution"><i class="fa fa-check"></i><b>3.11.1</b> Plotting the Distribution</a></li>
<li class="chapter" data-level="3.11.2" data-path="sample-statistics.html"><a href="sample-statistics.html#calculating-t"><i class="fa fa-check"></i><b>3.11.2</b> Calculating T</a></li>
<li class="chapter" data-level="3.11.3" data-path="sample-statistics.html"><a href="sample-statistics.html#practice-2"><i class="fa fa-check"></i><b>3.11.3</b> Practice</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="sample-statistics.html"><a href="sample-statistics.html#exercise-confidence-interval-for-sample-mean"><i class="fa fa-check"></i><b>3.12</b> Exercise: Confidence Interval for Sample Mean</a>
<ul>
<li class="chapter" data-level="3.12.1" data-path="sample-statistics.html"><a href="sample-statistics.html#calculating-the-confidence-interval"><i class="fa fa-check"></i><b>3.12.1</b> Calculating the Confidence Interval</a></li>
<li class="chapter" data-level="3.12.2" data-path="sample-statistics.html"><a href="sample-statistics.html#case-study-peanut-sample-1"><i class="fa fa-check"></i><b>3.12.2</b> Case Study: Peanut Sample 1</a></li>
<li class="chapter" data-level="3.12.3" data-path="sample-statistics.html"><a href="sample-statistics.html#case-study-peanut-sample-2"><i class="fa fa-check"></i><b>3.12.3</b> Case Study: Peanut Sample 2</a></li>
<li class="chapter" data-level="3.12.4" data-path="sample-statistics.html"><a href="sample-statistics.html#practice-3"><i class="fa fa-check"></i><b>3.12.4</b> Practice</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html"><i class="fa fa-check"></i><b>4</b> Two-Treatment Comparisons</a>
<ul>
<li class="chapter" data-level="4.1" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#side-by-side-trials"><i class="fa fa-check"></i><b>4.1</b> Side-by-Side Trials</a></li>
<li class="chapter" data-level="4.2" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#blocked-design"><i class="fa fa-check"></i><b>4.2</b> Blocked Design</a></li>
<li class="chapter" data-level="4.3" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#case-study-3"><i class="fa fa-check"></i><b>4.3</b> Case Study</a></li>
<li class="chapter" data-level="4.4" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#confidence-interval-1"><i class="fa fa-check"></i><b>4.4</b> Confidence Interval</a></li>
<li class="chapter" data-level="4.5" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#t-test"><i class="fa fa-check"></i><b>4.5</b> T-Test</a></li>
<li class="chapter" data-level="4.6" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#exercise-randomizing-plots"><i class="fa fa-check"></i><b>4.6</b> Exercise: Randomizing Plots</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#example-1"><i class="fa fa-check"></i><b>4.6.1</b> Example 1</a></li>
<li class="chapter" data-level="4.6.2" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#the-agricolae-package"><i class="fa fa-check"></i><b>4.6.2</b> The Agricolae Package</a></li>
<li class="chapter" data-level="4.6.3" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#randomizing-the-plot"><i class="fa fa-check"></i><b>4.6.3</b> Randomizing the Plot</a></li>
<li class="chapter" data-level="4.6.4" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#working-with-lists"><i class="fa fa-check"></i><b>4.6.4</b> Working with Lists</a></li>
<li class="chapter" data-level="4.6.5" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#example-2"><i class="fa fa-check"></i><b>4.6.5</b> Example 2</a></li>
</ul></li>
<li class="chapter" data-level="4.7" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#exercise-restructuring-columns-and-rows"><i class="fa fa-check"></i><b>4.7</b> Exercise: Restructuring Columns and Rows</a>
<ul>
<li class="chapter" data-level="4.7.1" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#operations-on-data"><i class="fa fa-check"></i><b>4.7.1</b> Operations on Data</a></li>
<li class="chapter" data-level="4.7.2" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#case-study-soybean-fungicide"><i class="fa fa-check"></i><b>4.7.2</b> Case Study: Soybean Fungicide</a></li>
<li class="chapter" data-level="4.7.3" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#practice-1-1"><i class="fa fa-check"></i><b>4.7.3</b> Practice 1</a></li>
<li class="chapter" data-level="4.7.4" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#practice-2-1"><i class="fa fa-check"></i><b>4.7.4</b> Practice 2</a></li>
<li class="chapter" data-level="4.7.5" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#practice-3-1"><i class="fa fa-check"></i><b>4.7.5</b> Practice 3</a></li>
<li class="chapter" data-level="4.7.6" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#practice-4"><i class="fa fa-check"></i><b>4.7.6</b> Practice 4</a></li>
</ul></li>
<li class="chapter" data-level="4.8" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#exercise-confidence-interval-of-difference"><i class="fa fa-check"></i><b>4.8</b> Exercise: Confidence Interval of Difference"</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#example-1-1"><i class="fa fa-check"></i><b>4.8.1</b> Example 1</a></li>
<li class="chapter" data-level="4.8.2" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#example-2-1"><i class="fa fa-check"></i><b>4.8.2</b> Example 2</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#exercise-t-test"><i class="fa fa-check"></i><b>4.9</b> Exercise: T-Test</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#case-study-1-wheat-fungicide"><i class="fa fa-check"></i><b>4.9.1</b> Case Study 1: Wheat Fungicide</a></li>
<li class="chapter" data-level="4.9.2" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#t-test-1"><i class="fa fa-check"></i><b>4.9.2</b> T-Test</a></li>
<li class="chapter" data-level="4.9.3" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#case-study-2-apple-variety"><i class="fa fa-check"></i><b>4.9.3</b> Case Study 2: Apple Variety</a></li>
<li class="chapter" data-level="4.9.4" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#practice-5"><i class="fa fa-check"></i><b>4.9.4</b> Practice</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html"><i class="fa fa-check"></i><b>5</b> Understanding Statistical Tests</a>
<ul>
<li class="chapter" data-level="5.1" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#research-question"><i class="fa fa-check"></i><b>5.1</b> Research Question</a></li>
<li class="chapter" data-level="5.2" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#the-model"><i class="fa fa-check"></i><b>5.2</b> The Model</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#treatment-effect"><i class="fa fa-check"></i><b>5.2.1</b> Treatment Effect</a></li>
<li class="chapter" data-level="5.2.2" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#error-effect"><i class="fa fa-check"></i><b>5.2.2</b> Error Effect</a></li>
</ul></li>
<li class="chapter" data-level="5.3" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#hypotheses"><i class="fa fa-check"></i><b>5.3</b> Hypotheses</a></li>
<li class="chapter" data-level="5.4" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#p-value"><i class="fa fa-check"></i><b>5.4</b> P-Value</a></li>
<li class="chapter" data-level="5.5" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#the-p-value-and-errors"><i class="fa fa-check"></i><b>5.5</b> The P-Value and Errors</a></li>
<li class="chapter" data-level="5.6" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#one-sided-vs-two-sided-hypotheses"><i class="fa fa-check"></i><b>5.6</b> One-Sided vs Two-Sided Hypotheses</a></li>
<li class="chapter" data-level="5.7" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#exercise-linear-additive-model"><i class="fa fa-check"></i><b>5.7</b> Exercise: Linear Additive Model</a>
<ul>
<li class="chapter" data-level="5.7.1" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#case-study-barley-effects"><i class="fa fa-check"></i><b>5.7.1</b> Case Study: Barley Effects</a></li>
<li class="chapter" data-level="5.7.2" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#plotting-the-effects"><i class="fa fa-check"></i><b>5.7.2</b> Plotting the Effects</a></li>
<li class="chapter" data-level="5.7.3" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#examining-individual-plots"><i class="fa fa-check"></i><b>5.7.3</b> Examining Individual Plots</a></li>
<li class="chapter" data-level="5.7.4" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#practice-groudnut"><i class="fa fa-check"></i><b>5.7.4</b> Practice: Groudnut</a></li>
<li class="chapter" data-level="5.7.5" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#plotting-the-effects-1"><i class="fa fa-check"></i><b>5.7.5</b> Plotting the Effects</a></li>
</ul></li>
<li class="chapter" data-level="5.8" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#exercise-one-sided-hypotheses"><i class="fa fa-check"></i><b>5.8</b> Exercise: One-Sided Hypotheses</a>
<ul>
<li class="chapter" data-level="5.8.1" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#case-study-groundnut"><i class="fa fa-check"></i><b>5.8.1</b> Case Study: Groundnut</a></li>
<li class="chapter" data-level="5.8.2" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#one-sided-t-test"><i class="fa fa-check"></i><b>5.8.2</b> One-Sided T-Test</a></li>
<li class="chapter" data-level="5.8.3" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#practice-barley-1"><i class="fa fa-check"></i><b>5.8.3</b> Practice: Barley</a></li>
<li class="chapter" data-level="5.8.4" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#practice-strawberry"><i class="fa fa-check"></i><b>5.8.4</b> Practice: Strawberry</a></li>
</ul></li>
<li class="chapter" data-level="5.9" data-path="understanding-statistical-tests.html"><a href="understanding-statistical-tests.html#exercise-type-i-and-type-ii-errors"><i class="fa fa-check"></i><b>5.9</b> Exercise: Type I and Type II Errors</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html"><i class="fa fa-check"></i><b>6</b> Multiple Treatment Trials</a>
<ul>
<li class="chapter" data-level="6.1" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#case-study-4"><i class="fa fa-check"></i><b>6.1</b> Case Study</a></li>
<li class="chapter" data-level="6.2" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#the-linear-additive-model"><i class="fa fa-check"></i><b>6.2</b> The Linear Additive Model</a></li>
<li class="chapter" data-level="6.3" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#analysis-of-variance"><i class="fa fa-check"></i><b>6.3</b> Analysis of Variance</a></li>
<li class="chapter" data-level="6.4" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#the-f-statistic"><i class="fa fa-check"></i><b>6.4</b> The F statistic</a></li>
<li class="chapter" data-level="6.5" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#the-anova-table"><i class="fa fa-check"></i><b>6.5</b> The ANOVA Table</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#source-of-variation"><i class="fa fa-check"></i><b>6.5.1</b> Source of Variation</a></li>
<li class="chapter" data-level="6.5.2" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#sum-of-squares-1"><i class="fa fa-check"></i><b>6.5.2</b> Sum of Squares</a></li>
<li class="chapter" data-level="6.5.3" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#degrees-of-freedom-1"><i class="fa fa-check"></i><b>6.5.3</b> Degrees of Freedom</a></li>
<li class="chapter" data-level="6.5.4" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#mean-square"><i class="fa fa-check"></i><b>6.5.4</b> Mean Square</a></li>
<li class="chapter" data-level="6.5.5" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#f-value"><i class="fa fa-check"></i><b>6.5.5</b> F-Value</a></li>
<li class="chapter" data-level="6.5.6" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#p-value-1"><i class="fa fa-check"></i><b>6.5.6</b> P-value</a></li>
</ul></li>
<li class="chapter" data-level="6.6" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#visualizing-how-the-anova-table-relates-to-variance"><i class="fa fa-check"></i><b>6.6</b> Visualizing How the Anova Table Relates to Variance</a>
<ul>
<li class="chapter" data-level="6.6.1" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#case-study-barley"><i class="fa fa-check"></i><b>6.6.1</b> Case Study: Barley</a></li>
<li class="chapter" data-level="6.6.2" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#anova"><i class="fa fa-check"></i><b>6.6.2</b> ANOVA</a></li>
<li class="chapter" data-level="6.6.3" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#calculating-the-coefficient-of-variation"><i class="fa fa-check"></i><b>6.6.3</b> Calculating the Coefficient of Variation</a></li>
<li class="chapter" data-level="6.6.4" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#practice-beet-data"><i class="fa fa-check"></i><b>6.6.4</b> Practice: Beet Data</a></li>
<li class="chapter" data-level="6.6.5" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#practice-potato-data"><i class="fa fa-check"></i><b>6.6.5</b> Practice: Potato Data</a></li>
</ul></li>
<li class="chapter" data-level="6.7" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#exercise-treatment-means"><i class="fa fa-check"></i><b>6.7</b> Exercise: “Treatment Means”</a>
<ul>
<li class="chapter" data-level="6.7.1" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#case-study-barley-1"><i class="fa fa-check"></i><b>6.7.1</b> Case Study: Barley</a></li>
<li class="chapter" data-level="6.7.2" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#calculating-treatment-means"><i class="fa fa-check"></i><b>6.7.2</b> Calculating Treatment Means</a></li>
<li class="chapter" data-level="6.7.3" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#plotting-the-means"><i class="fa fa-check"></i><b>6.7.3</b> Plotting the Means</a></li>
<li class="chapter" data-level="6.7.4" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#practice-beet-data-1"><i class="fa fa-check"></i><b>6.7.4</b> Practice: Beet Data</a></li>
<li class="chapter" data-level="6.7.5" data-path="multiple-treatment-trials.html"><a href="multiple-treatment-trials.html#practice-potato-data-1"><i class="fa fa-check"></i><b>6.7.5</b> Practice: Potato Data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html"><i class="fa fa-check"></i><b>7</b> Multiple Treatment Designs</a>
<ul>
<li class="chapter" data-level="7.1" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#randomized-complete-block-design"><i class="fa fa-check"></i><b>7.1</b> Randomized Complete Block Design</a>
<ul>
<li class="chapter" data-level="7.1.1" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#case-study-randomized-complete-block-design"><i class="fa fa-check"></i><b>7.1.1</b> Case Study: Randomized Complete Block Design</a></li>
</ul></li>
<li class="chapter" data-level="7.2" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#factorial-design"><i class="fa fa-check"></i><b>7.2</b> Factorial Design</a>
<ul>
<li class="chapter" data-level="7.2.1" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#case-study-1-1"><i class="fa fa-check"></i><b>7.2.1</b> Case Study 1</a></li>
<li class="chapter" data-level="7.2.2" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#case-study-2-1"><i class="fa fa-check"></i><b>7.2.2</b> Case Study 2</a></li>
<li class="chapter" data-level="7.2.3" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#discussing-interactions"><i class="fa fa-check"></i><b>7.2.3</b> Discussing Interactions</a></li>
</ul></li>
<li class="chapter" data-level="7.3" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#split-plot-design"><i class="fa fa-check"></i><b>7.3</b> Split-Plot Design</a></li>
<li class="chapter" data-level="7.4" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#linear-additive-model-3"><i class="fa fa-check"></i><b>7.4</b> Linear Additive Model</a></li>
<li class="chapter" data-level="7.5" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#conclusion"><i class="fa fa-check"></i><b>7.5</b> Conclusion</a></li>
<li class="chapter" data-level="7.6" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#exercise-randomized-complete-block-design"><i class="fa fa-check"></i><b>7.6</b> Exercise: Randomized Complete Block Design</a>
<ul>
<li class="chapter" data-level="7.6.1" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#case-study-5"><i class="fa fa-check"></i><b>7.6.1</b> Case Study</a></li>
<li class="chapter" data-level="7.6.2" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#anova-1"><i class="fa fa-check"></i><b>7.6.2</b> ANOVA</a></li>
<li class="chapter" data-level="7.6.3" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#plotting-the-results"><i class="fa fa-check"></i><b>7.6.3</b> Plotting the Results</a></li>
<li class="chapter" data-level="7.6.4" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#practice-6"><i class="fa fa-check"></i><b>7.6.4</b> Practice</a></li>
</ul></li>
<li class="chapter" data-level="7.7" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#exercise-factorial-anova"><i class="fa fa-check"></i><b>7.7</b> Exercise: Factorial ANOVA</a>
<ul>
<li class="chapter" data-level="7.7.1" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#case-study-biochar"><i class="fa fa-check"></i><b>7.7.1</b> Case Study: Biochar</a></li>
<li class="chapter" data-level="7.7.2" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#anova-2"><i class="fa fa-check"></i><b>7.7.2</b> ANOVA</a></li>
<li class="chapter" data-level="7.7.3" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#interaction-plots"><i class="fa fa-check"></i><b>7.7.3</b> Interaction Plots</a></li>
<li class="chapter" data-level="7.7.4" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#testing-factors-individually"><i class="fa fa-check"></i><b>7.7.4</b> Testing Factors Individually</a></li>
<li class="chapter" data-level="7.7.5" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#bar-plots"><i class="fa fa-check"></i><b>7.7.5</b> Bar Plots</a></li>
<li class="chapter" data-level="7.7.6" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#practice-7"><i class="fa fa-check"></i><b>7.7.6</b> Practice</a></li>
</ul></li>
<li class="chapter" data-level="7.8" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#exercise-split-plot-design"><i class="fa fa-check"></i><b>7.8</b> Exercise: Split-Plot Design</a>
<ul>
<li class="chapter" data-level="7.8.1" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#case-study-corn-soybean-systems-trial"><i class="fa fa-check"></i><b>7.8.1</b> Case Study: Corn-Soybean Systems Trial</a></li>
<li class="chapter" data-level="7.8.2" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#anova-4"><i class="fa fa-check"></i><b>7.8.2</b> ANOVA</a></li>
<li class="chapter" data-level="7.8.3" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#interaction-plot"><i class="fa fa-check"></i><b>7.8.3</b> Interaction Plot</a></li>
<li class="chapter" data-level="7.8.4" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#bar-plot"><i class="fa fa-check"></i><b>7.8.4</b> Bar plot</a></li>
<li class="chapter" data-level="7.8.5" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#practice-8"><i class="fa fa-check"></i><b>7.8.5</b> Practice</a></li>
</ul></li>
<li class="chapter" data-level="7.9" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#exercise-experimental-design"><i class="fa fa-check"></i><b>7.9</b> Exercise: Experimental Design</a>
<ul>
<li class="chapter" data-level="7.9.1" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#completely-randomized-design"><i class="fa fa-check"></i><b>7.9.1</b> Completely Randomized Design</a></li>
<li class="chapter" data-level="7.9.2" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#randomized-complete-block-design-1"><i class="fa fa-check"></i><b>7.9.2</b> Randomized Complete Block Design</a></li>
<li class="chapter" data-level="7.9.3" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#factorial-design-1"><i class="fa fa-check"></i><b>7.9.3</b> Factorial Design</a></li>
<li class="chapter" data-level="7.9.4" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#split-plot-design-1"><i class="fa fa-check"></i><b>7.9.4</b> Split-Plot Design</a></li>
<li class="chapter" data-level="7.9.5" data-path="multiple-treatment-designs.html"><a href="multiple-treatment-designs.html#practice-9"><i class="fa fa-check"></i><b>7.9.5</b> Practice</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="8" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html"><i class="fa fa-check"></i><b>8</b> Means Separation and Data Presentation</a>
<ul>
<li class="chapter" data-level="8.1" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#case-study-6"><i class="fa fa-check"></i><b>8.1</b> Case Study</a></li>
<li class="chapter" data-level="8.2" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#least-significant-difference"><i class="fa fa-check"></i><b>8.2</b> Least Significant Difference</a></li>
<li class="chapter" data-level="8.3" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#lsd-output-in-r"><i class="fa fa-check"></i><b>8.3</b> LSD Output in R</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#statistics-table"><i class="fa fa-check"></i><b>8.3.1</b> Statistics Table</a></li>
<li class="chapter" data-level="8.3.2" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#means-table"><i class="fa fa-check"></i><b>8.3.2</b> Means Table</a></li>
<li class="chapter" data-level="8.3.3" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#groups-table"><i class="fa fa-check"></i><b>8.3.3</b> Groups Table</a></li>
</ul></li>
<li class="chapter" data-level="8.4" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#comparisonwise-versus-experimentwise-error"><i class="fa fa-check"></i><b>8.4</b> Comparisonwise versus Experimentwise Error</a></li>
<li class="chapter" data-level="8.5" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#tukeys-honest-significant-difference"><i class="fa fa-check"></i><b>8.5</b> Tukey’s Honest Significant Difference</a></li>
<li class="chapter" data-level="8.6" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#linear-contrast"><i class="fa fa-check"></i><b>8.6</b> Linear Contrast</a>
<ul>
<li class="chapter" data-level="8.6.1" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#coefficients"><i class="fa fa-check"></i><b>8.6.1</b> Coefficients</a></li>
<li class="chapter" data-level="8.6.2" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#linear-contrasts-with-r"><i class="fa fa-check"></i><b>8.6.2</b> Linear Contrasts with R</a></li>
</ul></li>
<li class="chapter" data-level="8.7" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#means-presentation"><i class="fa fa-check"></i><b>8.7</b> Means Presentation</a>
<ul>
<li class="chapter" data-level="8.7.1" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#means-tables"><i class="fa fa-check"></i><b>8.7.1</b> Means Tables</a></li>
<li class="chapter" data-level="8.7.2" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#plotting-means"><i class="fa fa-check"></i><b>8.7.2</b> Plotting Means</a></li>
</ul></li>
<li class="chapter" data-level="8.8" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#exercise-lsd-and-tukeys-hsd"><i class="fa fa-check"></i><b>8.8</b> Exercise: LSD and Tukey’s HSD</a>
<ul>
<li class="chapter" data-level="8.8.1" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#case-study-common-bean"><i class="fa fa-check"></i><b>8.8.1</b> Case Study: Common Bean</a></li>
<li class="chapter" data-level="8.8.2" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#least-significant-difference-1"><i class="fa fa-check"></i><b>8.8.2</b> Least Significant Difference</a></li>
<li class="chapter" data-level="8.8.3" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#tukey-hsd"><i class="fa fa-check"></i><b>8.8.3</b> Tukey HSD</a></li>
<li class="chapter" data-level="8.8.4" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#practice-apple"><i class="fa fa-check"></i><b>8.8.4</b> Practice: Apple</a></li>
<li class="chapter" data-level="8.8.5" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#practice-wheat-treatment-with-mildew"><i class="fa fa-check"></i><b>8.8.5</b> Practice: Wheat Treatment with Mildew</a></li>
</ul></li>
<li class="chapter" data-level="8.9" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#exercise-linear-contrasts"><i class="fa fa-check"></i><b>8.9</b> Exercise: Linear Contrasts</a>
<ul>
<li class="chapter" data-level="8.9.1" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#case-study-winter-canola-cultivar-trial."><i class="fa fa-check"></i><b>8.9.1</b> Case Study: Winter Canola Cultivar Trial.</a></li>
<li class="chapter" data-level="8.9.2" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#running-the-contrast"><i class="fa fa-check"></i><b>8.9.2</b> Running the Contrast</a></li>
<li class="chapter" data-level="8.9.3" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#practice-corn-nitrogen-source-and-timing"><i class="fa fa-check"></i><b>8.9.3</b> Practice: Corn Nitrogen Source and Timing</a></li>
</ul></li>
<li class="chapter" data-level="8.10" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#exercise-means-tables"><i class="fa fa-check"></i><b>8.10</b> Exercise: Means Tables</a>
<ul>
<li class="chapter" data-level="8.10.1" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#case-study-corn-nitrogen-source-and-timing"><i class="fa fa-check"></i><b>8.10.1</b> Case Study: Corn Nitrogen Source and Timing</a></li>
<li class="chapter" data-level="8.10.2" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#practice-canola"><i class="fa fa-check"></i><b>8.10.2</b> Practice: Canola</a></li>
<li class="chapter" data-level="8.10.3" data-path="means-separation-and-data-presentation.html"><a href="means-separation-and-data-presentation.html#practice-broccoli-lsd"><i class="fa fa-check"></i><b>8.10.3</b> Practice: Broccoli LSD</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="9" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html"><i class="fa fa-check"></i><b>9</b> Messy and Missing Data</a>
<ul>
<li class="chapter" data-level="9.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#inspecting-data-for-normal-distributions"><i class="fa fa-check"></i><b>9.1</b> Inspecting data for Normal Distributions</a>
<ul>
<li class="chapter" data-level="9.1.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#histograms-1"><i class="fa fa-check"></i><b>9.1.1</b> Histograms</a></li>
<li class="chapter" data-level="9.1.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#rank-percentile-plots"><i class="fa fa-check"></i><b>9.1.2</b> Rank Percentile Plots</a></li>
<li class="chapter" data-level="9.1.3" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#box-plots"><i class="fa fa-check"></i><b>9.1.3</b> Box Plots</a></li>
</ul></li>
<li class="chapter" data-level="9.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#inspecting-data-for-equal-variances"><i class="fa fa-check"></i><b>9.2</b> Inspecting Data for Equal Variances</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#mean-variance-plot"><i class="fa fa-check"></i><b>9.2.1</b> Mean-Variance Plot</a></li>
<li class="chapter" data-level="9.2.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#homogeneity-of-variance-tests"><i class="fa fa-check"></i><b>9.2.2</b> Homogeneity of Variance Tests</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#dealing-with-messy-data"><i class="fa fa-check"></i><b>9.3</b> Dealing with Messy Data</a>
<ul>
<li class="chapter" data-level="9.3.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#outliers"><i class="fa fa-check"></i><b>9.3.1</b> Outliers</a></li>
<li class="chapter" data-level="9.3.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#non-normal-data-and-unequal-variances"><i class="fa fa-check"></i><b>9.3.2</b> Non-normal Data and Unequal Variances</a></li>
</ul></li>
<li class="chapter" data-level="9.4" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#dealing-with-missing-data"><i class="fa fa-check"></i><b>9.4</b> Dealing with Missing Data</a></li>
<li class="chapter" data-level="9.5" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#summary"><i class="fa fa-check"></i><b>9.5</b> Summary</a></li>
<li class="chapter" data-level="9.6" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#exercise-visual-data-inspection"><i class="fa fa-check"></i><b>9.6</b> Exercise: Visual Data Inspection</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#case-study-1-2"><i class="fa fa-check"></i><b>9.6.1</b> Case Study 1</a></li>
<li class="chapter" data-level="9.6.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#histogram"><i class="fa fa-check"></i><b>9.6.2</b> Histogram</a></li>
<li class="chapter" data-level="9.6.3" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#rank-percentile"><i class="fa fa-check"></i><b>9.6.3</b> Rank-Percentile</a></li>
<li class="chapter" data-level="9.6.4" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#case-study-2-2"><i class="fa fa-check"></i><b>9.6.4</b> Case Study 2</a></li>
<li class="chapter" data-level="9.6.5" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#box-plot"><i class="fa fa-check"></i><b>9.6.5</b> Box Plot</a></li>
<li class="chapter" data-level="9.6.6" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#practice-10"><i class="fa fa-check"></i><b>9.6.6</b> Practice</a></li>
</ul></li>
<li class="chapter" data-level="9.7" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#exercise-identifying-unequal-variances"><i class="fa fa-check"></i><b>9.7</b> Exercise: Identifying Unequal Variances"</a>
<ul>
<li class="chapter" data-level="9.7.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#case-study-grape-colapsis-in-seed-corn"><i class="fa fa-check"></i><b>9.7.1</b> Case Study: Grape Colapsis in Seed Corn</a></li>
<li class="chapter" data-level="9.7.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#practice-pigweed-height"><i class="fa fa-check"></i><b>9.7.2</b> Practice: Pigweed Height</a></li>
</ul></li>
<li class="chapter" data-level="9.8" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#exercise-transforming-and-analyzing-data"><i class="fa fa-check"></i><b>9.8</b> Exercise: Transforming and Analyzing Data</a>
<ul>
<li class="chapter" data-level="9.8.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#case-study-grape-colapsis-in-seed-corn-1"><i class="fa fa-check"></i><b>9.8.1</b> Case Study: Grape Colapsis in Seed Corn</a></li>
<li class="chapter" data-level="9.8.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#practice-pigweed-height-1"><i class="fa fa-check"></i><b>9.8.2</b> Practice: Pigweed Height</a></li>
<li class="chapter" data-level="9.8.3" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#practice-pigweed-biomass"><i class="fa fa-check"></i><b>9.8.3</b> Practice: Pigweed Biomass</a></li>
</ul></li>
<li class="chapter" data-level="9.9" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#exercise-imputing-missing-data"><i class="fa fa-check"></i><b>9.9</b> Exercise: Imputing Missing Data</a>
<ul>
<li class="chapter" data-level="9.9.1" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#case-study-wheat-genotype-trial"><i class="fa fa-check"></i><b>9.9.1</b> Case Study: Wheat Genotype Trial</a></li>
<li class="chapter" data-level="9.9.2" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#practice-1-2"><i class="fa fa-check"></i><b>9.9.2</b> Practice 1</a></li>
<li class="chapter" data-level="9.9.3" data-path="messy-and-missing-data.html"><a href="messy-and-missing-data.html#practice-2-2"><i class="fa fa-check"></i><b>9.9.3</b> Practice 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html"><i class="fa fa-check"></i><b>10</b> Correlation and Simple Regression</a>
<ul>
<li class="chapter" data-level="10.1" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#correlation"><i class="fa fa-check"></i><b>10.1</b> Correlation</a>
<ul>
<li class="chapter" data-level="10.1.1" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#case-study-cucumber"><i class="fa fa-check"></i><b>10.1.1</b> Case Study: Cucumber</a></li>
</ul></li>
<li class="chapter" data-level="10.2" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#correlation-1"><i class="fa fa-check"></i><b>10.2</b> Correlation</a>
<ul>
<li class="chapter" data-level="10.2.1" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#how-is-r-calcuated-optional-reading"><i class="fa fa-check"></i><b>10.2.1</b> How Is r Calcuated (optional reading)</a></li>
</ul></li>
<li class="chapter" data-level="10.3" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#regression"><i class="fa fa-check"></i><b>10.3</b> Regression</a>
<ul>
<li class="chapter" data-level="10.3.1" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#case-study-7"><i class="fa fa-check"></i><b>10.3.1</b> Case Study</a></li>
<li class="chapter" data-level="10.3.2" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#linear-equation"><i class="fa fa-check"></i><b>10.3.2</b> Linear Equation</a></li>
<li class="chapter" data-level="10.3.3" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#calculating-the-regression-equation"><i class="fa fa-check"></i><b>10.3.3</b> Calculating the Regression Equation</a></li>
<li class="chapter" data-level="10.3.4" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#least-squares-estimate"><i class="fa fa-check"></i><b>10.3.4</b> Least-Squares Estimate</a></li>
<li class="chapter" data-level="10.3.5" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#significance-of-coefficients"><i class="fa fa-check"></i><b>10.3.5</b> Significance of Coefficients</a></li>
<li class="chapter" data-level="10.3.6" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#analysis-of-variance-6"><i class="fa fa-check"></i><b>10.3.6</b> Analysis of Variance</a></li>
<li class="chapter" data-level="10.3.7" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#measuring-model-fit-with-r-square"><i class="fa fa-check"></i><b>10.3.7</b> Measuring Model Fit with R-Square</a></li>
<li class="chapter" data-level="10.3.8" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#checking-whether-the-linear-model-is-appropriate"><i class="fa fa-check"></i><b>10.3.8</b> Checking whether the Linear Model is Appropriate</a></li>
</ul></li>
<li class="chapter" data-level="10.4" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#extrapolation"><i class="fa fa-check"></i><b>10.4</b> Extrapolation</a></li>
<li class="chapter" data-level="10.5" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#exercise-sccatterplots-and-regression"><i class="fa fa-check"></i><b>10.5</b> Exercise: Sccatterplots and Regression</a>
<ul>
<li class="chapter" data-level="10.5.1" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#case-study-corn-data"><i class="fa fa-check"></i><b>10.5.1</b> Case Study: Corn Data</a></li>
<li class="chapter" data-level="10.5.2" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#practice-1-3"><i class="fa fa-check"></i><b>10.5.2</b> Practice 1</a></li>
<li class="chapter" data-level="10.5.3" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#practice-2-3"><i class="fa fa-check"></i><b>10.5.3</b> Practice 2</a></li>
<li class="chapter" data-level="10.5.4" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#practice-3-2"><i class="fa fa-check"></i><b>10.5.4</b> Practice 3</a></li>
<li class="chapter" data-level="10.5.5" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#practice-4-1"><i class="fa fa-check"></i><b>10.5.5</b> Practice 4</a></li>
</ul></li>
<li class="chapter" data-level="10.6" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#exercise-simple-linear-regression"><i class="fa fa-check"></i><b>10.6</b> Exercise: Simple Linear Regression</a>
<ul>
<li class="chapter" data-level="10.6.1" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#case-study-corn-allometry"><i class="fa fa-check"></i><b>10.6.1</b> Case Study: Corn Allometry</a></li>
<li class="chapter" data-level="10.6.2" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#fitting-the-regression-model"><i class="fa fa-check"></i><b>10.6.2</b> Fitting the regression model</a></li>
<li class="chapter" data-level="10.6.3" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#examining-the-residuals"><i class="fa fa-check"></i><b>10.6.3</b> Examining the residuals</a></li>
<li class="chapter" data-level="10.6.4" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#viewing-the-model-coefficients"><i class="fa fa-check"></i><b>10.6.4</b> Viewing the Model Coefficients</a></li>
<li class="chapter" data-level="10.6.5" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#more-measures-of-model-fit"><i class="fa fa-check"></i><b>10.6.5</b> More measures of model fit</a></li>
<li class="chapter" data-level="10.6.6" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#practice-1-4"><i class="fa fa-check"></i><b>10.6.6</b> Practice 1</a></li>
<li class="chapter" data-level="10.6.7" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#practice-2-4"><i class="fa fa-check"></i><b>10.6.7</b> Practice 2</a></li>
</ul></li>
<li class="chapter" data-level="10.7" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#exercise-making-predictions-from-regression-models."><i class="fa fa-check"></i><b>10.7</b> Exercise: Making Predictions from Regression Models.</a>
<ul>
<li class="chapter" data-level="10.7.1" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#case-study-8"><i class="fa fa-check"></i><b>10.7.1</b> Case Study</a></li>
<li class="chapter" data-level="10.7.2" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#creating-and-testing-our-model"><i class="fa fa-check"></i><b>10.7.2</b> Creating and Testing our Model</a></li>
<li class="chapter" data-level="10.7.3" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#visualizing-the-regression-model"><i class="fa fa-check"></i><b>10.7.3</b> Visualizing the Regression Model</a></li>
<li class="chapter" data-level="10.7.4" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#making-predictions-with-the-regression-model"><i class="fa fa-check"></i><b>10.7.4</b> Making Predictions with the Regression Model</a></li>
<li class="chapter" data-level="10.7.5" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#practice-1-5"><i class="fa fa-check"></i><b>10.7.5</b> Practice 1</a></li>
<li class="chapter" data-level="10.7.6" data-path="correlation-and-simple-regression.html"><a href="correlation-and-simple-regression.html#practice-2-5"><i class="fa fa-check"></i><b>10.7.6</b> Practice 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="11" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html"><i class="fa fa-check"></i><b>11</b> Nonlinear Relationships and Multiple Linear Regression</a>
<ul>
<li class="chapter" data-level="11.1" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#multiplie-linear-regression"><i class="fa fa-check"></i><b>11.1</b> Multiplie Linear Regression</a>
<ul>
<li class="chapter" data-level="11.1.1" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#case-study-modelling-yield-by-county"><i class="fa fa-check"></i><b>11.1.1</b> Case Study: Modelling Yield by County</a></li>
<li class="chapter" data-level="11.1.2" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#beware-of-bloated-models"><i class="fa fa-check"></i><b>11.1.2</b> Beware of Bloated Models</a></li>
<li class="chapter" data-level="11.1.3" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#methods-for-avoiding-bloated-models"><i class="fa fa-check"></i><b>11.1.3</b> Methods for Avoiding Bloated Models</a></li>
<li class="chapter" data-level="11.1.4" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#tunning-and-comparing-models"><i class="fa fa-check"></i><b>11.1.4</b> Tunning and Comparing Models</a></li>
</ul></li>
<li class="chapter" data-level="11.2" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#nonlinear-relationships"><i class="fa fa-check"></i><b>11.2</b> Nonlinear Relationships</a>
<ul>
<li class="chapter" data-level="11.2.1" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#fitting-nonlinear-responses-with-linear-regression"><i class="fa fa-check"></i><b>11.2.1</b> Fitting Nonlinear Responses with Linear Regression</a></li>
<li class="chapter" data-level="11.2.2" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#fitting-nonlinear-responses-with-nonlinear-regression"><i class="fa fa-check"></i><b>11.2.2</b> Fitting Nonlinear Responses with Nonlinear Regression</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#summary-1"><i class="fa fa-check"></i><b>11.3</b> Summary</a></li>
<li class="chapter" data-level="11.4" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#exercise-multiple-linear-regression"><i class="fa fa-check"></i><b>11.4</b> Exercise: Multiple Linear Regression</a>
<ul>
<li class="chapter" data-level="11.4.1" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#case-study-country-corn-yields"><i class="fa fa-check"></i><b>11.4.1</b> Case Study: Country Corn Yields</a></li>
<li class="chapter" data-level="11.4.2" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#fitting-the-model"><i class="fa fa-check"></i><b>11.4.2</b> Fitting the Model</a></li>
<li class="chapter" data-level="11.4.3" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#inspecting-the-model"><i class="fa fa-check"></i><b>11.4.3</b> Inspecting the Model</a></li>
<li class="chapter" data-level="11.4.4" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#practice-thompson-corn-data"><i class="fa fa-check"></i><b>11.4.4</b> Practice: Thompson Corn Data</a></li>
</ul></li>
<li class="chapter" data-level="11.5" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#exercise-avoiding-bloated-models"><i class="fa fa-check"></i><b>11.5</b> Exercise: Avoiding Bloated Models</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#case-study-9"><i class="fa fa-check"></i><b>11.5.1</b> Case Study</a></li>
<li class="chapter" data-level="11.5.2" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#covariance-matrix"><i class="fa fa-check"></i><b>11.5.2</b> Covariance Matrix</a></li>
<li class="chapter" data-level="11.5.3" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#partial-correlation-1"><i class="fa fa-check"></i><b>11.5.3</b> Partial Correlation</a></li>
<li class="chapter" data-level="11.5.4" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#cross-validation-1"><i class="fa fa-check"></i><b>11.5.4</b> Cross-Validation</a></li>
<li class="chapter" data-level="11.5.5" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#practice-thompson-corn-data-1"><i class="fa fa-check"></i><b>11.5.5</b> Practice: Thompson Corn Data</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#exercise-tuning-the-model"><i class="fa fa-check"></i><b>11.6</b> Exercise: Tuning the Model</a>
<ul>
<li class="chapter" data-level="11.6.1" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#case-study-10"><i class="fa fa-check"></i><b>11.6.1</b> Case Study</a></li>
<li class="chapter" data-level="11.6.2" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#tuning-the-model"><i class="fa fa-check"></i><b>11.6.2</b> Tuning the Model</a></li>
<li class="chapter" data-level="11.6.3" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#practice-11"><i class="fa fa-check"></i><b>11.6.3</b> Practice</a></li>
<li class="chapter" data-level="11.6.4" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#practice-12"><i class="fa fa-check"></i><b>11.6.4</b> Practice</a></li>
</ul></li>
<li class="chapter" data-level="11.7" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#exercise-nonlinear-regression"><i class="fa fa-check"></i><b>11.7</b> Exercise: Nonlinear Regression</a>
<ul>
<li class="chapter" data-level="11.7.1" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#case-study-1-monomolecular-data"><i class="fa fa-check"></i><b>11.7.1</b> Case Study 1: Monomolecular Data</a></li>
<li class="chapter" data-level="11.7.2" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#case-study-2-logistic-data"><i class="fa fa-check"></i><b>11.7.2</b> Case Study 2: Logistic Data</a></li>
<li class="chapter" data-level="11.7.3" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#practice-1-6"><i class="fa fa-check"></i><b>11.7.3</b> Practice 1</a></li>
<li class="chapter" data-level="11.7.4" data-path="nonlinear-relationships-and-multiple-linear-regression.html"><a href="nonlinear-relationships-and-multiple-linear-regression.html#practice-2-6"><i class="fa fa-check"></i><b>11.7.4</b> Practice 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="12" data-path="spatial-statistics.html"><a href="spatial-statistics.html"><i class="fa fa-check"></i><b>12</b> Spatial Statistics</a>
<ul>
<li class="chapter" data-level="12.1" data-path="spatial-statistics.html"><a href="spatial-statistics.html#projection-general"><i class="fa fa-check"></i><b>12.1</b> Projection (General)</a>
<ul>
<li class="chapter" data-level="12.1.1" data-path="spatial-statistics.html"><a href="spatial-statistics.html#wgs-84-epsg-4236"><i class="fa fa-check"></i><b>12.1.1</b> WGS 84 (EPSG: 4236)</a></li>
<li class="chapter" data-level="12.1.2" data-path="spatial-statistics.html"><a href="spatial-statistics.html#mercator-epsg-3857"><i class="fa fa-check"></i><b>12.1.2</b> Mercator (EPSG: 3857)</a></li>
<li class="chapter" data-level="12.1.3" data-path="spatial-statistics.html"><a href="spatial-statistics.html#us-national-atlas-equal-area-epsg-2163"><i class="fa fa-check"></i><b>12.1.3</b> US National Atlas Equal Area (EPSG: 2163)</a></li>
<li class="chapter" data-level="12.1.4" data-path="spatial-statistics.html"><a href="spatial-statistics.html#utm-zone-11n-epsg-2955"><i class="fa fa-check"></i><b>12.1.4</b> UTM Zone 11N (EPSG: 2955)</a></li>
<li class="chapter" data-level="12.1.5" data-path="spatial-statistics.html"><a href="spatial-statistics.html#projection-summary"><i class="fa fa-check"></i><b>12.1.5</b> Projection Summary</a></li>
</ul></li>
<li class="chapter" data-level="12.2" data-path="spatial-statistics.html"><a href="spatial-statistics.html#shape-files"><i class="fa fa-check"></i><b>12.2</b> Shape Files</a>
<ul>
<li class="chapter" data-level="12.2.1" data-path="spatial-statistics.html"><a href="spatial-statistics.html#case-study-soybean-yield-in-iowa"><i class="fa fa-check"></i><b>12.2.1</b> Case Study: Soybean Yield in Iowa</a></li>
<li class="chapter" data-level="12.2.2" data-path="spatial-statistics.html"><a href="spatial-statistics.html#ssurgo"><i class="fa fa-check"></i><b>12.2.2</b> SSURGO</a></li>
<li class="chapter" data-level="12.2.3" data-path="spatial-statistics.html"><a href="spatial-statistics.html#operations-with-shapes"><i class="fa fa-check"></i><b>12.2.3</b> Operations with Shapes</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="spatial-statistics.html"><a href="spatial-statistics.html#rasters"><i class="fa fa-check"></i><b>12.3</b> Rasters</a>
<ul>
<li class="chapter" data-level="12.3.1" data-path="spatial-statistics.html"><a href="spatial-statistics.html#interpolation"><i class="fa fa-check"></i><b>12.3.1</b> Interpolation</a></li>
<li class="chapter" data-level="12.3.2" data-path="spatial-statistics.html"><a href="spatial-statistics.html#kriging"><i class="fa fa-check"></i><b>12.3.2</b> Kriging</a></li>
<li class="chapter" data-level="12.3.3" data-path="spatial-statistics.html"><a href="spatial-statistics.html#operations-on-kriged-data"><i class="fa fa-check"></i><b>12.3.3</b> Operations on Kriged Data</a></li>
</ul></li>
<li class="chapter" data-level="12.4" data-path="spatial-statistics.html"><a href="spatial-statistics.html#exercise-shape-files"><i class="fa fa-check"></i><b>12.4</b> Exercise: Shape Files</a>
<ul>
<li class="chapter" data-level="12.4.1" data-path="spatial-statistics.html"><a href="spatial-statistics.html#case-study-11"><i class="fa fa-check"></i><b>12.4.1</b> Case Study</a></li>
<li class="chapter" data-level="12.4.2" data-path="spatial-statistics.html"><a href="spatial-statistics.html#practice-13"><i class="fa fa-check"></i><b>12.4.2</b> Practice</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="spatial-statistics.html"><a href="spatial-statistics.html#exercise-ssurgo"><i class="fa fa-check"></i><b>12.5</b> Exercise: SSURGO</a></li>
<li class="chapter" data-level="12.6" data-path="spatial-statistics.html"><a href="spatial-statistics.html#exercise-rasters"><i class="fa fa-check"></i><b>12.6</b> Exercise: Rasters</a>
<ul>
<li class="chapter" data-level="12.6.1" data-path="spatial-statistics.html"><a href="spatial-statistics.html#case-study-soil-test-data"><i class="fa fa-check"></i><b>12.6.1</b> Case Study: Soil Test Data</a></li>
<li class="chapter" data-level="12.6.2" data-path="spatial-statistics.html"><a href="spatial-statistics.html#practice-1-7"><i class="fa fa-check"></i><b>12.6.2</b> Practice 1</a></li>
<li class="chapter" data-level="12.6.3" data-path="spatial-statistics.html"><a href="spatial-statistics.html#practice-2-7"><i class="fa fa-check"></i><b>12.6.3</b> Practice 2</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="13" data-path="machine-learning.html"><a href="machine-learning.html"><i class="fa fa-check"></i><b>13</b> Machine Learning</a>
<ul>
<li class="chapter" data-level="13.1" data-path="machine-learning.html"><a href="machine-learning.html#machine-learning-1"><i class="fa fa-check"></i><b>13.1</b> Machine Learning</a></li>
<li class="chapter" data-level="13.2" data-path="machine-learning.html"><a href="machine-learning.html#cluster-analyses"><i class="fa fa-check"></i><b>13.2</b> Cluster Analyses</a>
<ul>
<li class="chapter" data-level="13.2.1" data-path="machine-learning.html"><a href="machine-learning.html#case-study-grouping-midwestern-environments"><i class="fa fa-check"></i><b>13.2.1</b> Case Study: Grouping Midwestern Environments</a></li>
<li class="chapter" data-level="13.2.2" data-path="machine-learning.html"><a href="machine-learning.html#scaling"><i class="fa fa-check"></i><b>13.2.2</b> Scaling</a></li>
<li class="chapter" data-level="13.2.3" data-path="machine-learning.html"><a href="machine-learning.html#clustering-animation"><i class="fa fa-check"></i><b>13.2.3</b> Clustering Animation</a></li>
<li class="chapter" data-level="13.2.4" data-path="machine-learning.html"><a href="machine-learning.html#county-cluster-analysis"><i class="fa fa-check"></i><b>13.2.4</b> County Cluster Analysis</a></li>
</ul></li>
<li class="chapter" data-level="13.3" data-path="machine-learning.html"><a href="machine-learning.html#k-nearest-neighbors"><i class="fa fa-check"></i><b>13.3</b> k-Nearest-Neighbors</a>
<ul>
<li class="chapter" data-level="13.3.1" data-path="machine-learning.html"><a href="machine-learning.html#case-study-guessing-county-yields-based-on-environmental-similarity"><i class="fa fa-check"></i><b>13.3.1</b> Case Study: Guessing County Yields based on Environmental Similarity</a></li>
<li class="chapter" data-level="13.3.2" data-path="machine-learning.html"><a href="machine-learning.html#scaling-1"><i class="fa fa-check"></i><b>13.3.2</b> Scaling</a></li>
<li class="chapter" data-level="13.3.3" data-path="machine-learning.html"><a href="machine-learning.html#k-nearest-neighbor-animation"><i class="fa fa-check"></i><b>13.3.3</b> k-Nearest-Neighbor Animation</a></li>
<li class="chapter" data-level="13.3.4" data-path="machine-learning.html"><a href="machine-learning.html#choosing-k"><i class="fa fa-check"></i><b>13.3.4</b> Choosing <span class="math inline">\(k\)</span></a></li>
<li class="chapter" data-level="13.3.5" data-path="machine-learning.html"><a href="machine-learning.html#model-cross-validation"><i class="fa fa-check"></i><b>13.3.5</b> Model Cross-Validation</a></li>
<li class="chapter" data-level="13.3.6" data-path="machine-learning.html"><a href="machine-learning.html#yield-prediction-with-nearest-neighbor-analysis"><i class="fa fa-check"></i><b>13.3.6</b> Yield Prediction with Nearest Neighbor Analysis</a></li>
</ul></li>
<li class="chapter" data-level="13.4" data-path="machine-learning.html"><a href="machine-learning.html#classification-trees"><i class="fa fa-check"></i><b>13.4</b> Classification Trees</a>
<ul>
<li class="chapter" data-level="13.4.1" data-path="machine-learning.html"><a href="machine-learning.html#features"><i class="fa fa-check"></i><b>13.4.1</b> Features</a></li>
<li class="chapter" data-level="13.4.2" data-path="machine-learning.html"><a href="machine-learning.html#quantitative-categorical-data"><i class="fa fa-check"></i><b>13.4.2</b> Quantitative (Categorical) Data</a></li>
<li class="chapter" data-level="13.4.3" data-path="machine-learning.html"><a href="machine-learning.html#quanatitiative-continuous-data"><i class="fa fa-check"></i><b>13.4.3</b> Quanatitiative (Continuous) Data</a></li>
<li class="chapter" data-level="13.4.4" data-path="machine-learning.html"><a href="machine-learning.html#overfitting-1"><i class="fa fa-check"></i><b>13.4.4</b> Overfitting</a></li>
<li class="chapter" data-level="13.4.5" data-path="machine-learning.html"><a href="machine-learning.html#cross-validation-2"><i class="fa fa-check"></i><b>13.4.5</b> Cross Validation</a></li>
<li class="chapter" data-level="13.4.6" data-path="machine-learning.html"><a href="machine-learning.html#random-forest"><i class="fa fa-check"></i><b>13.4.6</b> Random Forest</a></li>
<li class="chapter" data-level="13.4.7" data-path="machine-learning.html"><a href="machine-learning.html#feature-importance"><i class="fa fa-check"></i><b>13.4.7</b> Feature Importance</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="machine-learning.html"><a href="machine-learning.html#summary-2"><i class="fa fa-check"></i><b>13.5</b> Summary</a></li>
</ul></li>
<li class="chapter" data-level="14" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html"><i class="fa fa-check"></i><b>14</b> Putting it all Together</a>
<ul>
<li class="chapter" data-level="14.1" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#scenario-1-yield-map-population-summary-and-z-distribution"><i class="fa fa-check"></i><b>14.1</b> Scenario 1: Yield Map (Population Summary and Z-Distribution)</a></li>
<li class="chapter" data-level="14.2" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#scenario-2-yield-estimate-sampling-t-distribution"><i class="fa fa-check"></i><b>14.2</b> Scenario 2: Yield Estimate (Sampling t-Distribution)</a></li>
<li class="chapter" data-level="14.3" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#scenario-3-side-by-side-t-test"><i class="fa fa-check"></i><b>14.3</b> Scenario 3: Side-By-Side (t-Test)</a></li>
<li class="chapter" data-level="14.4" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#scenario-4-fungicide-trial-anova-crd-or-rcbd"><i class="fa fa-check"></i><b>14.4</b> Scenario 4: Fungicide Trial (ANOVA CRD or RCBD)</a></li>
<li class="chapter" data-level="14.5" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#scenario-5-hybrid-response-to-fungicide-trial-anova-factorial-or-split-plot"><i class="fa fa-check"></i><b>14.5</b> Scenario 5: Hybrid Response to Fungicide Trial (ANOVA Factorial or Split Plot)</a></li>
<li class="chapter" data-level="14.6" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#scenario-6-foliar-rate-response-trial-linear-or-non-linear-regression"><i class="fa fa-check"></i><b>14.6</b> Scenario 6: Foliar Rate-Response Trial (Linear or Non-Linear Regression)</a></li>
<li class="chapter" data-level="14.7" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#scenario-7-application-map-shapefiles-and-rasters"><i class="fa fa-check"></i><b>14.7</b> Scenario 7: Application Map (Shapefiles and Rasters)</a></li>
<li class="chapter" data-level="14.8" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#scenario-8-yield-prediction-multiple-linear-regression-and-other-predictive-models"><i class="fa fa-check"></i><b>14.8</b> Scenario 8: Yield Prediction (Multiple Linear Regression and other Predictive Models)</a></li>
<li class="chapter" data-level="14.9" data-path="putting-it-all-together.html"><a href="putting-it-all-together.html#summary-3"><i class="fa fa-check"></i><b>14.9</b> Summary</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Agricultural Professionals</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="messy-and-missing-data" class="section level1" number="9">
<h1><span class="header-section-number">Chapter 9</span> Messy and Missing Data</h1>
<p>You have to love the nice, complete datasets I have served up to you in this and other statistics texts. Indeed, some trials will work out this way – in general, the simpler the treatment (and the technology used to apply it) the greater your chances of a complete dataset. Planters will jam, nozzles will plug, and if a trial has 12 treatments a couple of them may end up in the wrong plot. Best to avoid those if possible.</p>
<p>As well, the smaller the experiment, or the more controlled the environment, the greater your odds of a complete dataset. For that reason, decades of university and industry research has been performed in 10- x 40- plots stacked closely together on manicured, table-top-flat ground. If you were a seed-breeder, you had dibs on these fields. If you were an ecologist like me, you might have to head to the back 40 (j/k).</p>
<p>If you can farm in your head or your basement, drop me a note and I will exempt you, with envy from this unit. For those of us who farm by the acre or section, however, the issue of data quality is an agonizing and sometimes subjective topic – but critical. Remember, most of our statistics are models, and the saying goes: “junk in, junk out.” Your models are only as good as the data you use to build them.</p>
<p>Part of your job as a researcher or end-user of any data, before you conduct or read the results from any test, is to ask yourself – are the data reliable enough to support the inferences? A trial with wildly-different experimental units may bias results – if all the replicates of one treatment end up in the better units and others are concentrated in the poorer ones. You may falsely recommend a product if you don’t catch this.</p>
<p>At the other extreme, the failure conduct research on similar experimental units will introduce background variance (or noise) that prevents a statistical test from concluding a difference is not the result of chance, even though the treatments are, in fact, different. In that case, you may fail to introduce – or adopt – a product or technology with real promise.</p>
<p>In this unit, we will first learn ways to inspect datasets for extreme values which, even given the inherent variability of data, may be suspect. Boxplots, histograms, and probability plots will be our tools for these exercises.</p>
<p>We will then address the uncomfortable question of what to do when we have missing data, either because a plot was compromised during the trial, or because we rejected that plot because its extreme value.</p>
<div id="inspecting-data-for-normal-distributions" class="section level2" number="9.1">
<h2><span class="header-section-number">9.1</span> Inspecting data for Normal Distributions</h2>
<p>I know, I know, it is so exciting to have data! The hard physical work of the research is done, the data is painstakingly entered into Excel. Let’s run the ANOVAs and regressions now – if we hurry we can still make it to happy hour!</p>
<p>It is so tempting to jump right into deep analyses as the data roll in. But it is important to realize these analyses are based on assumptions:</p>
<ul>
<li>That the observations for each treatment level are normally distributed around the treatment mean</li>
<li>That the variance or spread of observations around each level of treatment is roughly equal.</li>
<li>That experimental units are comparable among treatment levels, so that the treatment and error effects are appropriately separated.</li>
</ul>
<p>It is very possible, based on the nature of trials, that one or more of these assumptions may be violated. If you have ever counted weeds in a herbicide trial, you have noted that well-treated plots have weed counts that are consistently near zero – but that weedy checks have wildly variable counts (100, 200, 300 weeds). Growth analysis (where plants of different sizes are measured) is also prone to messy data issues, because variance in measurements increases numerically as plants grow. Experimental units (plots) in both commercial and research farm fields can vary because of prior management unknown to the researcher.</p>
<div id="histograms-1" class="section level3" number="9.1.1">
<h3><span class="header-section-number">9.1.1</span> Histograms</h3>
<p>In the very first unit of this course Unit 2, you were introduced to the histogram. Recall the histogram is a vertical bar chart in which the width of bars defines the different ranges into which observations are grouped, and the height represents the count or proportion of observations falling into each range.</p>
<p>In the data below, we have a dataset with 500 observations of corn yield. The mean is approximately 180. We can see the data distribution is approximately normal.</p>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb712-1"><a href="messy-and-missing-data.html#cb712-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code></pre></div>
<pre><code>## -- Attaching packages --------------------------------------- tidyverse 1.3.0 --</code></pre>
<pre><code>## v ggplot2 3.3.3     v purrr   0.3.4
## v tibble  3.1.0     v dplyr   1.0.5
## v tidyr   1.1.3     v stringr 1.4.0
## v readr   1.4.0     v forcats 0.5.1</code></pre>
<pre><code>## -- Conflicts ------------------------------------------ tidyverse_conflicts() --
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<div class="sourceCode" id="cb716"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb716-1"><a href="messy-and-missing-data.html#cb716-1" aria-hidden="true" tabindex="-1"></a><span class="co"># library(fGarch)</span></span>
<span id="cb716-2"><a href="messy-and-missing-data.html#cb716-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb716-3"><a href="messy-and-missing-data.html#cb716-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">082720</span>)</span>
<span id="cb716-4"><a href="messy-and-missing-data.html#cb716-4" aria-hidden="true" tabindex="-1"></a>norm_data <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">obs_value =</span> <span class="fu">rnorm</span>(<span class="dv">500</span>, <span class="at">mean=</span><span class="dv">180</span>, <span class="at">sd=</span><span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb716-5"><a href="messy-and-missing-data.html#cb716-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">dataset=</span><span class="st">&quot;normal&quot;</span>)</span>
<span id="cb716-6"><a href="messy-and-missing-data.html#cb716-6" aria-hidden="true" tabindex="-1"></a><span class="co"># set.seed(5)</span></span>
<span id="cb716-7"><a href="messy-and-missing-data.html#cb716-7" aria-hidden="true" tabindex="-1"></a><span class="co"># skewed_data = data.frame(obs_value = rsnorm(1000, mean = 20, sd = 10, xi = 100)) %&gt;%</span></span>
<span id="cb716-8"><a href="messy-and-missing-data.html#cb716-8" aria-hidden="true" tabindex="-1"></a><span class="co">#         mutate(dataset=&quot;skewed&quot;)</span></span>
<span id="cb716-9"><a href="messy-and-missing-data.html#cb716-9" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb716-10"><a href="messy-and-missing-data.html#cb716-10" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_and_skewed = rbind(norm_data, skewed_data) %&gt;%</span></span>
<span id="cb716-11"><a href="messy-and-missing-data.html#cb716-11" aria-hidden="true" tabindex="-1"></a><span class="co">#   as.data.frame() %&gt;%</span></span>
<span id="cb716-12"><a href="messy-and-missing-data.html#cb716-12" aria-hidden="true" tabindex="-1"></a><span class="co">#   dplyr::filter(obs_value&gt;0)</span></span>
<span id="cb716-13"><a href="messy-and-missing-data.html#cb716-13" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb716-14"><a href="messy-and-missing-data.html#cb716-14" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb716-15"><a href="messy-and-missing-data.html#cb716-15" aria-hidden="true" tabindex="-1"></a><span class="co"># write.csv(norm_and_skewed, &quot;data/norm_and_skewed.csv&quot;, row.names = FALSE)</span></span>
<span id="cb716-16"><a href="messy-and-missing-data.html#cb716-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb716-17"><a href="messy-and-missing-data.html#cb716-17" aria-hidden="true" tabindex="-1"></a><span class="co"># norm_and_skewed = read.csv(&quot;data/norm_and_skewed.csv&quot;)</span></span>
<span id="cb716-18"><a href="messy-and-missing-data.html#cb716-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb716-19"><a href="messy-and-missing-data.html#cb716-19" aria-hidden="true" tabindex="-1"></a>norm_data <span class="sc">%&gt;%</span></span>
<span id="cb716-20"><a href="messy-and-missing-data.html#cb716-20" aria-hidden="true" tabindex="-1"></a>        <span class="co"># filter(dataset==&quot;normal&quot;) %&gt;%</span></span>
<span id="cb716-21"><a href="messy-and-missing-data.html#cb716-21" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>obs_value)) <span class="sc">+</span></span>
<span id="cb716-22"><a href="messy-and-missing-data.html#cb716-22" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_histogram</span>(<span class="at">breaks =</span> <span class="fu">seq</span>(<span class="dv">160</span>,<span class="dv">200</span>,<span class="dv">2</span>), <span class="at">fill=</span><span class="st">&quot;darkolivegreen&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>)</span></code></pre></div>
<p><img src="09-Messy-and-Missing-Data_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>The summary data are shown below. We can see that the median and mean are both approximately 180 bushels per acre. We can also see the 1st and 3rd quantiles (equal to the 25th and 75th percentiles) are a little over three bushels from the median. The minimum and maximum observations are also similarly spaced from the median.</p>
<div class="sourceCode" id="cb717"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb717-1"><a href="messy-and-missing-data.html#cb717-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(norm_data<span class="sc">$</span>obs_value)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   164.9   176.8   180.2   180.0   183.4   194.2</code></pre>
<p>When we are dealing with data such as pest counts, our data may be non-normal. Rather than being symmetrical, the data may be skewed to one side or another. For example, in the dataset below, total velvetleaf dry weight in grams per square meter was measured. If you have worked like me with weed populations, you realize weed competitiveness is all about outracing the crop to the sun. If the weed loses, which it will in most cases, it will be small. But the proud few weeds who beat the crop will be huge. That is reflected in the data below.</p>
<div class="sourceCode" id="cb719"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb719-1"><a href="messy-and-missing-data.html#cb719-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(fGarch)</span></code></pre></div>
<pre><code>## Loading required package: timeDate</code></pre>
<pre><code>## Loading required package: timeSeries</code></pre>
<pre><code>## Loading required package: fBasics</code></pre>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb723-1"><a href="messy-and-missing-data.html#cb723-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">5</span>)</span>
<span id="cb723-2"><a href="messy-and-missing-data.html#cb723-2" aria-hidden="true" tabindex="-1"></a>velvetleaf_skewed <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">obs_value =</span> <span class="fu">rsnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">6</span>, <span class="at">sd =</span> <span class="dv">4</span>, <span class="at">xi =</span> <span class="dv">50</span>)) </span>
<span id="cb723-3"><a href="messy-and-missing-data.html#cb723-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb723-4"><a href="messy-and-missing-data.html#cb723-4" aria-hidden="true" tabindex="-1"></a>velvetleaf_skewed <span class="sc">%&gt;%</span></span>
<span id="cb723-5"><a href="messy-and-missing-data.html#cb723-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>obs_value)) <span class="sc">+</span></span>
<span id="cb723-6"><a href="messy-and-missing-data.html#cb723-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill=</span><span class="st">&quot;darkolivegreen&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">binwidth =</span> <span class="dv">1</span>) </span></code></pre></div>
<p><img src="09-Messy-and-Missing-Data_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p>When we look at the histogram, the data are skewed to the right. The histogram is not symmetrical.</p>
<div class="sourceCode" id="cb724"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb724-1"><a href="messy-and-missing-data.html#cb724-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(velvetleaf_skewed<span class="sc">$</span>obs_value)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##  0.7387  2.8225  5.0536  6.0104  8.3332 23.2785</code></pre>
<p>When we look at the summary data, we first notice the mean and median are different. For a dataset this size (1000 observations, we would expect them to be more similar.) We notice that the first quantile is closer to the median than the third quantile. The greatest indication the data is skewed, however, is is that the minimum is about 4 plants less than the median, while the maximum is about 18 plants greater.</p>
<p>Data like this may be transformed (mathematically re-scaled) so that it is more normal for analyses. We will cover this below.</p>
</div>
<div id="rank-percentile-plots" class="section level3" number="9.1.2">
<h3><span class="header-section-number">9.1.2</span> Rank Percentile Plots</h3>
<p>Another way to inspect the normality of datasets is to use a rank percentile plot. This plot uses the percentile rank of each observation, from lowest to highest, as the x-value of each point. The y-value of the point is its observed value.</p>
<p>The data for our normally-distributed corn yield dataset are plotted in the rank percentile plot below. Normally-distributed data tend to be strongly linear in the middle of the plot. If we draw a regression line through the plot, you can see most of the data are close to that line. The lowest percentile points fall below the line. That means they are a little lower in value than the normal distribution function might predict. The opposite is true of the highest percentile points. This indicates our distribution is a little bit wider than normal, but not enough that we cannot use it for analysis.</p>
<div class="sourceCode" id="cb726"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb726-1"><a href="messy-and-missing-data.html#cb726-1" aria-hidden="true" tabindex="-1"></a>norm_data <span class="sc">%&gt;%</span></span>
<span id="cb726-2"><a href="messy-and-missing-data.html#cb726-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">percent_rank</span>(obs_value)) <span class="sc">%&gt;%</span></span>
<span id="cb726-3"><a href="messy-and-missing-data.html#cb726-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>rank, <span class="at">y=</span>obs_value)) <span class="sc">+</span></span>
<span id="cb726-4"><a href="messy-and-missing-data.html#cb726-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="09-Messy-and-Missing-Data_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Our skewed data, however, shows up quite differently in the rank percentile plot. We can see that most of the data closely fit a line. But starting around the 75th percentile, the observed values are much greater than the predicted values – almost twice as much. This means the distribution is much wider to the right of the distribution curve than to the left, and that the data are non-normal</p>
<div class="sourceCode" id="cb727"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb727-1"><a href="messy-and-missing-data.html#cb727-1" aria-hidden="true" tabindex="-1"></a>velvetleaf_skewed <span class="sc">%&gt;%</span></span>
<span id="cb727-2"><a href="messy-and-missing-data.html#cb727-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">percent_rank</span>(obs_value)) <span class="sc">%&gt;%</span></span>
<span id="cb727-3"><a href="messy-and-missing-data.html#cb727-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>rank, <span class="at">y=</span>obs_value)) <span class="sc">+</span></span>
<span id="cb727-4"><a href="messy-and-missing-data.html#cb727-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>() </span></code></pre></div>
<p><img src="09-Messy-and-Missing-Data_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="box-plots" class="section level3" number="9.1.3">
<h3><span class="header-section-number">9.1.3</span> Box Plots</h3>
<p>The first two methods I have shown you, the histogram and rank percentile plots, are useful if you have a few treatments with a large number of replicates. They are taught in every statistics course and you should know about them. But, in my experience, they are not useful if you have a trial with fewer replications. A normal distribution is not going to appear in a histogram if you only have four replicates – instead you will just see the four individual measurements.</p>
<p>Box plots, on the other hand, are very useful for inspecting multiple treatments. In the plot below, boxplots for four corn treatments are shown. The treatments are labeled A, B, C, and D. The data are plotted so their treatments are listed along the vertical axis, and their values are listed along the y-axis.</p>
<div class="sourceCode" id="cb728"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb728-1"><a href="messy-and-missing-data.html#cb728-1" aria-hidden="true" tabindex="-1"></a>norm_data_mult_trts <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">trt =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>, <span class="st">&quot;D&quot;</span>), <span class="at">each=</span><span class="dv">4</span>),</span>
<span id="cb728-2"><a href="messy-and-missing-data.html#cb728-2" aria-hidden="true" tabindex="-1"></a>                                 <span class="at">mean =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">160</span>,<span class="dv">170</span>,<span class="dv">180</span>,<span class="dv">190</span>), <span class="at">each=</span><span class="dv">4</span>)) </span>
<span id="cb728-3"><a href="messy-and-missing-data.html#cb728-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb728-4"><a href="messy-and-missing-data.html#cb728-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">082720</span>)</span>
<span id="cb728-5"><a href="messy-and-missing-data.html#cb728-5" aria-hidden="true" tabindex="-1"></a>norm_data_mult_trts <span class="ot">=</span> norm_data_mult_trts <span class="sc">%&gt;%</span></span>
<span id="cb728-6"><a href="messy-and-missing-data.html#cb728-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">error =</span> <span class="fu">rnorm</span>(<span class="dv">16</span>, <span class="dv">0</span>, <span class="dv">5</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb728-7"><a href="messy-and-missing-data.html#cb728-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yield =</span> mean <span class="sc">+</span> error) <span class="sc">%&gt;%</span></span>
<span id="cb728-8"><a href="messy-and-missing-data.html#cb728-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create outlier</span></span>
<span id="cb728-9"><a href="messy-and-missing-data.html#cb728-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yield =</span> <span class="fu">if_else</span>(<span class="fu">row_number</span>()<span class="sc">==</span><span class="dv">8</span>, <span class="dv">195</span>, yield))</span>
<span id="cb728-10"><a href="messy-and-missing-data.html#cb728-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb728-11"><a href="messy-and-missing-data.html#cb728-11" aria-hidden="true" tabindex="-1"></a>norm_data_mult_trts <span class="sc">%&gt;%</span></span>
<span id="cb728-12"><a href="messy-and-missing-data.html#cb728-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>trt, <span class="at">y=</span>yield)) <span class="sc">+</span> </span>
<span id="cb728-13"><a href="messy-and-missing-data.html#cb728-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape=</span><span class="dv">16</span>,</span>
<span id="cb728-14"><a href="messy-and-missing-data.html#cb728-14" aria-hidden="true" tabindex="-1"></a>             <span class="at">outlier.size=</span><span class="dv">2</span>, <span class="at">notch=</span><span class="cn">FALSE</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb728-15"><a href="messy-and-missing-data.html#cb728-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb728-16"><a href="messy-and-missing-data.html#cb728-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">&quot;point&quot;</span>, <span class="at">shape=</span><span class="dv">23</span>, <span class="at">size=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="09-Messy-and-Missing-Data_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>The boxplots help us understand the distribution of the data. Lets start with the box, which tells about the spread of the data. The left side of the box is the 25th percentile, the line in the middle is the 50th percentile (or median), and the right side of the box is the 75th percentile. So the box shows us the spread of the middle half of the observations for each treatment.</p>
<p>The diamond shown within the box is the mean. In a normal distribution, the median and mean should be close.</p>
<p>The lines extending from the left and right side of the box are called whiskers. The whiskers extend to the lowest and highest observations for a treatment. The whiskers extend no more more than 1.5 times the <em>inter-quartile range</em>, which for the lower whisker is the the difference between the 25th and 50th percentiles, and for the upper whisker is the difference between the 50th and 75th percentiles.</p>
<p>In treatment B, we can see the upper whisker is missing, and instead there is a point to the right of the bar. If an observation is beyond 1.5 times the interquartile range, the whisker is not shown and the observation is instead represented by a point. This observation is called an <em>outlier</em>, meaning that it outside the range of values expected in a normal distribution. We will talk more about outliers in the next section.</p>
<p>The boxplot tells us something beyond the distribution of the individual treatments. If the boxes are markedly different in their width, the data may have substantially different variances. We should investigate these further using a <em>mean-variance plot</em>, and perhaps a statistical <em>test of heterogeneity</em>.</p>
</div>
</div>
<div id="inspecting-data-for-equal-variances" class="section level2" number="9.2">
<h2><span class="header-section-number">9.2</span> Inspecting Data for Equal Variances</h2>
<p>So far, we have learned to use the t-test and analysis of variance to test named treatments (that is, hybrids, management practices, and other products that can be described by name). These tests generally assume not only that observed values are normally distributed, but that the variances are approximately equal among the different treatments in our experiment. If the variances are unequal, we may calculate least significant differences (LSDs) or honest significant differences (HSDs) that are inappropriate. Among treatments that have smaller variances, our LSD or HSD may be overestimated; among treatments that have larger variances, the LSD or HSD may be underestimated.</p>
<p>The visual inspection of individual treatment distributions in the box plot above, followed by a scatter plot of the treatment variances versus their means, can give us a visual sense of unequal variances. These suspicions can then be tested using a Test for Homogeneity that calculates the probability of differences in variances as greater as those observed.</p>
<div id="mean-variance-plot" class="section level3" number="9.2.1">
<h3><span class="header-section-number">9.2.1</span> Mean-Variance Plot</h3>
<p>In a mean-variance plot, the treatment means are plotted along the horizontal axis and the variances are plotted along the vertical axis. The plot for the corn yield dataset we have used so far is shown below.</p>
<div class="sourceCode" id="cb729"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb729-1"><a href="messy-and-missing-data.html#cb729-1" aria-hidden="true" tabindex="-1"></a>norm_stats <span class="ot">=</span> norm_data_mult_trts <span class="sc">%&gt;%</span></span>
<span id="cb729-2"><a href="messy-and-missing-data.html#cb729-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(trt) <span class="sc">%&gt;%</span></span>
<span id="cb729-3"><a href="messy-and-missing-data.html#cb729-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">summarise</span>(<span class="at">mean=</span><span class="fu">mean</span>(yield),</span>
<span id="cb729-4"><a href="messy-and-missing-data.html#cb729-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">var=</span><span class="fu">var</span>(yield)) <span class="sc">%&gt;%</span></span>
<span id="cb729-5"><a href="messy-and-missing-data.html#cb729-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ungroup</span>()</span>
<span id="cb729-6"><a href="messy-and-missing-data.html#cb729-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb729-7"><a href="messy-and-missing-data.html#cb729-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb729-8"><a href="messy-and-missing-data.html#cb729-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>norm_stats, <span class="fu">aes</span>(<span class="at">x=</span>mean, <span class="at">y=</span>var)) <span class="sc">+</span></span>
<span id="cb729-9"><a href="messy-and-missing-data.html#cb729-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>trt), <span class="at">size=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="09-Messy-and-Missing-Data_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
<p>We can see the variance of treatment B is many times greater than that of the other treatments. In general, we like to see the variances differ by no more than a factor of 2.</p>
<p>In cases where we are dealing with populations that either “thrive or die” based on environment – particularly pest populations – we may see relationships between the mean and variance. Pest count data is often like this. In our velvetleaf counts, for example, we might find that our greater treatment means are also associated with greater variations in counts between plots.</p>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb730-1"><a href="messy-and-missing-data.html#cb730-1" aria-hidden="true" tabindex="-1"></a>rnorm2 <span class="ot">&lt;-</span> <span class="cf">function</span>(n,mean,sd) { mean<span class="sc">+</span>sd<span class="sc">*</span><span class="fu">scale</span>(<span class="fu">rnorm</span>(n)) }</span>
<span id="cb730-2"><a href="messy-and-missing-data.html#cb730-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">rnorm2</span>(<span class="dv">100</span>,<span class="dv">4</span>,<span class="dv">1</span>)</span>
<span id="cb730-3"><a href="messy-and-missing-data.html#cb730-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(r)  <span class="do">## 4</span></span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb732-1"><a href="messy-and-missing-data.html#cb732-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(r)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb734-1"><a href="messy-and-missing-data.html#cb734-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb734-2"><a href="messy-and-missing-data.html#cb734-2" aria-hidden="true" tabindex="-1"></a>norm_data_prop_var <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">A =</span> <span class="fu">rnorm2</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="fu">sqrt</span>(<span class="dv">2</span>)),</span>
<span id="cb734-3"><a href="messy-and-missing-data.html#cb734-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">B =</span> <span class="fu">rnorm2</span>(<span class="dv">4</span>, <span class="dv">10</span>, <span class="fu">sqrt</span>(<span class="dv">6</span>)),</span>
<span id="cb734-4"><a href="messy-and-missing-data.html#cb734-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">C =</span> <span class="fu">rnorm2</span>(<span class="dv">4</span>, <span class="dv">15</span>, <span class="fu">sqrt</span>(<span class="dv">10</span>)),</span>
<span id="cb734-5"><a href="messy-and-missing-data.html#cb734-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">D =</span> <span class="fu">rnorm2</span>(<span class="dv">4</span>, <span class="dv">20</span>, <span class="fu">sqrt</span>(<span class="dv">14</span>))) <span class="sc">%&gt;%</span></span>
<span id="cb734-6"><a href="messy-and-missing-data.html#cb734-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(trt, yield)</span>
<span id="cb734-7"><a href="messy-and-missing-data.html#cb734-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb734-8"><a href="messy-and-missing-data.html#cb734-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb734-9"><a href="messy-and-missing-data.html#cb734-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb734-10"><a href="messy-and-missing-data.html#cb734-10" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb734-11"><a href="messy-and-missing-data.html#cb734-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb734-12"><a href="messy-and-missing-data.html#cb734-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb734-13"><a href="messy-and-missing-data.html#cb734-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb734-14"><a href="messy-and-missing-data.html#cb734-14" aria-hidden="true" tabindex="-1"></a>norm_data_prop_var <span class="sc">%&gt;%</span></span>
<span id="cb734-15"><a href="messy-and-missing-data.html#cb734-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>trt, <span class="at">y=</span>yield)) <span class="sc">+</span> </span>
<span id="cb734-16"><a href="messy-and-missing-data.html#cb734-16" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape=</span><span class="dv">16</span>,</span>
<span id="cb734-17"><a href="messy-and-missing-data.html#cb734-17" aria-hidden="true" tabindex="-1"></a>             <span class="at">outlier.size=</span><span class="dv">2</span>, <span class="at">notch=</span><span class="cn">FALSE</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb734-18"><a href="messy-and-missing-data.html#cb734-18" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb734-19"><a href="messy-and-missing-data.html#cb734-19" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">&quot;point&quot;</span>, <span class="at">shape=</span><span class="dv">23</span>, <span class="at">size=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="09-Messy-and-Missing-Data_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<p>In this case, the mean-variance plot may show a linear relationship between variance and mean.</p>
<div class="sourceCode" id="cb735"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb735-1"><a href="messy-and-missing-data.html#cb735-1" aria-hidden="true" tabindex="-1"></a>norm_data_prop_var_stats <span class="ot">=</span> norm_data_prop_var <span class="sc">%&gt;%</span></span>
<span id="cb735-2"><a href="messy-and-missing-data.html#cb735-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(trt) <span class="sc">%&gt;%</span></span>
<span id="cb735-3"><a href="messy-and-missing-data.html#cb735-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">summarise</span>(<span class="at">mean=</span><span class="fu">mean</span>(yield),</span>
<span id="cb735-4"><a href="messy-and-missing-data.html#cb735-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">var=</span><span class="fu">var</span>(yield)) <span class="sc">%&gt;%</span></span>
<span id="cb735-5"><a href="messy-and-missing-data.html#cb735-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ungroup</span>()</span>
<span id="cb735-6"><a href="messy-and-missing-data.html#cb735-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb735-7"><a href="messy-and-missing-data.html#cb735-7" aria-hidden="true" tabindex="-1"></a>norm_data_prop_var_stats <span class="sc">%&gt;%</span></span>
<span id="cb735-8"><a href="messy-and-missing-data.html#cb735-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>mean, <span class="at">y=</span>var)) <span class="sc">+</span></span>
<span id="cb735-9"><a href="messy-and-missing-data.html#cb735-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>trt), <span class="at">size=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="09-Messy-and-Missing-Data_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>Finally, we may observe a dataset in which the distributions not only increase with means, but seem to do so exponentially.</p>
<div class="sourceCode" id="cb736"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb736-1"><a href="messy-and-missing-data.html#cb736-1" aria-hidden="true" tabindex="-1"></a>rnorm2 <span class="ot">&lt;-</span> <span class="cf">function</span>(n,mean,sd) { mean<span class="sc">+</span>sd<span class="sc">*</span><span class="fu">scale</span>(<span class="fu">rnorm</span>(n)) }</span>
<span id="cb736-2"><a href="messy-and-missing-data.html#cb736-2" aria-hidden="true" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">rnorm2</span>(<span class="dv">100</span>,<span class="dv">4</span>,<span class="dv">1</span>)</span>
<span id="cb736-3"><a href="messy-and-missing-data.html#cb736-3" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(r)  <span class="do">## 4</span></span></code></pre></div>
<pre><code>## [1] 4</code></pre>
<div class="sourceCode" id="cb738"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb738-1"><a href="messy-and-missing-data.html#cb738-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sd</span>(r)</span></code></pre></div>
<pre><code>## [1] 1</code></pre>
<div class="sourceCode" id="cb740"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb740-1"><a href="messy-and-missing-data.html#cb740-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">3</span>)</span>
<span id="cb740-2"><a href="messy-and-missing-data.html#cb740-2" aria-hidden="true" tabindex="-1"></a>norm_data_prop_sd <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">A =</span> <span class="fu">rnorm2</span>(<span class="dv">4</span>, <span class="dv">5</span>, <span class="fl">0.3</span>),</span>
<span id="cb740-3"><a href="messy-and-missing-data.html#cb740-3" aria-hidden="true" tabindex="-1"></a>                                <span class="at">B =</span> <span class="fu">rnorm2</span>(<span class="dv">4</span>, <span class="dv">10</span>, <span class="fl">2.5</span>),</span>
<span id="cb740-4"><a href="messy-and-missing-data.html#cb740-4" aria-hidden="true" tabindex="-1"></a>                                <span class="at">C =</span> <span class="fu">rnorm2</span>(<span class="dv">4</span>, <span class="dv">15</span>, <span class="fl">4.7</span>),</span>
<span id="cb740-5"><a href="messy-and-missing-data.html#cb740-5" aria-hidden="true" tabindex="-1"></a>                                <span class="at">D =</span> <span class="fu">rnorm2</span>(<span class="dv">4</span>, <span class="dv">20</span>, <span class="fl">6.9</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb740-6"><a href="messy-and-missing-data.html#cb740-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(trt, yield)</span>
<span id="cb740-7"><a href="messy-and-missing-data.html#cb740-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb740-8"><a href="messy-and-missing-data.html#cb740-8" aria-hidden="true" tabindex="-1"></a>norm_data_prop_sd <span class="sc">%&gt;%</span></span>
<span id="cb740-9"><a href="messy-and-missing-data.html#cb740-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>trt, <span class="at">y=</span>yield)) <span class="sc">+</span> </span>
<span id="cb740-10"><a href="messy-and-missing-data.html#cb740-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape=</span><span class="dv">16</span>,</span>
<span id="cb740-11"><a href="messy-and-missing-data.html#cb740-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">outlier.size=</span><span class="dv">2</span>, <span class="at">notch=</span><span class="cn">FALSE</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb740-12"><a href="messy-and-missing-data.html#cb740-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb740-13"><a href="messy-and-missing-data.html#cb740-13" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">&quot;point&quot;</span>, <span class="at">shape=</span><span class="dv">23</span>, <span class="at">size=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="09-Messy-and-Missing-Data_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<p>In this case, the mean-variance plot may show a curved relationship between variance and mean.</p>
<div class="sourceCode" id="cb741"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb741-1"><a href="messy-and-missing-data.html#cb741-1" aria-hidden="true" tabindex="-1"></a>s_norm_stats <span class="ot">=</span> norm_data_prop_sd <span class="sc">%&gt;%</span></span>
<span id="cb741-2"><a href="messy-and-missing-data.html#cb741-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">group_by</span>(trt) <span class="sc">%&gt;%</span></span>
<span id="cb741-3"><a href="messy-and-missing-data.html#cb741-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">summarise</span>(<span class="at">mean=</span><span class="fu">mean</span>(yield),</span>
<span id="cb741-4"><a href="messy-and-missing-data.html#cb741-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">var=</span><span class="fu">var</span>(yield),</span>
<span id="cb741-5"><a href="messy-and-missing-data.html#cb741-5" aria-hidden="true" tabindex="-1"></a>                <span class="at">sd=</span><span class="fu">sd</span>(yield)) <span class="sc">%&gt;%</span></span>
<span id="cb741-6"><a href="messy-and-missing-data.html#cb741-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ungroup</span>()</span>
<span id="cb741-7"><a href="messy-and-missing-data.html#cb741-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb741-8"><a href="messy-and-missing-data.html#cb741-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb741-9"><a href="messy-and-missing-data.html#cb741-9" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>s_norm_stats, <span class="fu">aes</span>(<span class="at">x=</span>mean, <span class="at">y=</span>var)) <span class="sc">+</span></span>
<span id="cb741-10"><a href="messy-and-missing-data.html#cb741-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>trt), <span class="at">size=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="09-Messy-and-Missing-Data_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
<p>We may want to check whether the standard deviation has a more linear relationship to mean.</p>
<div class="sourceCode" id="cb742"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb742-1"><a href="messy-and-missing-data.html#cb742-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>s_norm_stats, <span class="fu">aes</span>(<span class="at">x=</span>mean, <span class="at">y=</span>sd)) <span class="sc">+</span></span>
<span id="cb742-2"><a href="messy-and-missing-data.html#cb742-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>trt), <span class="at">size=</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="09-Messy-and-Missing-Data_files/figure-html/unnamed-chunk-14-1.png" width="672" />
The largest mean has a significant difference of 6.9, while the smallest mean has a significant difference of 0.3. In other words, the largest significant difference is 23 times the smallest significant difference.</p>
</div>
<div id="homogeneity-of-variance-tests" class="section level3" number="9.2.2">
<h3><span class="header-section-number">9.2.2</span> Homogeneity of Variance Tests</h3>
<p>In previous units, we learned how to compare two variances – using the F-test. In the Analysis of Variance, we tested whether the variance among treatment means was greater than the variance within treatments. If the treatment variance was sufficiently greater than the error variance, we concluded the treatment effect explained a significant amount of the variation in observed values.</p>
<p>In this unit, we want to do something similar – we want to compare the variances associated with multiple treatments to see if they are significantly different. When data are normally-distributed, the method for comparing multiple variances is <em>Bartlett’s Test</em>. (If you continue your statistical travels, you may come across Levene’s Test, but that is for non-normal data.)</p>
<p>Bartlett’s test, as best as I can tell (the formula is awful and no one seems willing to explain it), acts like a sum of squares for variances, comparing the variances of the individual treatments to their mean when pooled together. This is an incomplete explanation, but I hope it will satisfy the curious. Fortunately for us, the test is easy to implement in R and the output simple.</p>
<p>If we run Bartlett’s test on our corn data above, we get the following results.</p>
<div class="sourceCode" id="cb743"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb743-1"><a href="messy-and-missing-data.html#cb743-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(yield<span class="sc">~</span>trt, norm_data_mult_trts)</span></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  yield by trt
## Bartlett&#39;s K-squared = 10.355, df = 3, p-value = 0.01578</code></pre>
<p>Let’s go through the output. “Bartlett’s K-squared” is the statistic produced by the nasty formula I referenced above. Don’t worry about that. The degrees of freedom refers to the four treatments whose variances we are comparing. Most important, of course, is our p-value. There are many opinions on when to transform data – but I would recommend against transforming data unless the –value is less than 0.01. I would also recommend running your data on both the transformed and untransformed data and comparing results. If transformation does not change your inferences, then skip it.</p>
<p>Here is the Bartlett’s test on our velevleaf data where the mean and standard deviation were linearly related:</p>
<div class="sourceCode" id="cb745"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb745-1"><a href="messy-and-missing-data.html#cb745-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(yield<span class="sc">~</span>trt, norm_data_prop_sd)</span></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  yield by trt
## Bartlett&#39;s K-squared = 14.217, df = 3, p-value = 0.002625</code></pre>
<p>In this case, we will want to analyze both the transformed and untransformed data before deciding which to us for our final inferences.</p>
</div>
</div>
<div id="dealing-with-messy-data" class="section level2" number="9.3">
<h2><span class="header-section-number">9.3</span> Dealing with Messy Data</h2>
<p>Dealing with messy data is one of the more uncomfortable aspects of statistics, but also one of the most important. Our tests and summary statistics are based on assumptions. For tests, we assume the data are from a populations that have approximately normal distributions. We also assume they have variances that are equal – otherwise our mean separation tests will fail.</p>
<p>And finally, and this is a concept that I learned just while writing this: the validity of our inferences is based on the assumption that our samples represent the population that we are studying. Which brings us back to outliers.</p>
<div id="outliers" class="section level3" number="9.3.1">
<h3><span class="header-section-number">9.3.1</span> Outliers</h3>
<p>Outliers can have a powerful effect in skewing data. Particularly in smaller datasets (i.e. fewer than 10 replicates per treatment), an outlier can have noticeable effects on a distribution’s normality and its variance. In regression analyses, one outlier can significantly change the slope of the model.</p>
<p>Does this mean that outliers should be omitted from the dataset? Not necessarily – first we should inspect the data more closely. The outlier might be a mistake in recording a measurement. It could be an inconsistent scale in a combine. These would be experimental errors that mean the outlier is an <em>artifact</em> of our methods, rather than a representative sample from our population. In that case, we may want to remove that observation from our dataset.</p>
<p>But investigating the outlier may also include examining the location where it was taken. This can be difficult if you are not the primary researcher and on-site where the data were gathered. But if you can overlay your plot map with a soils map, or work with aerial imagery, or examine as-applied maps, you may be able to identify differences in environment or management that caused a dramatic difference in the observed value.</p>
<p>In such a case, you may decide that plot did not represent the environment about which you were trying to draw inferences, and choose to omit it from the dataset. At the same time, however, knowing that the outlier’s environment or management had a dramatic effect on its performance, you may generate new hypotheses about that product. In fact, you may learn more from your outlier, through the new research it inspires, than you do from the original experiment.</p>
<p>Also, before removing an outlier, it is a good idea to run your tests with and without it to see whether it changes your conclusions. When you run your model, look at the standardized residuals. How many standard errors is the outlier from the predicted value? As a rule, if an observed value is more than two standard deviations from the predicted value, I scrutinize it before allowing it into the final analysis.</p>
<p>If you are comparing different treatments, does it change the significance of tests or differences among treatments? If you are generating a regression model, does the change in slope have a dramatic effect on the values you will predict? Will the change in slope have a dramatic effect on grower inputs and cost, or will the effect be more modest?</p>
<p>These are important questions, because as uncomfortable as it is to identify and/or remove outliers, working with incomplete datasets can be even nastier. If the statistical significance of tests or means separations are not affected by the outlier, it is best to leave it in the dataset if possible, especially if treatment replications are limited.</p>
</div>
<div id="non-normal-data-and-unequal-variances" class="section level3" number="9.3.2">
<h3><span class="header-section-number">9.3.2</span> Non-normal Data and Unequal Variances</h3>
<p>Above, we discussed two other problems with data: data that were skewed (or non-normal) and therefore could not be modelled based on the normal distribution, and data were treatment variances were not equal – they were, in statistical terminology, they suffered from <em>heterogeneity of variances</em>.</p>
<p>Both issues can arise out of trials where observation values vary widely: counts that include rare events or where one treatment (like a check plot) can “blow up” and have a huge value. Growth studies, where size increases occur at exponential rates, are another.</p>
<p>These two issues may be similarly addressed by transforming the data. When we transform data, we use a different measuring system to rescale it. The easiest example of rescaling data is pH. Recall pH is the concentration of hydrogen atoms in a solution. This concentration can range from <span class="math inline">\(0\)</span> to <span class="math inline">\(10^{-14}\)</span></p>
<p>So when is the last time you read that your soil pH was <span class="math inline">\(6.5 \times 10^{-6}\)</span> ? You wouldnt. We commonly speak of pH as ranging from 1 (highly acidic) through 7 (neutral) to 14 (highly basic). Your are used to using the logarithmic scale(10, 1, 0.10, 0.010), rather than the arithmatic scale (1,2,3,4,5). The decibel scale for sound and the Richter scale for earthquakes also use the logarithmic scale.</p>
<div id="natural-logarithm" class="section level4" number="9.3.2.1">
<h4><span class="header-section-number">9.3.2.1</span> Natural Logarithm</h4>
<p>There are several ways to transform data, but the one I have most-often used is the natural logarithm
The natural logaritm transformation is often used when we are working with data that have a wide range of values. What constitutes a wide range of values? Think growth analysis, or counts of common events (for example, weed counts in a herbicide trial that includes treatments that vary widely in effectiveness). In these trials, it is not uncommon for observed values to vary by two or more orders of magnitude (powers of 10).</p>
<p>Our process for working with transformed data is as follows:</p>
<ul>
<li>Transform the original observations to their natural logs.<br />
</li>
<li>Calculate the ANOVA</li>
<li>Cacluate treatment means using transformed data</li>
<li>Back-transform the treatment means to the original measurement scale so they are more intuitive to users</li>
</ul>
<p>Lets work with our velvetleaf data above. Below is the analysis of variance and means separation using the least significant difference test.</p>
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb747-1"><a href="messy-and-missing-data.html#cb747-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;agricolae&#39;</code></pre>
<pre><code>## The following objects are masked from &#39;package:timeDate&#39;:
## 
##     kurtosis, skewness</code></pre>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb750-1"><a href="messy-and-missing-data.html#cb750-1" aria-hidden="true" tabindex="-1"></a>vleaf_model_before <span class="ot">=</span> <span class="fu">aov</span>(yield<span class="sc">~</span>trt, norm_data_prop_sd)</span>
<span id="cb750-2"><a href="messy-and-missing-data.html#cb750-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vleaf_model_before)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value  Pr(&gt;F)   
## trt          3  500.0  166.67   8.767 0.00237 **
## Residuals   12  228.1   19.01                   
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb752"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb752-1"><a href="messy-and-missing-data.html#cb752-1" aria-hidden="true" tabindex="-1"></a>lsd_before <span class="ot">=</span> <span class="fu">LSD.test</span>(vleaf_model_before, <span class="st">&quot;trt&quot;</span>)</span>
<span id="cb752-2"><a href="messy-and-missing-data.html#cb752-2" aria-hidden="true" tabindex="-1"></a>lsd_before<span class="sc">$</span>groups</span></code></pre></div>
<pre><code>##   yield groups
## D    20      a
## C    15     ab
## B    10     bc
## A     5      c</code></pre>
<p>The treatment effect is significant, and some of the treatments are significantly different from each other, but there are also noticeable overlaps.</p>
<p>Now let’s transform the data using the natural log. The original and transformed data are show below.</p>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb754-1"><a href="messy-and-missing-data.html#cb754-1" aria-hidden="true" tabindex="-1"></a>vleaf_log <span class="ot">=</span> norm_data_prop_sd <span class="sc">%&gt;%</span></span>
<span id="cb754-2"><a href="messy-and-missing-data.html#cb754-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_yield =</span> <span class="fu">log</span>(yield))</span>
<span id="cb754-3"><a href="messy-and-missing-data.html#cb754-3" aria-hidden="true" tabindex="-1"></a>vleaf_log</span></code></pre></div>
<pre><code>##    trt     yield log_yield
## 1    A  4.802644  1.569167
## 2    A  5.113508  1.631886
## 3    A  5.369530  1.680740
## 4    A  4.714318  1.550604
## 5    B  9.211467  2.220449
## 6    B  8.401127  2.128366
## 7    B  8.671603  2.160054
## 8    B 13.715802  2.618549
## 9    C 11.933265  2.479330
## 10   C 21.939493  3.088288
## 11   C 13.841261  2.627654
## 12   C 12.285982  2.508459
## 13   D 11.328175  2.427293
## 14   D 26.292831  3.269296
## 15   D 24.739139  3.208387
## 16   D 17.639854  2.870161</code></pre>
<p>Now when we run our Bartlett’s test, we see the p-value is 0.09 – there is no longer a significant difference among the treatment variances.</p>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb756-1"><a href="messy-and-missing-data.html#cb756-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(log_yield<span class="sc">~</span>trt, vleaf_log)</span></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  log_yield by trt
## Bartlett&#39;s K-squared = 6.4701, df = 3, p-value = 0.09085</code></pre>
<p>The largest standard deviation is still 6.5 times the smallest standard deviation – but the difference has decreased dramatically. When we run our analysis of variance, we see that our p-value has decreased by several orders of magniture.</p>
<div class="sourceCode" id="cb758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb758-1"><a href="messy-and-missing-data.html#cb758-1" aria-hidden="true" tabindex="-1"></a>vleaf_model_after <span class="ot">=</span> <span class="fu">aov</span>(log_yield<span class="sc">~</span>trt, vleaf_log)</span>
<span id="cb758-2"><a href="messy-and-missing-data.html#cb758-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(vleaf_model_after)</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## trt          3  4.043  1.3478   18.95 7.58e-05 ***
## Residuals   12  0.853  0.0711                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>When we run our LSD test, we notice more significant differences among the means, especially treatments A and B, which were associated with lower treatment means.</p>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="messy-and-missing-data.html#cb760-1" aria-hidden="true" tabindex="-1"></a>lsd_after <span class="ot">=</span> <span class="fu">LSD.test</span>(vleaf_model_after, <span class="st">&quot;trt&quot;</span>)</span>
<span id="cb760-2"><a href="messy-and-missing-data.html#cb760-2" aria-hidden="true" tabindex="-1"></a>lsd_after<span class="sc">$</span>groups</span></code></pre></div>
<pre><code>##   log_yield groups
## D  2.943784      a
## C  2.675933     ab
## B  2.281854      b
## A  1.608099      c</code></pre>
<p>Our last step is to back-transform the means from our LSD test.</p>
<div class="sourceCode" id="cb762"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb762-1"><a href="messy-and-missing-data.html#cb762-1" aria-hidden="true" tabindex="-1"></a>back_transformed_means <span class="ot">=</span> lsd_after<span class="sc">$</span>groups <span class="sc">%&gt;%</span></span>
<span id="cb762-2"><a href="messy-and-missing-data.html#cb762-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">&quot;treatment&quot;</span>) <span class="sc">%&gt;%</span></span>
<span id="cb762-3"><a href="messy-and-missing-data.html#cb762-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yield =</span> <span class="fu">exp</span>(log_yield))</span>
<span id="cb762-4"><a href="messy-and-missing-data.html#cb762-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb762-5"><a href="messy-and-missing-data.html#cb762-5" aria-hidden="true" tabindex="-1"></a>back_transformed_means <span class="sc">%&gt;%</span></span>
<span id="cb762-6"><a href="messy-and-missing-data.html#cb762-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(treatment, yield, groups)</span></code></pre></div>
<pre><code>##   treatment     yield groups
## 1         D 18.987563      a
## 2         C 14.525893     ab
## 3         B  9.794827      b
## 4         A  4.993311      c</code></pre>
<p>In the above table, we have back-transformed the means in our LSD table to their original scale.</p>
</div>
</div>
</div>
<div id="dealing-with-missing-data" class="section level2" number="9.4">
<h2><span class="header-section-number">9.4</span> Dealing with Missing Data</h2>
<p>Missing data can be very problematic. Whether missing data are the result of deleting outliers, or plots lost to weather or human damage, there are three options:</p>
<ul>
<li>Drop the treatment entirely from the dataset</li>
<li>Drop one observation from each of the other treatments; if a Randomized Complete Block Design was used, delete and entire block</li>
<li>Predict the value for the plot that was omitted or lost</li>
</ul>
<p>As you see, these are ugly choices to make. If you drop the treatment entirely from the dataset, you lose all ability to test it agaist the other treatments. If you drop other replicates or the remainder of a block, you retain all treatments but reduce the degrees of freedom for statistical tests, rendering them less sensitive.</p>
<p>The third option, predicting the value that is missing, comes with its own challenges. The missing value for a plot is generally calculated using the linear additive model. For a completely randomized design, the linear model is:</p>
<p><span class="math display">\[Y_{ij} = \mu + T_i + \epsilon_{(i)j} \]</span></p>
<p>So the missing value would be equal to <span class="math inline">\(\mu + Ti\)</span>, where <span class="math inline">\(i\)</span> would be whatever treatment level the missing plot received.</p>
<p>In a randomized complete block design, the the linear additive model is:</p>
<p><span class="math display">\[Y_{ij} = \mu + B_i + T_j + BT_{ij} \]</span></p>
<p>The missing value would be equal to <span class="math inline">\(\mu + B_i + T_j\)</span>, where <span class="math inline">\(i\)</span> is the block to which the missing plot occurred, and <span class="math inline">\(j\)</span> is the treatment the treatment the missing plot received.</p>
<p>Note that we did not include <span class="math inline">\(\epsilon_{(i)j}\)</span> or <span class="math inline">\(BT_{ij}\)</span> in estimating the missing values. Although this approach is widely used, this is a shortcome. When we predict a missing value from the effects of treatment or treatment within block, we are using <em>mean</em> effects. So the predicted value will be exactly the mean for a given treatment or treatment within block. Because the predicted value is closer to the treatment and block means than it would be otherwise, it will contribute less to the treatment variance than it would normally.</p>
<p>We can demonstrate this with a normally-distributed dataset.</p>
<div class="sourceCode" id="cb764"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb764-1"><a href="messy-and-missing-data.html#cb764-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">083020</span>)</span>
<span id="cb764-2"><a href="messy-and-missing-data.html#cb764-2" aria-hidden="true" tabindex="-1"></a>more_norm_data_1 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">yield =</span> <span class="fu">rnorm</span>(<span class="dv">4</span>, <span class="at">mean=</span><span class="dv">165</span>, <span class="at">sd=</span><span class="fl">5.2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb764-3"><a href="messy-and-missing-data.html#cb764-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">trt=</span><span class="st">&quot;A&quot;</span>)</span>
<span id="cb764-4"><a href="messy-and-missing-data.html#cb764-4" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">083021</span>)</span>
<span id="cb764-5"><a href="messy-and-missing-data.html#cb764-5" aria-hidden="true" tabindex="-1"></a>more_norm_data_2 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">yield =</span> <span class="fu">rnorm</span>(<span class="dv">4</span>, <span class="at">mean=</span><span class="dv">169</span>, <span class="at">sd=</span><span class="fl">5.2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb764-6"><a href="messy-and-missing-data.html#cb764-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">trt=</span><span class="st">&quot;B&quot;</span>)</span>
<span id="cb764-7"><a href="messy-and-missing-data.html#cb764-7" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">083022</span>)</span>
<span id="cb764-8"><a href="messy-and-missing-data.html#cb764-8" aria-hidden="true" tabindex="-1"></a>more_norm_data_3 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">yield =</span> <span class="fu">rnorm</span>(<span class="dv">4</span>, <span class="at">mean=</span><span class="dv">170</span>, <span class="at">sd=</span><span class="fl">5.2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb764-9"><a href="messy-and-missing-data.html#cb764-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">trt=</span><span class="st">&quot;C&quot;</span>)</span>
<span id="cb764-10"><a href="messy-and-missing-data.html#cb764-10" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">083023</span>)</span>
<span id="cb764-11"><a href="messy-and-missing-data.html#cb764-11" aria-hidden="true" tabindex="-1"></a>more_norm_data_4 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">yield =</span> <span class="fu">rnorm</span>(<span class="dv">4</span>, <span class="at">mean=</span><span class="dv">172</span>, <span class="at">sd=</span><span class="fl">5.2</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb764-12"><a href="messy-and-missing-data.html#cb764-12" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">trt=</span><span class="st">&quot;D&quot;</span>)</span>
<span id="cb764-13"><a href="messy-and-missing-data.html#cb764-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb764-14"><a href="messy-and-missing-data.html#cb764-14" aria-hidden="true" tabindex="-1"></a>more_norm_data <span class="ot">=</span> <span class="fu">rbind</span>(more_norm_data_1, more_norm_data_2, more_norm_data_3, more_norm_data_4) <span class="sc">%&gt;%</span></span>
<span id="cb764-15"><a href="messy-and-missing-data.html#cb764-15" aria-hidden="true" tabindex="-1"></a>        <span class="fu">mutate</span>(<span class="at">trt =</span> <span class="fu">as.factor</span>(trt)) <span class="sc">%&gt;%</span>   </span>
<span id="cb764-16"><a href="messy-and-missing-data.html#cb764-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">random_no =</span> <span class="fu">rnorm</span>(<span class="dv">16</span>,<span class="dv">0</span>,<span class="dv">1</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb764-17"><a href="messy-and-missing-data.html#cb764-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(random_no) <span class="sc">%&gt;%</span></span>
<span id="cb764-18"><a href="messy-and-missing-data.html#cb764-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">plot=</span><span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb764-19"><a href="messy-and-missing-data.html#cb764-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(plot, trt, yield) <span class="sc">%&gt;%</span></span>
<span id="cb764-20"><a href="messy-and-missing-data.html#cb764-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">yield =</span> <span class="fu">round</span>(yield,<span class="dv">1</span>))</span>
<span id="cb764-21"><a href="messy-and-missing-data.html#cb764-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb764-22"><a href="messy-and-missing-data.html#cb764-22" aria-hidden="true" tabindex="-1"></a>more_norm_data</span></code></pre></div>
<pre><code>##    plot trt yield
## 1     1   A 166.8
## 2     2   C 169.9
## 3     3   B 170.6
## 4     4   C 174.9
## 5     5   B 161.8
## 6     6   A 168.3
## 7     7   A 169.2
## 8     8   C 159.9
## 9     9   B 160.8
## 10   10   C 166.2
## 11   11   A 160.3
## 12   12   D 172.1
## 13   13   D 175.4
## 14   14   D 175.3
## 15   15   B 170.6
## 16   16   D 172.2</code></pre>
<p>Here is the anova for the original data:</p>
<div class="sourceCode" id="cb766"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb766-1"><a href="messy-and-missing-data.html#cb766-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(<span class="fu">lm</span>(yield<span class="sc">~</span>trt, <span class="at">data=</span>more_norm_data))</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)
## trt          3  160.6   53.52   2.418  0.117
## Residuals   12  265.6   22.13</code></pre>
<p>And here is the boxplot:</p>
<div class="sourceCode" id="cb768"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb768-1"><a href="messy-and-missing-data.html#cb768-1" aria-hidden="true" tabindex="-1"></a>more_norm_data <span class="sc">%&gt;%</span></span>
<span id="cb768-2"><a href="messy-and-missing-data.html#cb768-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>trt, <span class="at">y=</span>yield)) <span class="sc">+</span> </span>
<span id="cb768-3"><a href="messy-and-missing-data.html#cb768-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape=</span><span class="dv">16</span>,</span>
<span id="cb768-4"><a href="messy-and-missing-data.html#cb768-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">outlier.size=</span><span class="dv">2</span>, <span class="at">notch=</span><span class="cn">FALSE</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb768-5"><a href="messy-and-missing-data.html#cb768-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb768-6"><a href="messy-and-missing-data.html#cb768-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">&quot;point&quot;</span>, <span class="at">shape=</span><span class="dv">23</span>, <span class="at">size=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="09-Messy-and-Missing-Data_files/figure-html/unnamed-chunk-25-1.png" width="672" /></p>
<p>Here is the table with the treatment and error effects broken out. Unlike previous effects tables, I have also added the within treatment variance.</p>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb769-1"><a href="messy-and-missing-data.html#cb769-1" aria-hidden="true" tabindex="-1"></a>more_norm_data_effects <span class="ot">=</span> more_norm_data <span class="sc">%&gt;%</span></span>
<span id="cb769-2"><a href="messy-and-missing-data.html#cb769-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mu =</span> <span class="fu">mean</span>(yield)) <span class="sc">%&gt;%</span></span>
<span id="cb769-3"><a href="messy-and-missing-data.html#cb769-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trt) <span class="sc">%&gt;%</span></span>
<span id="cb769-4"><a href="messy-and-missing-data.html#cb769-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt_mean =</span> <span class="fu">mean</span>(yield),</span>
<span id="cb769-5"><a href="messy-and-missing-data.html#cb769-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">trt_var =</span> <span class="fu">var</span>(yield)) <span class="sc">%&gt;%</span></span>
<span id="cb769-6"><a href="messy-and-missing-data.html#cb769-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb769-7"><a href="messy-and-missing-data.html#cb769-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt_effect =</span> trt_mean <span class="sc">-</span> mu) <span class="sc">%&gt;%</span></span>
<span id="cb769-8"><a href="messy-and-missing-data.html#cb769-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">error_effect =</span> yield <span class="sc">-</span> trt_effect <span class="sc">-</span> mu) <span class="sc">%&gt;%</span></span>
<span id="cb769-9"><a href="messy-and-missing-data.html#cb769-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(plot, trt, yield, mu, trt_var, trt_effect, error_effect)</span>
<span id="cb769-10"><a href="messy-and-missing-data.html#cb769-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb769-11"><a href="messy-and-missing-data.html#cb769-11" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(more_norm_data_effects)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">plot</th>
<th align="left">trt</th>
<th align="right">yield</th>
<th align="right">mu</th>
<th align="right">trt_var</th>
<th align="right">trt_effect</th>
<th align="right">error_effect</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">A</td>
<td align="right">166.8</td>
<td align="right">168.3938</td>
<td align="right">16.190000</td>
<td align="right">-2.24375</td>
<td align="right">0.650</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">C</td>
<td align="right">169.9</td>
<td align="right">168.3938</td>
<td align="right">39.922500</td>
<td align="right">-0.66875</td>
<td align="right">2.175</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">B</td>
<td align="right">170.6</td>
<td align="right">168.3938</td>
<td align="right">28.996667</td>
<td align="right">-2.44375</td>
<td align="right">4.650</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">C</td>
<td align="right">174.9</td>
<td align="right">168.3938</td>
<td align="right">39.922500</td>
<td align="right">-0.66875</td>
<td align="right">7.175</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">B</td>
<td align="right">161.8</td>
<td align="right">168.3938</td>
<td align="right">28.996667</td>
<td align="right">-2.44375</td>
<td align="right">-4.150</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">A</td>
<td align="right">168.3</td>
<td align="right">168.3938</td>
<td align="right">16.190000</td>
<td align="right">-2.24375</td>
<td align="right">2.150</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="left">A</td>
<td align="right">169.2</td>
<td align="right">168.3938</td>
<td align="right">16.190000</td>
<td align="right">-2.24375</td>
<td align="right">3.050</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="left">C</td>
<td align="right">159.9</td>
<td align="right">168.3938</td>
<td align="right">39.922500</td>
<td align="right">-0.66875</td>
<td align="right">-7.825</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="left">B</td>
<td align="right">160.8</td>
<td align="right">168.3938</td>
<td align="right">28.996667</td>
<td align="right">-2.44375</td>
<td align="right">-5.150</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="left">C</td>
<td align="right">166.2</td>
<td align="right">168.3938</td>
<td align="right">39.922500</td>
<td align="right">-0.66875</td>
<td align="right">-1.525</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="left">A</td>
<td align="right">160.3</td>
<td align="right">168.3938</td>
<td align="right">16.190000</td>
<td align="right">-2.24375</td>
<td align="right">-5.850</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="left">D</td>
<td align="right">172.1</td>
<td align="right">168.3938</td>
<td align="right">3.416667</td>
<td align="right">5.35625</td>
<td align="right">-1.650</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="left">D</td>
<td align="right">175.4</td>
<td align="right">168.3938</td>
<td align="right">3.416667</td>
<td align="right">5.35625</td>
<td align="right">1.650</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="left">D</td>
<td align="right">175.3</td>
<td align="right">168.3938</td>
<td align="right">3.416667</td>
<td align="right">5.35625</td>
<td align="right">1.550</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="left">B</td>
<td align="right">170.6</td>
<td align="right">168.3938</td>
<td align="right">28.996667</td>
<td align="right">-2.44375</td>
<td align="right">4.650</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="left">D</td>
<td align="right">172.2</td>
<td align="right">168.3938</td>
<td align="right">3.416667</td>
<td align="right">5.35625</td>
<td align="right">-1.550</td>
</tr>
</tbody>
</table>
<p>Plot 8 has a greater error effect than most other plots. Let’s treat it as an outlier, delete it, and recalculate the treatment means. Let’s delete it and see how that changes the treatment effect for treatment C.</p>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb770-1"><a href="messy-and-missing-data.html#cb770-1" aria-hidden="true" tabindex="-1"></a>plot_8 <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">plot=</span><span class="dv">8</span> ,<span class="at">trt=</span><span class="st">&quot;C&quot;</span>, <span class="at">yield=</span><span class="cn">NA</span>)</span>
<span id="cb770-2"><a href="messy-and-missing-data.html#cb770-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb770-3"><a href="messy-and-missing-data.html#cb770-3" aria-hidden="true" tabindex="-1"></a>more_norm_data_interp <span class="ot">=</span> more_norm_data <span class="sc">%&gt;%</span></span>
<span id="cb770-4"><a href="messy-and-missing-data.html#cb770-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>plot<span class="sc">==</span><span class="dv">8</span>) <span class="sc">%&gt;%</span></span>
<span id="cb770-5"><a href="messy-and-missing-data.html#cb770-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(plot_8)  <span class="sc">%&gt;%</span></span>
<span id="cb770-6"><a href="messy-and-missing-data.html#cb770-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(plot) <span class="sc">%&gt;%</span></span>
<span id="cb770-7"><a href="messy-and-missing-data.html#cb770-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mu =</span> <span class="fu">mean</span>(yield, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb770-8"><a href="messy-and-missing-data.html#cb770-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trt) <span class="sc">%&gt;%</span></span>
<span id="cb770-9"><a href="messy-and-missing-data.html#cb770-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt_mean =</span> <span class="fu">mean</span>(yield, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb770-10"><a href="messy-and-missing-data.html#cb770-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">trt_var =</span> <span class="fu">var</span>(yield, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb770-11"><a href="messy-and-missing-data.html#cb770-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb770-12"><a href="messy-and-missing-data.html#cb770-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt_effect =</span> trt_mean <span class="sc">-</span> mu) <span class="sc">%&gt;%</span></span>
<span id="cb770-13"><a href="messy-and-missing-data.html#cb770-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">error_effect =</span> yield <span class="sc">-</span> trt_effect <span class="sc">-</span> mu) <span class="sc">%&gt;%</span></span>
<span id="cb770-14"><a href="messy-and-missing-data.html#cb770-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(plot, trt, yield, mu, trt_var, trt_effect, error_effect)</span>
<span id="cb770-15"><a href="messy-and-missing-data.html#cb770-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb770-16"><a href="messy-and-missing-data.html#cb770-16" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(more_norm_data_interp)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">plot</th>
<th align="left">trt</th>
<th align="right">yield</th>
<th align="right">mu</th>
<th align="right">trt_var</th>
<th align="right">trt_effect</th>
<th align="right">error_effect</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">A</td>
<td align="right">166.8</td>
<td align="right">168.96</td>
<td align="right">16.190000</td>
<td align="right">-2.810000</td>
<td align="right">0.6500000</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">C</td>
<td align="right">169.9</td>
<td align="right">168.96</td>
<td align="right">19.063333</td>
<td align="right">1.373333</td>
<td align="right">-0.4333333</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">B</td>
<td align="right">170.6</td>
<td align="right">168.96</td>
<td align="right">28.996667</td>
<td align="right">-3.010000</td>
<td align="right">4.6500000</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">C</td>
<td align="right">174.9</td>
<td align="right">168.96</td>
<td align="right">19.063333</td>
<td align="right">1.373333</td>
<td align="right">4.5666667</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">B</td>
<td align="right">161.8</td>
<td align="right">168.96</td>
<td align="right">28.996667</td>
<td align="right">-3.010000</td>
<td align="right">-4.1500000</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">A</td>
<td align="right">168.3</td>
<td align="right">168.96</td>
<td align="right">16.190000</td>
<td align="right">-2.810000</td>
<td align="right">2.1500000</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="left">A</td>
<td align="right">169.2</td>
<td align="right">168.96</td>
<td align="right">16.190000</td>
<td align="right">-2.810000</td>
<td align="right">3.0500000</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="left">C</td>
<td align="right">NA</td>
<td align="right">168.96</td>
<td align="right">19.063333</td>
<td align="right">1.373333</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="left">B</td>
<td align="right">160.8</td>
<td align="right">168.96</td>
<td align="right">28.996667</td>
<td align="right">-3.010000</td>
<td align="right">-5.1500000</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="left">C</td>
<td align="right">166.2</td>
<td align="right">168.96</td>
<td align="right">19.063333</td>
<td align="right">1.373333</td>
<td align="right">-4.1333333</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="left">A</td>
<td align="right">160.3</td>
<td align="right">168.96</td>
<td align="right">16.190000</td>
<td align="right">-2.810000</td>
<td align="right">-5.8500000</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="left">D</td>
<td align="right">172.1</td>
<td align="right">168.96</td>
<td align="right">3.416667</td>
<td align="right">4.790000</td>
<td align="right">-1.6500000</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="left">D</td>
<td align="right">175.4</td>
<td align="right">168.96</td>
<td align="right">3.416667</td>
<td align="right">4.790000</td>
<td align="right">1.6500000</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="left">D</td>
<td align="right">175.3</td>
<td align="right">168.96</td>
<td align="right">3.416667</td>
<td align="right">4.790000</td>
<td align="right">1.5500000</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="left">B</td>
<td align="right">170.6</td>
<td align="right">168.96</td>
<td align="right">28.996667</td>
<td align="right">-3.010000</td>
<td align="right">4.6500000</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="left">D</td>
<td align="right">172.2</td>
<td align="right">168.96</td>
<td align="right">3.416667</td>
<td align="right">4.790000</td>
<td align="right">-1.5500000</td>
</tr>
</tbody>
</table>
<p>We can see that removing the yield data from plot 4 causes the treatment effect of treatment C to change – in fact, it has gone from negative to positive. The other treatment effects have also changed. The within-treatment variance for treatment C has also decreased by about one-third. When we re-run our analysis of variance, we see the treatment effect is 0.062 – almost significant at the P=0.05 level.</p>
<div class="sourceCode" id="cb771"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb771-1"><a href="messy-and-missing-data.html#cb771-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(<span class="fu">lm</span>(yield <span class="sc">~</span> trt, <span class="at">data=</span>more_norm_data_interp))</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)  
## trt          3  165.3   55.09   3.294 0.0617 .
## Residuals   11  183.9   16.72                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 1 observation deleted due to missingness</code></pre>
<p>What would happen if we estimated the yield for plot 8 using the population mean, mu, and the treatment effect?</p>
<p><span class="math display">\[ Y_{3,4} = \mu + T_i = 168.96 + 1.37 = 170.33 \]</span></p>
<p>We see that mu, treatment variance, treatment effect, and error have again changed. The variance within Treatment 3 has again decreased by about one-third.</p>
<div class="sourceCode" id="cb773"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb773-1"><a href="messy-and-missing-data.html#cb773-1" aria-hidden="true" tabindex="-1"></a>plot_8_interp <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">plot=</span><span class="dv">8</span> ,<span class="at">trt=</span><span class="st">&quot;C&quot;</span>, <span class="at">yield=</span><span class="fl">170.33</span>)</span>
<span id="cb773-2"><a href="messy-and-missing-data.html#cb773-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb773-3"><a href="messy-and-missing-data.html#cb773-3" aria-hidden="true" tabindex="-1"></a>more_norm_data_interp_8 <span class="ot">=</span> more_norm_data <span class="sc">%&gt;%</span></span>
<span id="cb773-4"><a href="messy-and-missing-data.html#cb773-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>plot<span class="sc">==</span><span class="dv">8</span>) <span class="sc">%&gt;%</span></span>
<span id="cb773-5"><a href="messy-and-missing-data.html#cb773-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(plot_8_interp) <span class="sc">%&gt;%</span></span>
<span id="cb773-6"><a href="messy-and-missing-data.html#cb773-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(plot) <span class="sc">%&gt;%</span></span>
<span id="cb773-7"><a href="messy-and-missing-data.html#cb773-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mu =</span> <span class="fu">mean</span>(yield, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb773-8"><a href="messy-and-missing-data.html#cb773-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trt) <span class="sc">%&gt;%</span></span>
<span id="cb773-9"><a href="messy-and-missing-data.html#cb773-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt_mean =</span> <span class="fu">mean</span>(yield, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb773-10"><a href="messy-and-missing-data.html#cb773-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">trt_var =</span> <span class="fu">var</span>(yield, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb773-11"><a href="messy-and-missing-data.html#cb773-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb773-12"><a href="messy-and-missing-data.html#cb773-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt_effect =</span> trt_mean <span class="sc">-</span> mu) <span class="sc">%&gt;%</span></span>
<span id="cb773-13"><a href="messy-and-missing-data.html#cb773-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">error_effect =</span> yield <span class="sc">-</span> trt_effect <span class="sc">-</span> mu) <span class="sc">%&gt;%</span></span>
<span id="cb773-14"><a href="messy-and-missing-data.html#cb773-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(plot, trt, yield, mu, trt_var, trt_effect, error_effect)</span>
<span id="cb773-15"><a href="messy-and-missing-data.html#cb773-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb773-16"><a href="messy-and-missing-data.html#cb773-16" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(more_norm_data_interp_8)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">plot</th>
<th align="left">trt</th>
<th align="right">yield</th>
<th align="right">mu</th>
<th align="right">trt_var</th>
<th align="right">trt_effect</th>
<th align="right">error_effect</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">A</td>
<td align="right">166.80</td>
<td align="right">169.0456</td>
<td align="right">16.190000</td>
<td align="right">-2.895625</td>
<td align="right">0.6500</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">C</td>
<td align="right">169.90</td>
<td align="right">169.0456</td>
<td align="right">12.708892</td>
<td align="right">1.286875</td>
<td align="right">-0.4325</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">B</td>
<td align="right">170.60</td>
<td align="right">169.0456</td>
<td align="right">28.996667</td>
<td align="right">-3.095625</td>
<td align="right">4.6500</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">C</td>
<td align="right">174.90</td>
<td align="right">169.0456</td>
<td align="right">12.708892</td>
<td align="right">1.286875</td>
<td align="right">4.5675</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">B</td>
<td align="right">161.80</td>
<td align="right">169.0456</td>
<td align="right">28.996667</td>
<td align="right">-3.095625</td>
<td align="right">-4.1500</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">A</td>
<td align="right">168.30</td>
<td align="right">169.0456</td>
<td align="right">16.190000</td>
<td align="right">-2.895625</td>
<td align="right">2.1500</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="left">A</td>
<td align="right">169.20</td>
<td align="right">169.0456</td>
<td align="right">16.190000</td>
<td align="right">-2.895625</td>
<td align="right">3.0500</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="left">C</td>
<td align="right">170.33</td>
<td align="right">169.0456</td>
<td align="right">12.708892</td>
<td align="right">1.286875</td>
<td align="right">-0.0025</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="left">B</td>
<td align="right">160.80</td>
<td align="right">169.0456</td>
<td align="right">28.996667</td>
<td align="right">-3.095625</td>
<td align="right">-5.1500</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="left">C</td>
<td align="right">166.20</td>
<td align="right">169.0456</td>
<td align="right">12.708892</td>
<td align="right">1.286875</td>
<td align="right">-4.1325</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="left">A</td>
<td align="right">160.30</td>
<td align="right">169.0456</td>
<td align="right">16.190000</td>
<td align="right">-2.895625</td>
<td align="right">-5.8500</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="left">D</td>
<td align="right">172.10</td>
<td align="right">169.0456</td>
<td align="right">3.416667</td>
<td align="right">4.704375</td>
<td align="right">-1.6500</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="left">D</td>
<td align="right">175.40</td>
<td align="right">169.0456</td>
<td align="right">3.416667</td>
<td align="right">4.704375</td>
<td align="right">1.6500</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="left">D</td>
<td align="right">175.30</td>
<td align="right">169.0456</td>
<td align="right">3.416667</td>
<td align="right">4.704375</td>
<td align="right">1.5500</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="left">B</td>
<td align="right">170.60</td>
<td align="right">169.0456</td>
<td align="right">28.996667</td>
<td align="right">-3.095625</td>
<td align="right">4.6500</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="left">D</td>
<td align="right">172.20</td>
<td align="right">169.0456</td>
<td align="right">3.416667</td>
<td align="right">4.704375</td>
<td align="right">-1.5500</td>
</tr>
</tbody>
</table>
<p>And here is the kicker, wait for it…</p>
<div class="sourceCode" id="cb774"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb774-1"><a href="messy-and-missing-data.html#cb774-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(<span class="fu">lm</span>(yield <span class="sc">~</span> trt, <span class="at">data=</span>more_norm_data_interp_8))</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)  
## trt          3  167.0   55.67   3.632  0.045 *
## Residuals   12  183.9   15.33                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Our treatment differences are now significant. Why? Because when we estimate a missing value using only the population mean and treatment effect, we decrease the overall variance. And why does that happen? Because we have now created that is almost exactly equal to the treatment mean. Was there a change in the originally observed values associated with this change in significance? No. And this is problem. But there is a way to reduce it.</p>
<p>The problem with the model we have used so far is we did not include the error effect in our yield estimate. If we added it in, our yield estimate for plot 8 would be more appropriate. Of course, we cannot calculate the error effect because it is random and changes among plots. But, knowing that error effects are normally distributed around the treatment mean, we can model that distribution and draw an individual from it at random, to use as the error effect in our estimate.</p>
<p>The error distribution has its own mean, which should be close to zero:</p>
<div class="sourceCode" id="cb776"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb776-1"><a href="messy-and-missing-data.html#cb776-1" aria-hidden="true" tabindex="-1"></a>err_mean <span class="ot">=</span> <span class="fu">mean</span>(more_norm_data_interp<span class="sc">$</span>error_effect, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb776-2"><a href="messy-and-missing-data.html#cb776-2" aria-hidden="true" tabindex="-1"></a>err_mean</span></code></pre></div>
<pre><code>## [1] 1.894781e-15</code></pre>
<p>And its own standard deviation:</p>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb778-1"><a href="messy-and-missing-data.html#cb778-1" aria-hidden="true" tabindex="-1"></a>err_sd <span class="ot">=</span> <span class="fu">sd</span>(more_norm_data_interp<span class="sc">$</span>error_effect, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb778-2"><a href="messy-and-missing-data.html#cb778-2" aria-hidden="true" tabindex="-1"></a>err_sd</span></code></pre></div>
<pre><code>## [1] 3.624684</code></pre>
<p>Knowing these two parameters, we can select a value for our error effect from that distribution.</p>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb780-1"><a href="messy-and-missing-data.html#cb780-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12</span>)</span>
<span id="cb780-2"><a href="messy-and-missing-data.html#cb780-2" aria-hidden="true" tabindex="-1"></a>err_pred <span class="ot">=</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, err_mean, err_sd)</span>
<span id="cb780-3"><a href="messy-and-missing-data.html#cb780-3" aria-hidden="true" tabindex="-1"></a>err_pred</span></code></pre></div>
<pre><code>## [1] -5.36659</code></pre>
<p>Let’s plug that into our yield estimate and see how our statistics change.</p>
<p><span class="math display">\[ Y_{3,4} = \mu + T_i = 168.96 + 1.37 - 5.37 = 164.96 \]</span></p>
<p>We see that mu, treatment variance, treatment effect, and error have again changed. The variance within Treatment 3 has again decreased by about one-third.</p>
<div class="sourceCode" id="cb782"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb782-1"><a href="messy-and-missing-data.html#cb782-1" aria-hidden="true" tabindex="-1"></a>plot_8_interp_sd <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="at">plot=</span><span class="dv">8</span> ,<span class="at">trt=</span><span class="st">&quot;C&quot;</span>, <span class="at">yield=</span><span class="fl">164.96</span>)</span>
<span id="cb782-2"><a href="messy-and-missing-data.html#cb782-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb782-3"><a href="messy-and-missing-data.html#cb782-3" aria-hidden="true" tabindex="-1"></a>more_norm_data_interp_8_sd <span class="ot">=</span> more_norm_data <span class="sc">%&gt;%</span></span>
<span id="cb782-4"><a href="messy-and-missing-data.html#cb782-4" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">filter</span>(<span class="sc">!</span>plot<span class="sc">==</span><span class="dv">8</span>) <span class="sc">%&gt;%</span></span>
<span id="cb782-5"><a href="messy-and-missing-data.html#cb782-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rbind</span>(plot_8_interp_sd) <span class="sc">%&gt;%</span></span>
<span id="cb782-6"><a href="messy-and-missing-data.html#cb782-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(plot) <span class="sc">%&gt;%</span></span>
<span id="cb782-7"><a href="messy-and-missing-data.html#cb782-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mu =</span> <span class="fu">mean</span>(yield, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb782-8"><a href="messy-and-missing-data.html#cb782-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(trt) <span class="sc">%&gt;%</span></span>
<span id="cb782-9"><a href="messy-and-missing-data.html#cb782-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt_mean =</span> <span class="fu">mean</span>(yield, <span class="at">na.rm =</span> <span class="cn">TRUE</span>),</span>
<span id="cb782-10"><a href="messy-and-missing-data.html#cb782-10" aria-hidden="true" tabindex="-1"></a>         <span class="at">trt_var =</span> <span class="fu">var</span>(yield, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb782-11"><a href="messy-and-missing-data.html#cb782-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>() <span class="sc">%&gt;%</span></span>
<span id="cb782-12"><a href="messy-and-missing-data.html#cb782-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">trt_effect =</span> trt_mean <span class="sc">-</span> mu) <span class="sc">%&gt;%</span></span>
<span id="cb782-13"><a href="messy-and-missing-data.html#cb782-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">error_effect =</span> yield <span class="sc">-</span> trt_effect <span class="sc">-</span> mu) <span class="sc">%&gt;%</span></span>
<span id="cb782-14"><a href="messy-and-missing-data.html#cb782-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(plot, trt, yield, mu, trt_var, trt_effect, error_effect)</span>
<span id="cb782-15"><a href="messy-and-missing-data.html#cb782-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb782-16"><a href="messy-and-missing-data.html#cb782-16" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(more_norm_data_interp_8_sd)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">plot</th>
<th align="left">trt</th>
<th align="right">yield</th>
<th align="right">mu</th>
<th align="right">trt_var</th>
<th align="right">trt_effect</th>
<th align="right">error_effect</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="left">A</td>
<td align="right">166.80</td>
<td align="right">168.71</td>
<td align="right">16.190000</td>
<td align="right">-2.56</td>
<td align="right">0.65</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="left">C</td>
<td align="right">169.90</td>
<td align="right">168.71</td>
<td align="right">19.927067</td>
<td align="right">0.28</td>
<td align="right">0.91</td>
</tr>
<tr class="odd">
<td align="right">3</td>
<td align="left">B</td>
<td align="right">170.60</td>
<td align="right">168.71</td>
<td align="right">28.996667</td>
<td align="right">-2.76</td>
<td align="right">4.65</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="left">C</td>
<td align="right">174.90</td>
<td align="right">168.71</td>
<td align="right">19.927067</td>
<td align="right">0.28</td>
<td align="right">5.91</td>
</tr>
<tr class="odd">
<td align="right">5</td>
<td align="left">B</td>
<td align="right">161.80</td>
<td align="right">168.71</td>
<td align="right">28.996667</td>
<td align="right">-2.76</td>
<td align="right">-4.15</td>
</tr>
<tr class="even">
<td align="right">6</td>
<td align="left">A</td>
<td align="right">168.30</td>
<td align="right">168.71</td>
<td align="right">16.190000</td>
<td align="right">-2.56</td>
<td align="right">2.15</td>
</tr>
<tr class="odd">
<td align="right">7</td>
<td align="left">A</td>
<td align="right">169.20</td>
<td align="right">168.71</td>
<td align="right">16.190000</td>
<td align="right">-2.56</td>
<td align="right">3.05</td>
</tr>
<tr class="even">
<td align="right">8</td>
<td align="left">C</td>
<td align="right">164.96</td>
<td align="right">168.71</td>
<td align="right">19.927067</td>
<td align="right">0.28</td>
<td align="right">-4.03</td>
</tr>
<tr class="odd">
<td align="right">9</td>
<td align="left">B</td>
<td align="right">160.80</td>
<td align="right">168.71</td>
<td align="right">28.996667</td>
<td align="right">-2.76</td>
<td align="right">-5.15</td>
</tr>
<tr class="even">
<td align="right">10</td>
<td align="left">C</td>
<td align="right">166.20</td>
<td align="right">168.71</td>
<td align="right">19.927067</td>
<td align="right">0.28</td>
<td align="right">-2.79</td>
</tr>
<tr class="odd">
<td align="right">11</td>
<td align="left">A</td>
<td align="right">160.30</td>
<td align="right">168.71</td>
<td align="right">16.190000</td>
<td align="right">-2.56</td>
<td align="right">-5.85</td>
</tr>
<tr class="even">
<td align="right">12</td>
<td align="left">D</td>
<td align="right">172.10</td>
<td align="right">168.71</td>
<td align="right">3.416667</td>
<td align="right">5.04</td>
<td align="right">-1.65</td>
</tr>
<tr class="odd">
<td align="right">13</td>
<td align="left">D</td>
<td align="right">175.40</td>
<td align="right">168.71</td>
<td align="right">3.416667</td>
<td align="right">5.04</td>
<td align="right">1.65</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="left">D</td>
<td align="right">175.30</td>
<td align="right">168.71</td>
<td align="right">3.416667</td>
<td align="right">5.04</td>
<td align="right">1.55</td>
</tr>
<tr class="odd">
<td align="right">15</td>
<td align="left">B</td>
<td align="right">170.60</td>
<td align="right">168.71</td>
<td align="right">28.996667</td>
<td align="right">-2.76</td>
<td align="right">4.65</td>
</tr>
<tr class="even">
<td align="right">16</td>
<td align="left">D</td>
<td align="right">172.20</td>
<td align="right">168.71</td>
<td align="right">3.416667</td>
<td align="right">5.04</td>
<td align="right">-1.55</td>
</tr>
</tbody>
</table>
<p>When we looks at the ANOVA, we see that the mean square and p-value are approximately the same as they were before the missing value was interpolated.</p>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb783-1"><a href="messy-and-missing-data.html#cb783-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary.aov</span>(<span class="fu">lm</span>(yield <span class="sc">~</span> trt, <span class="at">data=</span>more_norm_data_interp_8_sd))</span></code></pre></div>
<pre><code>##             Df Sum Sq Mean Sq F value Pr(&gt;F)  
## trt          3  158.6   52.87   3.086  0.068 .
## Residuals   12  205.6   17.13                 
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>In R, there is a nice package called <em>mice</em> that does this for us. We will learn about it in an exercise this week.</p>
<p>One final note, however: we should not interpolate missing values if 5% or more of the data are missing. Why? Because, as we have seen above, that interpolated value can markedly change our interpretation of the data. Restricting interpolation to datasets where a small percentage of data are missing reduces the leverage one observation has on conclusions from the data. It also increases the accuracy of the interpolated values.</p>
<p>In smaller datasets, then, we may to use the approaches above. How important is it to have that treatment in the trial, versus losing a replicaton of the other treatments? For the latter option, you may want to test whether including or omitting that replicate changes your conclusion from the data. If not, it may be easiest to drop the replication.</p>
</div>
<div id="summary" class="section level2" number="9.5">
<h2><span class="header-section-number">9.5</span> Summary</h2>
<p>Agronomic data are rarely nice and neat. The scale in which we work (acres and hectares), plus the variations in soil types, equipment performance, weather, weeds and other pests, make it virtually impossible to ensure our experimental units are near-equivalent. Above all, our subjects are alive and integrate every aspect of their environment into their growth. Unlike human subjects, corn plants cannot answer a history questionnaire. Months or years of a trial can be erased by one plugged nozzle, one broken singulator, one strong wind, one “white combine.” It’s a nasty business.</p>
<p>It is important that we inspect our data and consider its shortcomings. We have ways to address these shortcomings. Outliers may be trimmed, or we may use other techniques to overcome them. We have also learned how to re-scale data (using logarithms or square roots) so that variances are closer to equal, and how to “fill in” missing values using imputation so that our datasets can be balanced.</p>
<p>If stuck, consult with other data scientists. There are “robust” statistics that are based on using the median, rather than the mean, for summaries and tests. There are also non-parametric tests, some of which we will be introduced to towards the end of this course. Non-parametric methods don’t use linear models – therefore, they are more insulated from the problems discussed above. We will learn about these in a future unit.</p>
</div>
<div id="exercise-visual-data-inspection" class="section level2" number="9.6">
<h2><span class="header-section-number">9.6</span> Exercise: Visual Data Inspection</h2>
<p>Never underestimate the power of data visualizations. Our ability to see patterns in data is profound. In this exercise, we will review how to create histograms and learn new tools, including the rank-percentile, box-plot, and mean-variance plot.</p>
<div id="case-study-1-2" class="section level3" number="9.6.1">
<h3><span class="header-section-number">9.6.1</span> Case Study 1</h3>
<p>We will work with a wheat uniformity trial. In uniformity trials, there are no treatments. Instead, the wheat yield is measured in gridded plots within a location in order to get a sense of yield consistency (uniformity) or inconsistency (variance).</p>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb785-1"><a href="messy-and-missing-data.html#cb785-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb785-2"><a href="messy-and-missing-data.html#cb785-2" aria-hidden="true" tabindex="-1"></a>wheat_uniformity <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&quot;data-unit-9/exercise_data/wheat_uniformity.csv&quot;</span>)</span>
<span id="cb785-3"><a href="messy-and-missing-data.html#cb785-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(wheat_uniformity)</span></code></pre></div>
<pre><code>##   row col yield
## 1   1   1    60
## 2   2   1    78
## 3   3   1    94
## 4   4   1    77
## 5   5   1    55
## 6   6   1    46</code></pre>
</div>
<div id="histogram" class="section level3" number="9.6.2">
<h3><span class="header-section-number">9.6.2</span> Histogram</h3>
<p>At the beginning of this course, we learned how to use the histogram to quickly learn about the distribution of a dataset. This is just a reminder how powerful a tool it is. We will also relate this shape to that of the rank-percentile plot below. note the data are skewed to the right, with wide tails at both the top and bottom of the distribution.</p>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb787-1"><a href="messy-and-missing-data.html#cb787-1" aria-hidden="true" tabindex="-1"></a>wheat_uniformity <span class="sc">%&gt;%</span></span>
<span id="cb787-2"><a href="messy-and-missing-data.html#cb787-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>yield)) <span class="sc">+</span></span>
<span id="cb787-3"><a href="messy-and-missing-data.html#cb787-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill=</span><span class="st">&quot;darkolivegreen&quot;</span>, <span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">binwidth =</span> <span class="dv">5</span>) </span></code></pre></div>
<p><img src="09-Messy-and-Missing-Data_files/figure-html/unnamed-chunk-37-1.png" width="672" /></p>
</div>
<div id="rank-percentile" class="section level3" number="9.6.3">
<h3><span class="header-section-number">9.6.3</span> Rank-Percentile</h3>
<p>In a rank-percentile plot, data are sorted from least to greatest and then ranked. This takes just one line of code in R.</p>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb788-1"><a href="messy-and-missing-data.html#cb788-1" aria-hidden="true" tabindex="-1"></a>ranked_wheat <span class="ot">=</span> wheat_uniformity <span class="sc">%&gt;%</span></span>
<span id="cb788-2"><a href="messy-and-missing-data.html#cb788-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">rank =</span> <span class="fu">percent_rank</span>(yield))</span>
<span id="cb788-3"><a href="messy-and-missing-data.html#cb788-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb788-4"><a href="messy-and-missing-data.html#cb788-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ranked_wheat)</span></code></pre></div>
<pre><code>##   row col yield      rank
## 1   1   1    60 0.8096480
## 2   2   1    78 0.9465450
## 3   3   1    94 0.9947849
## 4   4   1    77 0.9426336
## 5   5   1    55 0.7692308
## 6   6   1    46 0.6492829</code></pre>
<p>After ranking the oberved values, we create a simple scatter plot of observed value (yield, in this case) and rank.</p>
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb790-1"><a href="messy-and-missing-data.html#cb790-1" aria-hidden="true" tabindex="-1"></a>ranked_wheat <span class="sc">%&gt;%</span>                             <span class="co"># this tells R what dataset to use</span></span>
<span id="cb790-2"><a href="messy-and-missing-data.html#cb790-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>rank, <span class="at">y=</span>yield)) <span class="sc">+</span>             <span class="co"># this creates a plot where rank and yield will determine the location of the points</span></span>
<span id="cb790-3"><a href="messy-and-missing-data.html#cb790-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()                               <span class="co"># this will draw the points</span></span></code></pre></div>
<p><img src="09-Messy-and-Missing-Data_files/figure-html/unnamed-chunk-39-1.png" width="672" /></p>
<p>We notice two things about this curve. First, it is not symmetric around the median, reflecting the skewed distribution we observed in the histogram above. Second, if we were to fit a line to the lower two-thirds of the data, we would notice that the entire 75 - 100 percentile range would be above the line. This suggests a long tail to the right (above the mean). That the line dips down at the left side of the curve also suggests that tail is longer than normal.</p>
</div>
<div id="case-study-2-2" class="section level3" number="9.6.4">
<h3><span class="header-section-number">9.6.4</span> Case Study 2</h3>
<p>For the box plot, we will use a study of common bean genotypes.</p>
<div class="sourceCode" id="cb791"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb791-1"><a href="messy-and-missing-data.html#cb791-1" aria-hidden="true" tabindex="-1"></a>bean_genotypes <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&quot;data-unit-9/exercise_data/bean_genotypes.csv&quot;</span>)</span></code></pre></div>
</div>
<div id="box-plot" class="section level3" number="9.6.5">
<h3><span class="header-section-number">9.6.5</span> Box Plot</h3>
<p>The basic box plot can be drawn using the <em>geom_boxplot()</em> function.</p>
<div class="sourceCode" id="cb792"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb792-1"><a href="messy-and-missing-data.html#cb792-1" aria-hidden="true" tabindex="-1"></a>bean_genotypes <span class="sc">%&gt;%</span>                      <span class="co"># dataset to use</span></span>
<span id="cb792-2"><a href="messy-and-missing-data.html#cb792-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>gen, <span class="at">y=</span>yield)) <span class="sc">+</span>         <span class="co"># use gen and type to specify x and y positions</span></span>
<span id="cb792-3"><a href="messy-and-missing-data.html#cb792-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()                        <span class="co"># draw box and whisker plots</span></span></code></pre></div>
<p><img src="09-Messy-and-Missing-Data_files/figure-html/unnamed-chunk-41-1.png" width="672" /></p>
<p>Often a box plot includes the mean. We can add this using the <em>stat_summary()</em> command and <em>fun=mean</em>. The mean will be represented by a black dot.</p>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb793-1"><a href="messy-and-missing-data.html#cb793-1" aria-hidden="true" tabindex="-1"></a>bean_genotypes <span class="sc">%&gt;%</span>                      <span class="co"># dataset to use</span></span>
<span id="cb793-2"><a href="messy-and-missing-data.html#cb793-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>gen, <span class="at">y=</span>yield)) <span class="sc">+</span>         <span class="co"># use gen and type to specify x and y positions</span></span>
<span id="cb793-3"><a href="messy-and-missing-data.html#cb793-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span>                      <span class="co"># draw box and whisker plots</span></span>
<span id="cb793-4"><a href="messy-and-missing-data.html#cb793-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean)                <span class="co"># draw the mean as a point on the plots</span></span></code></pre></div>
<pre><code>## Warning: Removed 6 rows containing missing values (geom_segment).</code></pre>
<p><img src="09-Messy-and-Missing-Data_files/figure-html/unnamed-chunk-42-1.png" width="672" /></p>
<p>We can replicate the style from the lecture using the code below. Just change out the variable names in the second line to use it with other datasets.</p>
<div class="sourceCode" id="cb795"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb795-1"><a href="messy-and-missing-data.html#cb795-1" aria-hidden="true" tabindex="-1"></a>bean_genotypes <span class="sc">%&gt;%</span></span>
<span id="cb795-2"><a href="messy-and-missing-data.html#cb795-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>gen, <span class="at">y=</span>yield)) <span class="sc">+</span>                                 <span class="co"># change out the variable names for &quot;x&quot; and &quot;y&quot;</span></span>
<span id="cb795-3"><a href="messy-and-missing-data.html#cb795-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape=</span><span class="dv">16</span>,</span>
<span id="cb795-4"><a href="messy-and-missing-data.html#cb795-4" aria-hidden="true" tabindex="-1"></a>       <span class="at">outlier.size=</span><span class="dv">2</span>, <span class="at">notch=</span><span class="cn">FALSE</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb795-5"><a href="messy-and-missing-data.html#cb795-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb795-6"><a href="messy-and-missing-data.html#cb795-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">&quot;point&quot;</span>, <span class="at">shape=</span><span class="dv">23</span>, <span class="at">size=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="09-Messy-and-Missing-Data_files/figure-html/unnamed-chunk-43-1.png" width="672" /></p>
</div>
<div id="practice-10" class="section level3" number="9.6.6">
<h3><span class="header-section-number">9.6.6</span> Practice</h3>
<div id="strawberry-uniformity" class="section level4" number="9.6.6.1">
<h4><span class="header-section-number">9.6.6.1</span> Strawberry Uniformity</h4>
<p>Load the “data-unit-9/exercise_data/strawberry_uniformity.csv” dataset. Create a rank probability plot. Your plot should look like:</p>
<div class="figure">
<img src="data-unit-9/exercise_images/strawberry_rank_probability.png" alt="" />
<p class="caption">strawberry rank probability</p>
</div>
</div>
</div>
</div>
<div id="exercise-identifying-unequal-variances" class="section level2" number="9.7">
<h2><span class="header-section-number">9.7</span> Exercise: Identifying Unequal Variances"</h2>
<p>Occassionally, we may encounter data that don’t satisfy our assumptions about variance: that it is equal across the treatments in our experiment or, similarly, not correlated with treatment level. In these cases, it may be useful to transform the data prior to analysis, by calculating and working with the natural logarithms of the original data.</p>
<div id="case-study-grape-colapsis-in-seed-corn" class="section level3" number="9.7.1">
<h3><span class="header-section-number">9.7.1</span> Case Study: Grape Colapsis in Seed Corn</h3>
<p>In this case study, we will use data loosely inspired by graduate work by Benjamin Carl Kaeb at Iowa State University, where the researcher had to log-transform data prior to analyses. The measurement is grape colapsis count per liter of soil, after being treated during the season with various numbers of insecticide application.</p>
<p>First, lets load and inspect the data.</p>
<div class="sourceCode" id="cb796"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb796-1"><a href="messy-and-missing-data.html#cb796-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb796-2"><a href="messy-and-missing-data.html#cb796-2" aria-hidden="true" tabindex="-1"></a>colapsis <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&quot;data-unit-9/exercise_data/grape_colapsis.csv&quot;</span>)</span>
<span id="cb796-3"><a href="messy-and-missing-data.html#cb796-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(colapsis)</span></code></pre></div>
<pre><code>##   applications      count
## 1       triple 0.02496295
## 2       triple 0.01446486
## 3       triple 0.03428771
## 4       triple 0.03020649
## 5       triple 0.04458152
## 6       triple 0.03149647</code></pre>
<p>Next, lets create a box plot of our data.</p>
<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb798-1"><a href="messy-and-missing-data.html#cb798-1" aria-hidden="true" tabindex="-1"></a>colapsis <span class="sc">%&gt;%</span></span>
<span id="cb798-2"><a href="messy-and-missing-data.html#cb798-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>applications, <span class="at">y=</span>count)) <span class="sc">+</span> </span>
<span id="cb798-3"><a href="messy-and-missing-data.html#cb798-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape=</span><span class="dv">16</span>,</span>
<span id="cb798-4"><a href="messy-and-missing-data.html#cb798-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">outlier.size=</span><span class="dv">2</span>, <span class="at">notch=</span><span class="cn">FALSE</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb798-5"><a href="messy-and-missing-data.html#cb798-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb798-6"><a href="messy-and-missing-data.html#cb798-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">&quot;point&quot;</span>, <span class="at">shape=</span><span class="dv">23</span>, <span class="at">size=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="09-Messy-and-Missing-Data_files/figure-html/unnamed-chunk-45-1.png" width="672" /></p>
<p>One thing we notice in the plot above is that our applications are not ordered from lowest (control) to highest (triple). Lets fix that. We can use the <em>factor()</em> function to rearrange the order of our levels. We tell R to set the “applications” column of the colapsis dataset as the factor format of itself. The <em>levels()</em> argument tells R the order in which the levels should be listed.</p>
<div class="sourceCode" id="cb799"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb799-1"><a href="messy-and-missing-data.html#cb799-1" aria-hidden="true" tabindex="-1"></a>colapsis<span class="sc">$</span>applications <span class="ot">=</span> <span class="fu">factor</span>(colapsis<span class="sc">$</span>applications, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;control&quot;</span>, <span class="st">&quot;single&quot;</span>, <span class="st">&quot;double&quot;</span>, <span class="st">&quot;triple&quot;</span>))</span>
<span id="cb799-2"><a href="messy-and-missing-data.html#cb799-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb799-3"><a href="messy-and-missing-data.html#cb799-3" aria-hidden="true" tabindex="-1"></a>colapsis <span class="sc">%&gt;%</span></span>
<span id="cb799-4"><a href="messy-and-missing-data.html#cb799-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>applications, <span class="at">y=</span>count)) <span class="sc">+</span> </span>
<span id="cb799-5"><a href="messy-and-missing-data.html#cb799-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour=</span><span class="st">&quot;black&quot;</span>, <span class="at">outlier.shape=</span><span class="dv">16</span>,</span>
<span id="cb799-6"><a href="messy-and-missing-data.html#cb799-6" aria-hidden="true" tabindex="-1"></a>             <span class="at">outlier.size=</span><span class="dv">2</span>, <span class="at">notch=</span><span class="cn">FALSE</span>, <span class="at">fill=</span><span class="st">&quot;lightblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb799-7"><a href="messy-and-missing-data.html#cb799-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">coord_flip</span>() <span class="sc">+</span></span>
<span id="cb799-8"><a href="messy-and-missing-data.html#cb799-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">stat_summary</span>(<span class="at">fun=</span>mean, <span class="at">geom=</span><span class="st">&quot;point&quot;</span>, <span class="at">shape=</span><span class="dv">23</span>, <span class="at">size=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="09-Messy-and-Missing-Data_files/figure-html/unnamed-chunk-46-1.png" width="672" /></p>
<p>We can see that there is noticable variation in the spread of observed values among treatments, and that the spread of the observed values seems to increase with the mean number of counts.</p>
<p>Let’s calculate our means and variances by number of applications.</p>
<div class="sourceCode" id="cb800"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb800-1"><a href="messy-and-missing-data.html#cb800-1" aria-hidden="true" tabindex="-1"></a>colapsis_mean_var <span class="ot">=</span> colapsis <span class="sc">%&gt;%</span>    <span class="co"># base calculations on colapsis data frame</span></span>
<span id="cb800-2"><a href="messy-and-missing-data.html#cb800-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(applications) <span class="sc">%&gt;%</span>        <span class="co"># calculate summary by application level</span></span>
<span id="cb800-3"><a href="messy-and-missing-data.html#cb800-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean =</span> <span class="fu">mean</span>(count),     <span class="co"># create new variable, mean, which is the mean count per application</span></span>
<span id="cb800-4"><a href="messy-and-missing-data.html#cb800-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">variance =</span> <span class="fu">var</span>(count))  <span class="co"># create new variable, variance, which is the count variance per application</span></span>
<span id="cb800-5"><a href="messy-and-missing-data.html#cb800-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb800-6"><a href="messy-and-missing-data.html#cb800-6" aria-hidden="true" tabindex="-1"></a>colapsis_mean_var</span></code></pre></div>
<pre><code>## # A tibble: 4 x 3
##   applications  mean variance
##   &lt;fct&gt;        &lt;dbl&gt;    &lt;dbl&gt;
## 1 control       0.26 0.00360 
## 2 single        0.1  0.000900
## 3 double        0.05 0.000289
## 4 triple        0.03 0.0001</code></pre>
<p>Here is a simple scatter plot of variance as a function of mean.</p>
<div class="sourceCode" id="cb802"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb802-1"><a href="messy-and-missing-data.html#cb802-1" aria-hidden="true" tabindex="-1"></a>colapsis_mean_var <span class="sc">%&gt;%</span></span>
<span id="cb802-2"><a href="messy-and-missing-data.html#cb802-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>mean, <span class="at">y=</span>variance)) <span class="sc">+</span></span>
<span id="cb802-3"><a href="messy-and-missing-data.html#cb802-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="09-Messy-and-Missing-Data_files/figure-html/unnamed-chunk-48-1.png" width="672" />
There is a clear trend that variance increases with mean. We can also see the greatest variance is about 16 times greater than the least variance. This is problematic – when we have differences greater than 2X in variances, our analyses may not function properly.</p>
<p>To test whether the variances are equal, we will use the <em>bartlett.test()</em> function. The arguments to this function are the same as a model statement: the model, and the data frame</p>
<div class="sourceCode" id="cb803"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb803-1"><a href="messy-and-missing-data.html#cb803-1" aria-hidden="true" tabindex="-1"></a><span class="fu">bartlett.test</span>(count <span class="sc">~</span> applications, <span class="at">data=</span>colapsis)</span></code></pre></div>
<pre><code>## 
##  Bartlett test of homogeneity of variances
## 
## data:  count by applications
## Bartlett&#39;s K-squared = 14.636, df = 3, p-value = 0.002156</code></pre>
<p>We see that the p-value is less than 0.01. We should consider transforming these data before running an analysis of variance and means separation on them.</p>
</div>
<div id="practice-pigweed-height" class="section level3" number="9.7.2">
<h3><span class="header-section-number">9.7.2</span> Practice: Pigweed Height</h3>
<ol style="list-style-type: decimal">
<li><p>Load the data from “data-unit-9/exercise_data/soybean_pigweed_height.csv.” “trt” is the soybean seeding rate. “height” is the height of pigweed species in inches.</p></li>
<li><p>Create a summary table of means and variances. Your results should look like.</p></li>
</ol>
<p>trt mean variance
rate_100 13.5 5.76
rate_173 12.0 2.89
rate_322 10.5 1.00
rate_470 9.0 0.09</p>
<ol start="3" style="list-style-type: decimal">
<li>Create a plot of variance as a function of mean. It shold look like:</li>
</ol>
<p><img src="images/pigweed_height_mean_var.png" /></p>
<ol start="4" style="list-style-type: decimal">
<li>Create a boxplot of height grouped by trt. It should look like this.</li>
</ol>
<p><img src="images/pigweed_height_boxplot.png" /></p>
<ol start="5" style="list-style-type: decimal">
<li><p>Run the Bartlett’s Test for Homogeneity of the variances by treatment. Your output should look like:</p>
<p>Bartlett test of homogeneity of variances</p></li>
</ol>
<p>data: height by trt
Bartlett’s K-squared = 14.564, df = 3, p-value = 0.00223</p>
<p>###Practice: Pigweed Biomass
Pigweed biomass was also measured in the above experiment.</p>
<ol style="list-style-type: decimal">
<li><p>Load the dataset “data-unit-9/exercise_data/soybean_pigweed_biomass.csv”</p></li>
<li><p>Create a boxplot of biomass by seeding rate</p></li>
</ol>
<p><img src="images/pigweed_biomass_boxplot.png" /></p>
<ol start="3" style="list-style-type: decimal">
<li>Create a table of biomass means and variances by seeding rate. Your table should look like:</li>
</ol>
<p>rate mean variance
rate_100 2.9 2.56
rate_173 2.4 1.21
rate_322 1.5 0.36
rate_470 0.5 0.01</p>
<ol start="4" style="list-style-type: decimal">
<li>Plot the variance of biomass as a function of seeding rate. Your plot should look like:</li>
</ol>
<p><img src="images/pigweed_biomass_mean_var.png" /></p>
<ol start="5" style="list-style-type: decimal">
<li><p>Run a Bartlett Test of Homogeneity of Variances on the data. Your results should look like:</p>
<p>Bartlett test of homogeneity of variances</p></li>
</ol>
<p>data: biomass by rate
Bartlett’s K-squared = 21.387, df = 3, p-value = 8.749e-05</p>
</div>
</div>
<div id="exercise-transforming-and-analyzing-data" class="section level2" number="9.8">
<h2><span class="header-section-number">9.8</span> Exercise: Transforming and Analyzing Data</h2>
<p>In this exercise, we will work with the same three datasets in which we identified unequal variances.</p>
<div id="case-study-grape-colapsis-in-seed-corn-1" class="section level3" number="9.8.1">
<h3><span class="header-section-number">9.8.1</span> Case Study: Grape Colapsis in Seed Corn</h3>
<p>First, lets load and inspect the data.</p>
<div class="sourceCode" id="cb805"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb805-1"><a href="messy-and-missing-data.html#cb805-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb805-2"><a href="messy-and-missing-data.html#cb805-2" aria-hidden="true" tabindex="-1"></a>colapsis <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&quot;data-unit-9/exercise_data/grape_colapsis.csv&quot;</span>)</span></code></pre></div>
<p>In the previous exercise, we determined the variances were unequal, so we will now create a new column in our colapsis dataset with the natural logarithm of the original counts.</p>
<div class="sourceCode" id="cb806"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb806-1"><a href="messy-and-missing-data.html#cb806-1" aria-hidden="true" tabindex="-1"></a>colapsis <span class="ot">=</span> colapsis <span class="sc">%&gt;%</span></span>
<span id="cb806-2"><a href="messy-and-missing-data.html#cb806-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">log_count =</span> <span class="fu">log</span>(count)) <span class="co"># create new variable count_log, based on natural logarithm of count</span></span></code></pre></div>
<p>We can run an Analysis of Variance on the transformed data, the same as we would any other dataset.</p>
<div class="sourceCode" id="cb807"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb807-1"><a href="messy-and-missing-data.html#cb807-1" aria-hidden="true" tabindex="-1"></a>colapsis_model <span class="ot">=</span> <span class="fu">aov</span>(log_count <span class="sc">~</span> applications, <span class="at">data=</span>colapsis)</span>
<span id="cb807-2"><a href="messy-and-missing-data.html#cb807-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(colapsis_model)</span></code></pre></div>
<pre><code>##              Df Sum Sq Mean Sq F value   Pr(&gt;F)    
## applications  3 16.247   5.416   53.03 1.06e-09 ***
## Residuals    20  2.043   0.102                     
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<p>Our applications effect is significant. We will separate the means using the Least Significant Difference.</p>
<div class="sourceCode" id="cb809"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb809-1"><a href="messy-and-missing-data.html#cb809-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(agricolae)</span>
<span id="cb809-2"><a href="messy-and-missing-data.html#cb809-2" aria-hidden="true" tabindex="-1"></a>lsd <span class="ot">=</span> <span class="fu">LSD.test</span>(colapsis_model, <span class="st">&quot;applications&quot;</span>)</span>
<span id="cb809-3"><a href="messy-and-missing-data.html#cb809-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb809-4"><a href="messy-and-missing-data.html#cb809-4" aria-hidden="true" tabindex="-1"></a>lsd</span></code></pre></div>
<pre><code>## $statistics
##     MSerror Df      Mean        CV  t.value       LSD
##   0.1021256 20 -2.578757 -12.39244 2.085963 0.3848694
## 
## $parameters
##         test p.ajusted       name.t ntr alpha
##   Fisher-LSD      none applications   4  0.05
## 
## $means
##         log_count       std r       LCL       UCL       Min       Max       Q25
## control -1.370036 0.2364918 6 -1.642180 -1.097892 -1.656177 -1.122266 -1.564864
## double  -3.049637 0.3716377 6 -3.321781 -2.777493 -3.656836 -2.660004 -3.183980
## single  -2.334127 0.2634909 6 -2.606270 -2.061983 -2.536044 -1.849017 -2.519757
## triple  -3.561230 0.3808307 6 -3.833373 -3.289086 -4.236033 -3.110436 -3.642697
##               Q50       Q75
## control -1.338709 -1.177759
## double  -3.047062 -2.754693
## single  -2.424058 -2.270959
## triple  -3.478789 -3.394196
## 
## $comparison
## NULL
## 
## $groups
##         log_count groups
## control -1.370036      a
## single  -2.334127      b
## double  -3.049637      c
## triple  -3.561230      d
## 
## attr(,&quot;class&quot;)
## [1] &quot;group&quot;</code></pre>
<p>At this point, we have all the data we need to evaluate whether the applications effect is significant, and whether the colapsis count differs with the number of applications per season. Before we present our means and groupings above, however, we would like to “back-transform” them to our original scale of measurement.</p>
<p>Recall that we can quickly isolate the $groups table from our LSD.test output. We will want to convert the rownames to a column before we work further with that data frame, however. We can use the <em>rownames_to_columns()</em> function to create a new column, “applications,” with the values from the row names.</p>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb811-1"><a href="messy-and-missing-data.html#cb811-1" aria-hidden="true" tabindex="-1"></a>means_from_lsd <span class="ot">=</span> lsd<span class="sc">$</span>groups</span>
<span id="cb811-2"><a href="messy-and-missing-data.html#cb811-2" aria-hidden="true" tabindex="-1"></a>means_from_lsd <span class="ot">=</span> means_from_lsd <span class="sc">%&gt;%</span></span>
<span id="cb811-3"><a href="messy-and-missing-data.html#cb811-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">&quot;applications&quot;</span>)</span></code></pre></div>
<p>We will now back-transform the natural log by using <em>e</em>, Euler’s constant (equal to about 2.78) to “cancel it out” Specifically, we will tell R to calculate e^x, where x is each treatment mean in the transformed data.</p>
<div class="sourceCode" id="cb812"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb812-1"><a href="messy-and-missing-data.html#cb812-1" aria-hidden="true" tabindex="-1"></a>means_from_lsd <span class="ot">=</span> means_from_lsd <span class="sc">%&gt;%</span> </span>
<span id="cb812-2"><a href="messy-and-missing-data.html#cb812-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">count =</span> <span class="fu">exp</span>(log_count))</span>
<span id="cb812-3"><a href="messy-and-missing-data.html#cb812-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb812-4"><a href="messy-and-missing-data.html#cb812-4" aria-hidden="true" tabindex="-1"></a>means_from_lsd</span></code></pre></div>
<pre><code>##   applications log_count groups      count
## 1      control -1.370036      a 0.25409776
## 2       single -2.334127      b 0.09689507
## 3       double -3.049637      c 0.04737613
## 4       triple -3.561230      d 0.02840387</code></pre>
<p>Finally, let’s get rid of the log_count column and move the groups column to the column furtherst ruight. We will use the <em>select()</em> function.</p>
<div class="sourceCode" id="cb814"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb814-1"><a href="messy-and-missing-data.html#cb814-1" aria-hidden="true" tabindex="-1"></a>means_from_lsd <span class="ot">=</span> means_from_lsd <span class="sc">%&gt;%</span></span>
<span id="cb814-2"><a href="messy-and-missing-data.html#cb814-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(applications, count, groups)</span>
<span id="cb814-3"><a href="messy-and-missing-data.html#cb814-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb814-4"><a href="messy-and-missing-data.html#cb814-4" aria-hidden="true" tabindex="-1"></a>means_from_lsd</span></code></pre></div>
<pre><code>##   applications      count groups
## 1      control 0.25409776      a
## 2       single 0.09689507      b
## 3       double 0.04737613      c
## 4       triple 0.02840387      d</code></pre>
</div>
<div id="practice-pigweed-height-1" class="section level3" number="9.8.2">
<h3><span class="header-section-number">9.8.2</span> Practice: Pigweed Height</h3>
<ol style="list-style-type: decimal">
<li>Load the pigweed height data from the “data/soybean_pigweed_height.csv” file.</li>
</ol>
<div class="sourceCode" id="cb816"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb816-1"><a href="messy-and-missing-data.html#cb816-1" aria-hidden="true" tabindex="-1"></a>pigweed <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&quot;data-unit-9/exercise_data/soybean_pigweed_height.csv&quot;</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Transform the data using the natural log transformation.</li>
</ol>
<div class="sourceCode" id="cb817"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb817-1"><a href="messy-and-missing-data.html#cb817-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The first few rows will look like:</span></span>
<span id="cb817-2"><a href="messy-and-missing-data.html#cb817-2" aria-hidden="true" tabindex="-1"></a><span class="co"># trt         height    log_height</span></span>
<span id="cb817-3"><a href="messy-and-missing-data.html#cb817-3" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_100  11.69514    2.459173</span></span>
<span id="cb817-4"><a href="messy-and-missing-data.html#cb817-4" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_100  16.06706    2.776771</span></span>
<span id="cb817-5"><a href="messy-and-missing-data.html#cb817-5" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_100  10.88049    2.386971</span></span>
<span id="cb817-6"><a href="messy-and-missing-data.html#cb817-6" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_100  13.48499    2.601577</span></span>
<span id="cb817-7"><a href="messy-and-missing-data.html#cb817-7" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_100  16.70968    2.815988</span></span>
<span id="cb817-8"><a href="messy-and-missing-data.html#cb817-8" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_100  12.16264    2.49836</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Run the ANOVA.</li>
</ol>
<div class="sourceCode" id="cb818"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb818-1"><a href="messy-and-missing-data.html#cb818-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your results should look like:</span></span>
<span id="cb818-2"><a href="messy-and-missing-data.html#cb818-2" aria-hidden="true" tabindex="-1"></a><span class="co">#             Df Sum Sq Mean Sq F value   Pr(&gt;F)    </span></span>
<span id="cb818-3"><a href="messy-and-missing-data.html#cb818-3" aria-hidden="true" tabindex="-1"></a><span class="co"># trt          3 0.5162 0.17206    11.6 0.000127 ***</span></span>
<span id="cb818-4"><a href="messy-and-missing-data.html#cb818-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Residuals   20 0.2966 0.01483  </span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li><p>Run the LSD test and extract the groups table.</p></li>
<li><p>Convert the rownames to a column.</p></li>
</ol>
<div class="sourceCode" id="cb819"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb819-1"><a href="messy-and-missing-data.html#cb819-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your table should look like.</span></span>
<span id="cb819-2"><a href="messy-and-missing-data.html#cb819-2" aria-hidden="true" tabindex="-1"></a><span class="co"># trt   log_height  groups</span></span>
<span id="cb819-3"><a href="messy-and-missing-data.html#cb819-3" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_100  2.589808    a</span></span>
<span id="cb819-4"><a href="messy-and-missing-data.html#cb819-4" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_173  2.477182    ab</span></span>
<span id="cb819-5"><a href="messy-and-missing-data.html#cb819-5" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_322  2.347396    b</span></span>
<span id="cb819-6"><a href="messy-and-missing-data.html#cb819-6" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_470  2.196758    c</span></span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>Back-transform the means to the original scale.</li>
</ol>
<div class="sourceCode" id="cb820"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb820-1"><a href="messy-and-missing-data.html#cb820-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your results should look like:</span></span>
<span id="cb820-2"><a href="messy-and-missing-data.html#cb820-2" aria-hidden="true" tabindex="-1"></a><span class="co"># trt   log_height  groups  height</span></span>
<span id="cb820-3"><a href="messy-and-missing-data.html#cb820-3" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_100  2.589808    a   13.327217</span></span>
<span id="cb820-4"><a href="messy-and-missing-data.html#cb820-4" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_173  2.477182    ab  11.907663</span></span>
<span id="cb820-5"><a href="messy-and-missing-data.html#cb820-5" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_322  2.347396    b   10.458302</span></span>
<span id="cb820-6"><a href="messy-and-missing-data.html#cb820-6" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_470  2.196758    c   8.995803</span></span></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li>Use select() to arrange the table so the columns are: trt, height, groups.</li>
</ol>
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb821-1"><a href="messy-and-missing-data.html#cb821-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your results should look like:</span></span>
<span id="cb821-2"><a href="messy-and-missing-data.html#cb821-2" aria-hidden="true" tabindex="-1"></a><span class="co"># trt   height  groups</span></span>
<span id="cb821-3"><a href="messy-and-missing-data.html#cb821-3" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_100  13.327217   a</span></span>
<span id="cb821-4"><a href="messy-and-missing-data.html#cb821-4" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_173  11.907663   ab</span></span>
<span id="cb821-5"><a href="messy-and-missing-data.html#cb821-5" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_322  10.458302   b</span></span>
<span id="cb821-6"><a href="messy-and-missing-data.html#cb821-6" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_470  8.995803    c</span></span></code></pre></div>
</div>
<div id="practice-pigweed-biomass" class="section level3" number="9.8.3">
<h3><span class="header-section-number">9.8.3</span> Practice: Pigweed Biomass</h3>
<ol style="list-style-type: decimal">
<li>Load the pigweed biomass data from the “data/soybean_pigweed_biomass.csv” file.</li>
</ol>
<div class="sourceCode" id="cb822"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb822-1"><a href="messy-and-missing-data.html#cb822-1" aria-hidden="true" tabindex="-1"></a>biomass <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&quot;data-unit-9/exercise_data/soybean_pigweed_biomass.csv&quot;</span>)</span></code></pre></div>
<ol start="2" style="list-style-type: decimal">
<li>Transform the data using the natural log transformation.</li>
</ol>
<div class="sourceCode" id="cb823"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb823-1"><a href="messy-and-missing-data.html#cb823-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The first few rows will look like:</span></span>
<span id="cb823-2"><a href="messy-and-missing-data.html#cb823-2" aria-hidden="true" tabindex="-1"></a><span class="co"># rate  biomass log_biomass</span></span>
<span id="cb823-3"><a href="messy-and-missing-data.html#cb823-3" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_100  6.096351    1.8076904</span></span>
<span id="cb823-4"><a href="messy-and-missing-data.html#cb823-4" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_100  1.828959    0.6037471</span></span>
<span id="cb823-5"><a href="messy-and-missing-data.html#cb823-5" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_100  2.444420    0.8938077</span></span>
<span id="cb823-6"><a href="messy-and-missing-data.html#cb823-6" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_100  2.789826    1.0259793</span></span>
<span id="cb823-7"><a href="messy-and-missing-data.html#cb823-7" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_100  2.105895    0.7447407</span></span>
<span id="cb823-8"><a href="messy-and-missing-data.html#cb823-8" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_100  2.134549    0.7582552</span></span></code></pre></div>
<ol start="3" style="list-style-type: decimal">
<li>Run the ANOVA.</li>
</ol>
<div class="sourceCode" id="cb824"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb824-1"><a href="messy-and-missing-data.html#cb824-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your results should look like:</span></span>
<span id="cb824-2"><a href="messy-and-missing-data.html#cb824-2" aria-hidden="true" tabindex="-1"></a><span class="co">#             Df Sum Sq Mean Sq F value  Pr(&gt;F)    </span></span>
<span id="cb824-3"><a href="messy-and-missing-data.html#cb824-3" aria-hidden="true" tabindex="-1"></a><span class="co"># rate         3 10.280   3.427   22.45 1.3e-06 ***</span></span>
<span id="cb824-4"><a href="messy-and-missing-data.html#cb824-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Residuals   20  3.053   0.153 </span></span></code></pre></div>
<ol start="4" style="list-style-type: decimal">
<li>Run the LSD test and extract the groups table. Your results should look like:</li>
</ol>
<div class="sourceCode" id="cb825"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb825-1"><a href="messy-and-missing-data.html#cb825-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your results should look like:</span></span>
<span id="cb825-2"><a href="messy-and-missing-data.html#cb825-2" aria-hidden="true" tabindex="-1"></a><span class="co"># log_biomass   groups</span></span>
<span id="cb825-3"><a href="messy-and-missing-data.html#cb825-3" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_100  0.9723701   a</span></span>
<span id="cb825-4"><a href="messy-and-missing-data.html#cb825-4" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_173  0.7920214   ab</span></span>
<span id="cb825-5"><a href="messy-and-missing-data.html#cb825-5" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_322  0.3350568   b</span></span>
<span id="cb825-6"><a href="messy-and-missing-data.html#cb825-6" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_470  -0.7132060  c</span></span></code></pre></div>
<ol start="5" style="list-style-type: decimal">
<li>Convert the rownames to a column.</li>
</ol>
<div class="sourceCode" id="cb826"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb826-1"><a href="messy-and-missing-data.html#cb826-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your table should look like:</span></span>
<span id="cb826-2"><a href="messy-and-missing-data.html#cb826-2" aria-hidden="true" tabindex="-1"></a><span class="co"># rate  log_biomass groups</span></span>
<span id="cb826-3"><a href="messy-and-missing-data.html#cb826-3" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_100  0.9723701   a</span></span>
<span id="cb826-4"><a href="messy-and-missing-data.html#cb826-4" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_173  0.7920214   ab</span></span>
<span id="cb826-5"><a href="messy-and-missing-data.html#cb826-5" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_322  0.3350568   b</span></span>
<span id="cb826-6"><a href="messy-and-missing-data.html#cb826-6" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_470  -0.7132060  c  </span></span></code></pre></div>
<ol start="6" style="list-style-type: decimal">
<li>Back-transform the means to the original scale.</li>
</ol>
<div class="sourceCode" id="cb827"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb827-1"><a href="messy-and-missing-data.html#cb827-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your results should look like:</span></span>
<span id="cb827-2"><a href="messy-and-missing-data.html#cb827-2" aria-hidden="true" tabindex="-1"></a><span class="co"># rate  log_biomass groups  biomass</span></span>
<span id="cb827-3"><a href="messy-and-missing-data.html#cb827-3" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_100  0.9723701   a   2.6442039</span></span>
<span id="cb827-4"><a href="messy-and-missing-data.html#cb827-4" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_173  0.7920214   ab  2.2078550</span></span>
<span id="cb827-5"><a href="messy-and-missing-data.html#cb827-5" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_322  0.3350568   b   1.3980198</span></span>
<span id="cb827-6"><a href="messy-and-missing-data.html#cb827-6" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_470  -0.7132060  c   0.4900705</span></span></code></pre></div>
<ol start="7" style="list-style-type: decimal">
<li>Use select() to arrange the table so the columns are: trt, height, groups.</li>
</ol>
<div class="sourceCode" id="cb828"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb828-1"><a href="messy-and-missing-data.html#cb828-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Your results should look like:</span></span>
<span id="cb828-2"><a href="messy-and-missing-data.html#cb828-2" aria-hidden="true" tabindex="-1"></a><span class="co"># rate  biomass groups</span></span>
<span id="cb828-3"><a href="messy-and-missing-data.html#cb828-3" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_100  2.6442039   a</span></span>
<span id="cb828-4"><a href="messy-and-missing-data.html#cb828-4" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_173  2.2078550   ab</span></span>
<span id="cb828-5"><a href="messy-and-missing-data.html#cb828-5" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_322  1.3980198   b</span></span>
<span id="cb828-6"><a href="messy-and-missing-data.html#cb828-6" aria-hidden="true" tabindex="-1"></a><span class="co"># rate_470  0.4900705   c</span></span></code></pre></div>
</div>
</div>
<div id="exercise-imputing-missing-data" class="section level2" number="9.9">
<h2><span class="header-section-number">9.9</span> Exercise: Imputing Missing Data</h2>
<p>Despite our best efforts, we occassionally encounter missing data. In some cases, plots may be lost to inclement weather, equipment failures, or human error. In other cases, we may fail to record values for every plot. In some cases, we may delete an outlier. In each of these cases, we may wish to replace the missing value in order to maintain a complete dataset.</p>
<div id="case-study-wheat-genotype-trial" class="section level3" number="9.9.1">
<h3><span class="header-section-number">9.9.1</span> Case Study: Wheat Genotype Trial</h3>
<p>For this example, we will use data from a wheat genotype trial.</p>
<div class="sourceCode" id="cb829"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb829-1"><a href="messy-and-missing-data.html#cb829-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb829-2"><a href="messy-and-missing-data.html#cb829-2" aria-hidden="true" tabindex="-1"></a>wheat_missing <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&quot;data-unit-9/exercise_data/wheat_missing.csv&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb830"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb830-1"><a href="messy-and-missing-data.html#cb830-1" aria-hidden="true" tabindex="-1"></a>wheat_missing <span class="sc">%&gt;%</span></span>
<span id="cb830-2"><a href="messy-and-missing-data.html#cb830-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">missing =</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(yield), <span class="st">&quot;yes&quot;</span>, <span class="st">&quot;no&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb830-3"><a href="messy-and-missing-data.html#cb830-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">missing =</span> <span class="fu">as.factor</span>(missing)) <span class="sc">%&gt;%</span></span>
<span id="cb830-4"><a href="messy-and-missing-data.html#cb830-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>col, <span class="at">y=</span>row)) <span class="sc">+</span></span>
<span id="cb830-5"><a href="messy-and-missing-data.html#cb830-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill=</span>missing)) <span class="sc">+</span></span>
<span id="cb830-6"><a href="messy-and-missing-data.html#cb830-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&quot;grey&quot;</span>, <span class="st">&quot;tomato&quot;</span>))</span></code></pre></div>
<p><img src="09-Messy-and-Missing-Data_files/figure-html/unnamed-chunk-79-1.png" width="672" /></p>
<div id="mean-imputation" class="section level4" number="9.9.1.1">
<h4><span class="header-section-number">9.9.1.1</span> Mean Imputation</h4>
<p>When we estimate the values of missing data, we <em>impute</em> those values. The simplest way to impute a missing value is to use the mean for that treatment. For example, we could calculate the mean for each treatment, as we have done below.</p>
<div class="sourceCode" id="cb831"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb831-1"><a href="messy-and-missing-data.html#cb831-1" aria-hidden="true" tabindex="-1"></a>genotype_means <span class="ot">=</span> wheat_missing <span class="sc">%&gt;%</span></span>
<span id="cb831-2"><a href="messy-and-missing-data.html#cb831-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(gen) <span class="sc">%&gt;%</span></span>
<span id="cb831-3"><a href="messy-and-missing-data.html#cb831-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">mean_yield =</span> <span class="fu">mean</span>(yield, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb831-4"><a href="messy-and-missing-data.html#cb831-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ungroup</span>()</span>
<span id="cb831-5"><a href="messy-and-missing-data.html#cb831-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb831-6"><a href="messy-and-missing-data.html#cb831-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(genotype_means)</span></code></pre></div>
<pre><code>## # A tibble: 6 x 5
##     col   row gen   yield mean_yield
##   &lt;int&gt; &lt;int&gt; &lt;chr&gt; &lt;dbl&gt;      &lt;dbl&gt;
## 1     1     1 G01    3.38       3.40
## 2     1     2 G02    3.59       3.09
## 3     1     3 G03    4.33       3.05
## 4     1     4 G04    4.54       3.56
## 5     1     5 G05    2.59       2.30
## 6     1     6 G06    2.41       2.53</code></pre>
<p>The mean yield is shown in the far right column. We will now use either the recorded value (“yield”) or the mean yield (where “yield” is a missing value) for our final yield. Don’t worry about the code below (although conditional statements <em>are</em> cool) – it is just to set up the rest of this example.</p>
<div class="sourceCode" id="cb833"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb833-1"><a href="messy-and-missing-data.html#cb833-1" aria-hidden="true" tabindex="-1"></a>mean_imputed_yields <span class="ot">=</span> genotype_means <span class="sc">%&gt;%</span></span>
<span id="cb833-2"><a href="messy-and-missing-data.html#cb833-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">final_yield =</span> <span class="fu">if_else</span>(<span class="fu">is.na</span>(yield), mean_yield, yield))</span></code></pre></div>
<p>We now have a complete dataset. But there is a problem. Lets look at the variance before imputing the missing values. We calculate variance using the <em>var()</em> function. Whenever we are calculating a summary statistic – mean, sd, variance, etc) – we can add <em>na.rm = TRUE</em> to tell R to work around the missing values. Otherwise, R will return “NA” instead of the statistic.</p>
<p>Here is the variance before:</p>
<div class="sourceCode" id="cb834"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb834-1"><a href="messy-and-missing-data.html#cb834-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(wheat_missing<span class="sc">$</span>yield, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<pre><code>## [1] 0.6638558</code></pre>
<p>And after:</p>
<div class="sourceCode" id="cb836"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb836-1"><a href="messy-and-missing-data.html#cb836-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(mean_imputed_yields<span class="sc">$</span>final_yield)</span></code></pre></div>
<pre><code>## [1] 0.6492327</code></pre>
<p>What do you notice? That’s right, the variance is decreased between the original dataset and the imputed dataset. When we use means imputation, we artificially lower the variance. This increases the probability we will commit a Type I error: determining that two or more populations are significantly different when in fact they are not. That is why it is better to use the next</p>
</div>
<div id="multivariate-imputation-by-chained-equations-mice" class="section level4" number="9.9.1.2">
<h4><span class="header-section-number">9.9.1.2</span> Multivariate Imputation by Chained Equations (MICE)</h4>
<p>The MICE algorithm is complex and a detailed explanation is beyond the scope of this course. What you need to know is that</p>
<ul>
<li>Instead of estimating a missing value with its treatment mean MICE imputes the missing value using all other variables (hence “multivariate”) in the dataset. In other words, it builds a model and solves for thie missing value.</li>
<li>Missing values are imputed in a way that preserves the original variance of the dataset.</li>
</ul>
<p>Here is how we use MICE imputation. The algorithm is from the package <em>mice</em>. The function is also called *mice(). It takes two arguments. First, the name of the dataset with missing values. Second, since MICE works with random numbers, we should set a seed so that we can recreate the exact same imputed values in the future, if necessary. The third argument, “printFlag = FALSE,” tells R not to print a bunch extraneous information.</p>
<div class="sourceCode" id="cb838"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb838-1"><a href="messy-and-missing-data.html#cb838-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span></code></pre></div>
<pre><code>## 
## Attaching package: &#39;mice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:timeSeries&#39;:
## 
##     filter</code></pre>
<pre><code>## The following object is masked from &#39;package:stats&#39;:
## 
##     filter</code></pre>
<pre><code>## The following objects are masked from &#39;package:base&#39;:
## 
##     cbind, rbind</code></pre>
<div class="sourceCode" id="cb843"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb843-1"><a href="messy-and-missing-data.html#cb843-1" aria-hidden="true" tabindex="-1"></a>wheat_imputed <span class="ot">=</span> <span class="fu">mice</span>(wheat_missing, <span class="at">seed=</span><span class="dv">1</span>, <span class="at">printFlag =</span> <span class="cn">FALSE</span>)   <span class="co"># arguments to mice: 1) name of dataset, 2) seed to use for random numbers, 3) don&#39;t print extra info.</span></span></code></pre></div>
<pre><code>## Warning: Number of logged events: 1</code></pre>
<p>The output of the <em>mice()</em> function is a list with a bunch of information about how the data were imputed: the original dataset, the models used, etc. We just want the complete dataset, which we can get using the <em>complete()</em> function.</p>
<div class="sourceCode" id="cb845"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb845-1"><a href="messy-and-missing-data.html#cb845-1" aria-hidden="true" tabindex="-1"></a>wheat_complete <span class="ot">=</span> <span class="fu">complete</span>(wheat_imputed)</span></code></pre></div>
<p>Finally, let’s compare the variance of the MICE-imputed dataset to that of the original dataset:</p>
<div class="sourceCode" id="cb846"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb846-1"><a href="messy-and-missing-data.html#cb846-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(wheat_complete<span class="sc">$</span>yield)</span></code></pre></div>
<pre><code>## [1] 0.6580733</code></pre>
<p>We can see the variance is decreased slightly from the original dataset, but not as much as when we imputed the data using the treatment means.</p>
</div>
</div>
<div id="practice-1-2" class="section level3" number="9.9.2">
<h3><span class="header-section-number">9.9.2</span> Practice 1</h3>
<p>The yield is missing from row 31 in this dataset. Fill in the code below Impute the missing value using MICE. If you use seed=3, your imputed value should be 1.402.</p>
<div class="sourceCode" id="cb848"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb848-1"><a href="messy-and-missing-data.html#cb848-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mice)</span>
<span id="cb848-2"><a href="messy-and-missing-data.html#cb848-2" aria-hidden="true" tabindex="-1"></a>peanut <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&quot;data-unit-9/exercise_data/peanut_missing.csv&quot;</span>)</span>
<span id="cb848-3"><a href="messy-and-missing-data.html#cb848-3" aria-hidden="true" tabindex="-1"></a>peanut_imputed <span class="ot">=</span> <span class="fu">mice</span>(peanut, <span class="at">seed=</span><span class="dv">34</span>, <span class="at">printFlag =</span> <span class="cn">FALSE</span>)   <span class="co"># arguments to mice: 1) name of dataset, 2) seed </span></span></code></pre></div>
<pre><code>## Warning: Number of logged events: 2</code></pre>
<div class="sourceCode" id="cb850"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb850-1"><a href="messy-and-missing-data.html#cb850-1" aria-hidden="true" tabindex="-1"></a>peanut_complete <span class="ot">=</span> <span class="fu">complete</span>(peanut_imputed)</span>
<span id="cb850-2"><a href="messy-and-missing-data.html#cb850-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb850-3"><a href="messy-and-missing-data.html#cb850-3" aria-hidden="true" tabindex="-1"></a>peanut[<span class="dv">31</span>,]</span></code></pre></div>
<pre><code>##    rep   gen yield
## 31  R3 mf447    NA</code></pre>
<div class="sourceCode" id="cb852"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb852-1"><a href="messy-and-missing-data.html#cb852-1" aria-hidden="true" tabindex="-1"></a>peanut_complete[<span class="dv">31</span>,]</span></code></pre></div>
<pre><code>##    rep   gen  yield
## 31  R3 mf447 1.4588</code></pre>
</div>
<div id="practice-2-2" class="section level3" number="9.9.3">
<h3><span class="header-section-number">9.9.3</span> Practice 2</h3>
<p>Impute the missing value in the “data/barley_missing.csv” dataset. Observations 18 and 47 are missing their yield value. Use seed=3. Your imputed values should be obs 18 = 377.9 and obs 47 = 362.6</p>
<div class="sourceCode" id="cb854"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb854-1"><a href="messy-and-missing-data.html#cb854-1" aria-hidden="true" tabindex="-1"></a>barley_missing <span class="ot">=</span> <span class="fu">read.csv</span>(<span class="st">&quot;data-unit-9/exercise_data/barley_missing.csv&quot;</span>)</span>
<span id="cb854-2"><a href="messy-and-missing-data.html#cb854-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(barley_missing)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    60 obs. of  4 variables:
##  $ col  : int  1 3 6 9 11 14 17 19 22 25 ...
##  $ row  : int  1 1 1 1 1 1 1 1 1 1 ...
##  $ gen  : chr  &quot;a&quot; &quot;c&quot; &quot;b&quot; &quot;a&quot; ...
##  $ yield: num  236 291 290 292 321 ...</code></pre>
<div class="sourceCode" id="cb856"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb856-1"><a href="messy-and-missing-data.html#cb856-1" aria-hidden="true" tabindex="-1"></a>barley_imputed <span class="ot">=</span> <span class="fu">mice</span>(barley_missing, <span class="at">seed=</span><span class="dv">3</span>, <span class="at">printFlag =</span> <span class="cn">FALSE</span>)   <span class="co"># arguments to mice: 1) name of dataset, 2) seed </span></span></code></pre></div>
<pre><code>## Warning: Number of logged events: 1</code></pre>
<div class="sourceCode" id="cb858"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb858-1"><a href="messy-and-missing-data.html#cb858-1" aria-hidden="true" tabindex="-1"></a>barley_complete <span class="ot">=</span> <span class="fu">complete</span>(barley_imputed)</span>
<span id="cb858-2"><a href="messy-and-missing-data.html#cb858-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb858-3"><a href="messy-and-missing-data.html#cb858-3" aria-hidden="true" tabindex="-1"></a>barley_missing[<span class="dv">18</span>,]</span></code></pre></div>
<pre><code>##    col row gen yield
## 18  14   2   c    NA</code></pre>
<div class="sourceCode" id="cb860"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb860-1"><a href="messy-and-missing-data.html#cb860-1" aria-hidden="true" tabindex="-1"></a>barley_complete[<span class="dv">18</span>,]</span></code></pre></div>
<pre><code>##    col row gen yield
## 18  14   2   c 302.2</code></pre>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="means-separation-and-data-presentation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="correlation-and-simple-regression.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-start.pdf", "bookdown-start.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
