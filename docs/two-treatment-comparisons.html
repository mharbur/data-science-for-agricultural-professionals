<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Two-Treatment Comparisons | Data Science for Agricultural Professionals</title>
  <meta name="description" content="Everything you need (and nothing more) to start a bookdown book." />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Two-Treatment Comparisons | Data Science for Agricultural Professionals" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://seankross.com/bookdown-start/" />
  
  <meta property="og:description" content="Everything you need (and nothing more) to start a bookdown book." />
  <meta name="github-repo" content="seankross/bookdown-start" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Two-Treatment Comparisons | Data Science for Agricultural Professionals" />
  
  <meta name="twitter:description" content="Everything you need (and nothing more) to start a bookdown book." />
  

<meta name="author" content="Marin L. Harbur" />


<meta name="date" content="2021-05-19" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="sample-statistics.html"/>

<script src="libs/jquery-3.5.1/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/accessible-code-block-0.0.1/empty-anchor.js"></script>
<script src="libs/htmlwidgets-1.5.3/htmlwidgets.js"></script>
<script src="libs/plotly-binding-4.9.3/plotly.js"></script>
<script src="libs/typedarray-0.1/typedarray.min.js"></script>
<link href="libs/crosstalk-1.1.1/css/crosstalk.css" rel="stylesheet" />
<script src="libs/crosstalk-1.1.1/js/crosstalk.min.js"></script>
<link href="libs/plotly-htmlwidgets-css-1.57.1/plotly-htmlwidgets.css" rel="stylesheet" />
<script src="libs/plotly-main-1.57.1/plotly-latest.min.js"></script>


<style type="text/css">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Bookdown Book</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="introduction-and-population-statistics.html"><a href="introduction-and-population-statistics.html"><i class="fa fa-check"></i><b>1</b> Introduction and Population Statistics</a><ul>
<li class="chapter" data-level="1.1" data-path="introduction-and-population-statistics.html"><a href="introduction-and-population-statistics.html#r-language"><i class="fa fa-check"></i><b>1.1</b> R-language</a></li>
<li class="chapter" data-level="1.2" data-path="introduction-and-population-statistics.html"><a href="introduction-and-population-statistics.html#populations"><i class="fa fa-check"></i><b>1.2</b> Populations</a></li>
<li class="chapter" data-level="1.3" data-path="introduction-and-population-statistics.html"><a href="introduction-and-population-statistics.html#case-study-yield-map"><i class="fa fa-check"></i><b>1.3</b> Case Study: Yield Map</a></li>
<li class="chapter" data-level="1.4" data-path="introduction-and-population-statistics.html"><a href="introduction-and-population-statistics.html#distributions"><i class="fa fa-check"></i><b>1.4</b> Distributions</a></li>
<li class="chapter" data-level="1.5" data-path="introduction-and-population-statistics.html"><a href="introduction-and-population-statistics.html#exercise-introduction-to-r"><i class="fa fa-check"></i><b>1.5</b> Exercise: Introduction to R</a><ul>
<li class="chapter" data-level="1.5.1" data-path="introduction-and-population-statistics.html"><a href="introduction-and-population-statistics.html#your-very-first-code"><i class="fa fa-check"></i><b>1.5.1</b> Your Very First Code</a></li>
<li class="chapter" data-level="1.5.2" data-path="introduction-and-population-statistics.html"><a href="introduction-and-population-statistics.html#reading-and-working-with-data-frames"><i class="fa fa-check"></i><b>1.5.2</b> Reading and Working with Data Frames</a></li>
<li class="chapter" data-level="1.5.3" data-path="introduction-and-population-statistics.html"><a href="introduction-and-population-statistics.html#basic-operations-on-columns"><i class="fa fa-check"></i><b>1.5.3</b> Basic Operations on Columns</a></li>
<li class="chapter" data-level="1.5.4" data-path="introduction-and-population-statistics.html"><a href="introduction-and-population-statistics.html#knitting-your-results-into-a-document"><i class="fa fa-check"></i><b>1.5.4</b> Knitting Your Results into a Document</a></li>
<li class="chapter" data-level="1.5.5" data-path="introduction-and-population-statistics.html"><a href="introduction-and-population-statistics.html#practice"><i class="fa fa-check"></i><b>1.5.5</b> Practice</a></li>
</ul></li>
<li class="chapter" data-level="1.6" data-path="introduction-and-population-statistics.html"><a href="introduction-and-population-statistics.html#exercise-introduction-to-shapefiles"><i class="fa fa-check"></i><b>1.6</b> Exercise: Introduction to Shapefiles</a><ul>
<li class="chapter" data-level="1.6.1" data-path="introduction-and-population-statistics.html"><a href="introduction-and-population-statistics.html#r-packages"><i class="fa fa-check"></i><b>1.6.1</b> R Packages</a></li>
<li class="chapter" data-level="1.6.2" data-path="introduction-and-population-statistics.html"><a href="introduction-and-population-statistics.html#reading-shapefiles"><i class="fa fa-check"></i><b>1.6.2</b> Reading Shapefiles</a></li>
<li class="chapter" data-level="1.6.3" data-path="introduction-and-population-statistics.html"><a href="introduction-and-population-statistics.html#examining-spatial-feature-data-frames"><i class="fa fa-check"></i><b>1.6.3</b> Examining Spatial Feature Data Frames</a></li>
<li class="chapter" data-level="1.6.4" data-path="introduction-and-population-statistics.html"><a href="introduction-and-population-statistics.html#visualizing-data"><i class="fa fa-check"></i><b>1.6.4</b> Visualizing Data</a></li>
<li class="chapter" data-level="1.6.5" data-path="introduction-and-population-statistics.html"><a href="introduction-and-population-statistics.html#create-your-own-maps"><i class="fa fa-check"></i><b>1.6.5</b> Create Your Own Maps</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="introduction-and-population-statistics.html"><a href="introduction-and-population-statistics.html#exercise-histograms"><i class="fa fa-check"></i><b>1.7</b> Exercise: Histograms</a><ul>
<li class="chapter" data-level="1.7.1" data-path="introduction-and-population-statistics.html"><a href="introduction-and-population-statistics.html#case-study"><i class="fa fa-check"></i><b>1.7.1</b> Case Study</a></li>
<li class="chapter" data-level="1.7.2" data-path="introduction-and-population-statistics.html"><a href="introduction-and-population-statistics.html#basic-histogram"><i class="fa fa-check"></i><b>1.7.2</b> Basic Histogram</a></li>
<li class="chapter" data-level="1.7.3" data-path="introduction-and-population-statistics.html"><a href="introduction-and-population-statistics.html#histograms-with-ggplot"><i class="fa fa-check"></i><b>1.7.3</b> Histograms with ggplot</a></li>
<li class="chapter" data-level="1.7.4" data-path="introduction-and-population-statistics.html"><a href="introduction-and-population-statistics.html#practice-1"><i class="fa fa-check"></i><b>1.7.4</b> Practice</a></li>
<li class="chapter" data-level="1.7.5" data-path="introduction-and-population-statistics.html"><a href="introduction-and-population-statistics.html#percentile-mean-median-maximum-and-minimum"><i class="fa fa-check"></i><b>1.7.5</b> Percentile, Mean, Median, Maximum, and Minimum</a></li>
<li class="chapter" data-level="1.7.6" data-path="introduction-and-population-statistics.html"><a href="introduction-and-population-statistics.html#variance-and-standard-deviation"><i class="fa fa-check"></i><b>1.7.6</b> Variance and Standard Deviation</a></li>
<li class="chapter" data-level="1.7.7" data-path="introduction-and-population-statistics.html"><a href="introduction-and-population-statistics.html#sum-of-squares-1"><i class="fa fa-check"></i><b>1.7.7</b> Sum of Squares</a></li>
<li class="chapter" data-level="1.7.8" data-path="introduction-and-population-statistics.html"><a href="introduction-and-population-statistics.html#practice-2"><i class="fa fa-check"></i><b>1.7.8</b> Practice</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html"><i class="fa fa-check"></i><b>2</b> Distributions and Probability</a><ul>
<li class="chapter" data-level="2.1" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#case-study-1"><i class="fa fa-check"></i><b>2.1</b> Case Study</a></li>
<li class="chapter" data-level="2.2" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#the-normal-distribution-model"><i class="fa fa-check"></i><b>2.2</b> The Normal Distribution Model</a><ul>
<li class="chapter" data-level="2.2.1" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#the-bell-curve"><i class="fa fa-check"></i><b>2.2.1</b> The Bell Curve</a></li>
<li class="chapter" data-level="2.2.2" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#distribution-and-probability"><i class="fa fa-check"></i><b>2.2.2</b> Distribution and Probability</a></li>
<li class="chapter" data-level="2.2.3" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#probability-and-the-normal-distribution-curve"><i class="fa fa-check"></i><b>2.2.3</b> Probability and the Normal Distribution Curve</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#the-z-distribution"><i class="fa fa-check"></i><b>2.3</b> The Z-Distribution</a><ul>
<li class="chapter" data-level="2.3.1" data-path="distributions-and-probability.html"><a href="distributions-and-probability.html#important-numbers-95-and-5"><i class="fa fa-check"></i><b>2.3.1</b> Important Numbers: 95% and 5%</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="sample-statistics.html"><a href="sample-statistics.html"><i class="fa fa-check"></i><b>3</b> Sample Statistics</a><ul>
<li class="chapter" data-level="3.1" data-path="sample-statistics.html"><a href="sample-statistics.html#samples"><i class="fa fa-check"></i><b>3.1</b> Samples</a></li>
<li class="chapter" data-level="3.2" data-path="sample-statistics.html"><a href="sample-statistics.html#case-study-2"><i class="fa fa-check"></i><b>3.2</b> Case Study</a></li>
<li class="chapter" data-level="3.3" data-path="sample-statistics.html"><a href="sample-statistics.html#distribution-of-sample-means"><i class="fa fa-check"></i><b>3.3</b> Distribution of Sample Means</a></li>
<li class="chapter" data-level="3.4" data-path="sample-statistics.html"><a href="sample-statistics.html#central-limit-theorem"><i class="fa fa-check"></i><b>3.4</b> Central Limit Theorem</a></li>
<li class="chapter" data-level="3.5" data-path="sample-statistics.html"><a href="sample-statistics.html#standard-error"><i class="fa fa-check"></i><b>3.5</b> Standard Error</a></li>
<li class="chapter" data-level="3.6" data-path="sample-statistics.html"><a href="sample-statistics.html#degrees-of-freedom"><i class="fa fa-check"></i><b>3.6</b> Degrees of Freedom</a></li>
<li class="chapter" data-level="3.7" data-path="sample-statistics.html"><a href="sample-statistics.html#the-t-distribution"><i class="fa fa-check"></i><b>3.7</b> The t-Distribution</a></li>
<li class="chapter" data-level="3.8" data-path="sample-statistics.html"><a href="sample-statistics.html#confidence-interval"><i class="fa fa-check"></i><b>3.8</b> Confidence Interval</a></li>
<li class="chapter" data-level="3.9" data-path="sample-statistics.html"><a href="sample-statistics.html#confidence-interval-and-probability"><i class="fa fa-check"></i><b>3.9</b> Confidence Interval and Probability</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html"><i class="fa fa-check"></i><b>4</b> Two-Treatment Comparisons</a><ul>
<li class="chapter" data-level="4.1" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#side-by-side-trials"><i class="fa fa-check"></i><b>4.1</b> Side-by-Side Trials</a></li>
<li class="chapter" data-level="4.2" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#blocked-design"><i class="fa fa-check"></i><b>4.2</b> Blocked Design</a></li>
<li class="chapter" data-level="4.3" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#case-study-3"><i class="fa fa-check"></i><b>4.3</b> Case Study</a></li>
<li class="chapter" data-level="4.4" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#confidence-interval-1"><i class="fa fa-check"></i><b>4.4</b> Confidence Interval</a></li>
<li class="chapter" data-level="4.5" data-path="two-treatment-comparisons.html"><a href="two-treatment-comparisons.html#t-test"><i class="fa fa-check"></i><b>4.5</b> T-Test</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data Science for Agricultural Professionals</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="two-treatment-comparisons" class="section level1">
<h1><span class="header-section-number">Chapter 4</span> Two-Treatment Comparisons</h1>
<p>Until now, we have worked with a single population. To recap our progress:
- In Unit 1, we defined a population. We learned it was the complete group of individuals which we wanted to describe or for which we wanted to make a prediction. We learned how to describe the center of this population with the population mean, and how to describe its spread using the sum of squares, variance, and standard deviation.
- In Unit 2, used the normal distributionto describe the pattern with which individuals are spread in many populations: individuals with values closer to the population mean were expected to be observed much more frequently that individuals with values that were more extreme. We learned to use probability toe quantify the likelihood of encountering an invididual within a particular range of values.
- In Unit 3, we used samples, subsets from a population, in place of measuring each individual in that population. We saw how sample means were distributed normally, from both normally- and non-normally distributed populations. The standard error was used to describe the spread of individual samples around the sample mean. The distribution of sample means was described by the t-distribution, which was shorter and wider when the number of samples was low, and taller and narrower when the number of samples was greater.</p>
<div id="side-by-side-trials" class="section level2">
<h2><span class="header-section-number">4.1</span> Side-by-Side Trials</h2>
<p>In this unit, we will finally put our statistical knowledge to work to test treatment differences. We will work with a simple but important experimental design – the two-treatment comparison. Here in Ohio, this is referred to as a “side-by-side” trial, but you may have a different term for it where you work. If you work for or in support of an agronomy retailer, you have probably conducted these trials. Typically, you would split one or more fields into treated and untreated fields. For example, you might “stripe” and individual field with treated and untreated areas:</p>
<p><img src="04-Two-Treatment-Comparisons_files/figure-html/unnamed-chunk-1-1.png" width="672" /></p>
<p>Or, you might divide multiple fields in half like this:</p>
<p><img src="04-Two-Treatment-Comparisons_files/figure-html/unnamed-chunk-2-1.png" width="672" /></p>
<p>In either case, however, a side-by-side deals with two treatments and can be easily analyzed using a t-test. In these next two units we will compare different designs for side-by-side (or paired) trials, use Excel and R to randomly assign treatments, understand how the t-distribution allows us to test for significance, and run these tests in R.</p>
</div>
<div id="blocked-design" class="section level2">
<h2><span class="header-section-number">4.2</span> Blocked Design</h2>
<p>In Unit 1 we learned the hallmarks of a designed trial are the randomzation and replication of treatments. Each treatment should be observed several times in different experimental units. Often in our work “experimental unit” is a fancy word for a plot, half a field, or a pot.</p>
<p>Observing the treatment several times has two benefits. First, the average of those observations – the sample average – wil likely be closer to the true population average for that treatment than the individual observations. Second, variation among the observations can be used to give us a sense how much environmental factors outside, in contrast with our treatment, cause our observations to vary.</p>
<p>It is also important to randomize treatments in order to avoid intentional or unintentional biases that might skew our interpretation of results. For example, one treatment might be biased by always putting it to the north of another treatment or, more insiduously, always putting it in the better half of a field. Deliberate randomization reduces the probability of either scenario.</p>
<p>That said, reality often intervenes intervenes. Soil types change across a field, as do microclimates around field edges, management histories, etc. Though randomization will reduce the likelihood that treatments are concentrated in one of these areas, it may not result in as even a distribution of treatments across the experimental area as we would like. Even with randomization, we could conceivably with all the treatments in one half of the field:</p>
<p><img src="04-Two-Treatment-Comparisons_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
<p><img src="04-Two-Treatment-Comparisons_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<p>Or, if we are using multiple fields, both halves of a field could receive the same treatment in a randomized design</p>
<p><img src="04-Two-Treatment-Comparisons_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Blocked experimental designs, place a restriction on the random assignment of treatments to plots. Instead of assigning treatments randomly within a field or across a state. We instead force both treatments to occur within a field section or in the same field, so that our treatment maps look more those we showed in the first two figures of this unit.</p>
<p>Here is another way to think about this. Our statistical test this week is based on comparing two populations. Each population will receive a different treatment. We want to design our experiment so that aside from the treatment, the two populations are as identical as possible. The blocked approach, in general, helps create two populations that are similar.</p>
</div>
<div id="case-study-3" class="section level2">
<h2><span class="header-section-number">4.3</span> Case Study</h2>
<p>An in-furrow corn starter (6-24-6 plus proprietary micronutrients) was tested against a control (no -starter) in a trial in western Ohio. Treatments were blocked (paired) so that each treatment occurred once per block. Plot numbers are given on the x-axis of the map below. There were 10 blocks. The data are in a data.frame named “corn_starter”.</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="two-treatment-comparisons.html#cb161-1"></a>corn_starter =<span class="st"> </span><span class="kw">read.csv</span>(<span class="st">&quot;data-unit-4/corn_starter.csv&quot;</span>)</span></code></pre></div>
<p><img src="04-Two-Treatment-Comparisons_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<p>Examine the corn_starter data.frame using the “head” function.</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="two-treatment-comparisons.html#cb162-1"></a><span class="kw">head</span>(corn_starter)</span></code></pre></div>
<pre><code>##   block plot treatment yield
## 1     1   11   Starter 193.4
## 2     1   12   Control 194.2
## 3     2   21   Starter 192.2
## 4     2   22   Control 189.0
## 5     3   31   Control 193.8
## 6     3   32   Starter 194.2</code></pre>
<p>Note the column headings: “trt” refers to the treatment level (Control or Starter) and “value” refers to the measured yield.</p>
<p>Let’s make a quick histogram plot of the data using ggplot. For the first time, in this unit, we are working with two populations: one which received no starter (the control), and another which received starter. So we will have separate histograms for both populations.</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="two-treatment-comparisons.html#cb164-1"></a><span class="kw">ggplot</span>(<span class="dt">data =</span> corn_starter, <span class="kw">aes</span>(<span class="dt">x=</span>yield)) <span class="op">+</span></span>
<span id="cb164-2"><a href="two-treatment-comparisons.html#cb164-2"></a><span class="st">  </span><span class="kw">geom_histogram</span>() <span class="op">+</span></span>
<span id="cb164-3"><a href="two-treatment-comparisons.html#cb164-3"></a><span class="st">  </span><span class="kw">facet_grid</span>(<span class="op">~</span>treatment)</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<p><img src="04-Two-Treatment-Comparisons_files/figure-html/corn_starter_bar_plot-1.png" width="672" /></p>
<p>In the above code, ggplot launches the function to plot our data. Also on the first line, “aes” specifies the “aesthetics” to be plotted – these are the variable(s) that define where objects are positioned in the plot. In this case, yield determines which bin an observation is placed into, so x=value.</p>
<p>The next line tells R to draw a histogram.</p>
<p>The last line tells R to construct a series of plots, one for each level of treatment. This way, we can compare the distribution of the Control population with that of the Starter population.</p>
<p>The mean yield of the population that population that received starter is greater than the center of the population that received the control (no starter).</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="two-treatment-comparisons.html#cb166-1"></a>corn_starter <span class="op">%&gt;%</span></span>
<span id="cb166-2"><a href="two-treatment-comparisons.html#cb166-2"></a><span class="st">  </span><span class="kw">group_by</span>(treatment) <span class="op">%&gt;%</span></span>
<span id="cb166-3"><a href="two-treatment-comparisons.html#cb166-3"></a><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">yield =</span> <span class="kw">mean</span>(yield))</span></code></pre></div>
<pre><code>## # A tibble: 2 x 2
##   treatment yield
##   &lt;chr&gt;     &lt;dbl&gt;
## 1 Control    190.
## 2 Starter    196.</code></pre>
<p>Another way to look at this would be to create a new population from the differences between starter and control within each pair.</p>
<p><img src="04-Two-Treatment-Comparisons_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<p>This can be confusing, so let’s slow it down. We created a new population by subtracting the yield of the control plot from the yield of the starter plot in each pair. In this new population, individuals with a positive value indicate a block where the starter outyielded the control. Individuals with a negative value indicate a block where the control outyielded the starter. We will now work with this new population of differences.</p>
<p>We see most of the individuals in this new population are greater than 0. The population mean is 5.6 bushels/acre. What we want to know is: given the mean we observed (5.59 bushels/acre) and the distribution of this population, what is the probability, were we to repeat the trial, that the population mean would be zero.</p>
<p>A population mean of zero would mean the starter yield and control yield were the same, i.e. there is no difference between the starter and control.</p>
</div>
<div id="confidence-interval-1" class="section level2">
<h2><span class="header-section-number">4.4</span> Confidence Interval</h2>
<p>We can use a confidence interval to determine whether the range of values we are likely to observe includes zero. Recall, to calculate the confidence interval we need two values: the minimal t-value that is associated with our degrees of freedom and encompases 95% of our population, and the standard error of the difference.</p>
<p>We calculate the minimal t-value using the qt function in R.</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="two-treatment-comparisons.html#cb168-1"></a>min_t =<span class="st"> </span><span class="kw">qt</span>(<span class="fl">0.975</span>, <span class="dt">df=</span><span class="dv">9</span>)</span></code></pre></div>
<p>Remember, degrees of freedom is equal to n-1. Our new population has 10 degrees of freedom, thereofre, df equals 9 above.</p>
<p>We also need to know the standard error of the population. Given our population is composed of treatment differences, we will call this statistic the <em>standard error of the difference</em>.</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="two-treatment-comparisons.html#cb169-1"></a>sd =<span class="st"> </span><span class="kw">sd</span>(corn_differences<span class="op">$</span>difference)</span>
<span id="cb169-2"><a href="two-treatment-comparisons.html#cb169-2"></a>sed =<span class="st"> </span>sd<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">10</span>)</span>
<span id="cb169-3"><a href="two-treatment-comparisons.html#cb169-3"></a>pop_mean =<span class="st"> </span><span class="kw">mean</span>(corn_differences<span class="op">$</span>difference)</span></code></pre></div>
<p>In the code above, we first calculated the standard deviation, sd, of of our differences. We divided the standard deviation by the square root of the number of observations to get the standard error of the difference. Our population mean is 5.59 and the standard error of the difference is about 1.71 We additionally calculated pop_mean, the mean of our population.</p>
<p>We can now calculate the confidence interval, using min_t and sed:</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="two-treatment-comparisons.html#cb170-1"></a>upper_limit =<span class="st"> </span>pop_mean <span class="op">+</span><span class="st"> </span>(min_t <span class="op">*</span><span class="st"> </span>sed)</span>
<span id="cb170-2"><a href="two-treatment-comparisons.html#cb170-2"></a>lower_limit =<span class="st"> </span>pop_mean <span class="op">-</span><span class="st"> </span>(min_t <span class="op">*</span><span class="st"> </span>sed)</span>
<span id="cb170-3"><a href="two-treatment-comparisons.html#cb170-3"></a>CI =<span class="st"> </span><span class="kw">paste</span>(lower_limit, upper_limit, <span class="dt">sep=</span><span class="st">&quot;,&quot;</span>)</span>
<span id="cb170-4"><a href="two-treatment-comparisons.html#cb170-4"></a>CI</span></code></pre></div>
<pre><code>## [1] &quot;1.72421086829983,9.45578913170016&quot;</code></pre>
<p>The 95% confidence interval ranges from 1.72 to 9.46 bushels per acre and, notably, does not include zero. Since zero is outside the 95% confidence interval, there is greater than a 95% probability the population mean is not equal to zero. Another way of saying this is there is less than a 5% probability that the population mean is equal to zero. Or, finally, the population mean is significantly different from zero at the 5% (or 0.05) level.</p>
<p>Going our population was composed of the difference of starter and control, we can say the starter effect is significantly different from the control at the 5% level.</p>
</div>
<div id="t-test" class="section level2">
<h2><span class="header-section-number">4.5</span> T-Test</h2>
<p>An alternative to the confidence interval is the t-test. The first step of the t-test is to calculate our observed t-value:</p>
<p><span class="math display">\[ t = \frac{\bar{x} - \mu}{SED} \]</span>
Where <span class="math inline">\(\bar{x}\)</span> is the observed population mean, <span class="math inline">\(\mu\)</span> is the hypothesized population mean (usually 0, meaning no treatment difference), and <span class="math inline">\(SED\)</span> is the standard error of the difference.</p>
<p>In our example above:</p>
<p><span class="math display">\[ t = \frac{5.59 - 0}{1.71} = 3.27\]</span></p>
<p>Our observed t-value is about 3.27. If there were no difference between the starter and the control, of course, t would be equal to zero. So there is a difference between our observed mean and zero of <span class="math inline">\(t=3.27\)</span>. Using R, we can quickly calculate the probability of observing a value <span class="math inline">\(t=3.27\)</span> above – or below our population mean of 5.59.</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="two-treatment-comparisons.html#cb172-1"></a><span class="kw">library</span>(fastGraph)</span>
<span id="cb172-2"><a href="two-treatment-comparisons.html#cb172-2"></a><span class="kw">shadeDist</span>(<span class="dt">xshade=</span><span class="kw">c</span>(<span class="op">-</span><span class="fl">3.27</span>, <span class="fl">3.27</span>), <span class="st">&quot;dt&quot;</span>, <span class="dt">parm2 =</span> <span class="dv">9</span>, <span class="dt">lower.tail =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p><img src="04-Two-Treatment-Comparisons_files/figure-html/unnamed-chunk-15-1.png" width="672" /></p>
<p>Note that this time with this function we used the argument “lower.tail=TRUE”. This tells R to calculate the probability of values futher than <span class="math inline">\(t=3.27\)</span> both above and below the mean.</p>
<p>Again there were 10 observed differences in our population, so there were 9 degrees of freedom. The value that is returned is the probability the population mean is actually zero, given the population mean. The probability of this t-value (sometimes abbreviated as <span class="math inline">\(Pr \ge \lvert t \lvert\)</span>) is very low, less tan 0.01, or 1%.</p>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="sample-statistics.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-start.pdf", "bookdown-start.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
